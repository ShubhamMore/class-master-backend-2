{"version":3,"sources":["webpack:///src/app/institute/branch/dashboard/dashboard.component.html","webpack:///src/app/institute/branch/dashboard/dashboard-routing.module.ts","webpack:///src/app/institute/branch/dashboard/dashboard.component.ts","webpack:///src/app/institute/branch/dashboard/dashboard.module.ts"],"names":["routes","path","component","DashboardComponent","branchService","dashboardService","toastrService","storageService","router","route","dateService","budgetService","menuService","themeService","this","loading","branchId","getBranchId","currentYear","getCurrentYear","year","getDashboardData","getBudgetData","themeSubscription","getJsTheme","subscribe","config","colors","variables","chartjs","options","maintainAspectRatio","responsive","legend","labels","fontColor","textColor","scales","xAxes","gridLines","display","color","axisLineColor","ticks","yAxes","navigate","relativeTo","branchStorage","totalStorage","convertByteToUnit","totalStorageAssigned","usedStorage","totalStorageUsed","availableStorage","value","toFixed","unit","usedStorageInPercentage","parseInt","getBranchDashboard","dashboardInfo","calculateStorage","showMenu","error","showToastr","queryParams","type","getBudgetForBranchDashboard","toString","budget","setBarChartData","income","expense","i","inc","find","curIncome","_id","push","amount","exp","curExpense","data","datasets","label","backgroundColor","warningLight","dangerLight","position","status","message","show","loadChildren","then","m","PageNotFoundModule","redirectTo","pathMatch","DashboardRoutingModule","forChild","DashboardModule","ChartModule"],"mappings":"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","file":"x","sourcesContent":["<div class=\"row\" *ngIf=\"!loading\">\n  <div class=\"col-md-4 col-sm-6 col-12\">\n    <nb-card status=\"warning\">\n      <nb-card-header>\n        <button\n          class=\"float-right text-white\"\n          nbButton\n          size=\"small\"\n          outline\n          status=\"warning\"\n          nbTooltip=\"Add Course\"\n          shape=\"round\"\n          (click)=\"addCourse()\"\n        >\n          <nb-icon icon=\"plus\"></nb-icon>\n        </button>\n        <h3 class=\"text-white\"><span class=\"pointer\" (click)=\"manageCourse()\">Course</span></h3>\n      </nb-card-header>\n      <nb-card-body>\n        <nb-actions size=\"giant\" fullWidth>\n          <nb-action>\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h4 class=\"text-center\">{{ dashboardInfo.activeCourses }}</h4>\n                <h6>Active</h6>\n              </div>\n            </div>\n          </nb-action>\n          <nb-action>\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h4 class=\"text-center\">{{ dashboardInfo.inactiveCourses }}</h4>\n                <h6>Inactive</h6>\n              </div>\n            </div>\n          </nb-action>\n        </nb-actions>\n      </nb-card-body>\n    </nb-card>\n  </div>\n\n  <div class=\"col-md-4 col-sm-6 col-12\">\n    <nb-card status=\"success\">\n      <nb-card-header>\n        <button\n          class=\"float-right text-white\"\n          nbButton\n          size=\"small\"\n          outline\n          status=\"success\"\n          nbTooltip=\"Add Student\"\n          shape=\"round\"\n          (click)=\"addStudent()\"\n        >\n          <nb-icon icon=\"plus\"></nb-icon>\n        </button>\n        <h3 class=\"text-white\"><span class=\"pointer\" (click)=\"manageStudent()\">Student</span></h3>\n      </nb-card-header>\n      <nb-card-body>\n        <nb-actions size=\"giant\" fullWidth>\n          <nb-action>\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h4 class=\"text-center\">{{ dashboardInfo.activeStudents }}</h4>\n                <h6>Active</h6>\n              </div>\n            </div>\n          </nb-action>\n          <nb-action>\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h4 class=\"text-center\">{{ dashboardInfo.inactiveStudents }}</h4>\n                <h6>Inactive</h6>\n              </div>\n            </div>\n          </nb-action>\n        </nb-actions>\n      </nb-card-body>\n    </nb-card>\n  </div>\n\n  <div class=\"col-md-4 col-sm-6 col-12\">\n    <nb-card status=\"danger\">\n      <nb-card-header>\n        <button\n          class=\"float-right text-white\"\n          nbButton\n          size=\"small\"\n          outline\n          status=\"danger\"\n          nbTooltip=\"Add Employee\"\n          shape=\"round\"\n          (click)=\"addEmployee()\"\n        >\n          <nb-icon icon=\"plus\"></nb-icon>\n        </button>\n        <h3 class=\"text-white\"><span class=\"pointer\" (click)=\"manageEmployee()\">Employee</span></h3>\n      </nb-card-header>\n      <nb-card-body>\n        <nb-actions size=\"giant\" fullWidth>\n          <nb-action>\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h4 class=\"text-center\">{{ dashboardInfo.activeEmployees }}</h4>\n                <h6>Active</h6>\n              </div>\n            </div>\n          </nb-action>\n          <nb-action>\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h4 class=\"text-center\">{{ dashboardInfo.inactiveEmployees }}</h4>\n                <h6>Inactive</h6>\n              </div>\n            </div>\n          </nb-action>\n        </nb-actions>\n      </nb-card-body>\n    </nb-card>\n  </div>\n\n  <div class=\"col-md-5 col-sm-6 col-12\">\n    <div class=\"row\">\n      <div class=\"col-12\">\n        <nb-card status=\"info\">\n          <nb-card-header>\n            <button\n              class=\"float-right text-white\"\n              nbButton\n              size=\"small\"\n              outline\n              status=\"info\"\n              nbTooltip=\"Add Lead\"\n              shape=\"round\"\n              (click)=\"addLead()\"\n            >\n              <nb-icon icon=\"plus\"></nb-icon>\n            </button>\n            <h3 class=\"text-white\"><span class=\"pointer\" (click)=\"manageLead()\">Lead</span></h3>\n          </nb-card-header>\n          <nb-card-body>\n            <nb-actions size=\"giant\" fullWidth>\n              <nb-action>\n                <div class=\"row\">\n                  <div class=\"col-12\">\n                    <h4 class=\"text-center\">{{ dashboardInfo.wonLeads }}</h4>\n                    <h6>Won</h6>\n                  </div>\n                </div>\n              </nb-action>\n              <nb-action>\n                <div class=\"row\">\n                  <div class=\"col-12\">\n                    <h4 class=\"text-center\">{{ dashboardInfo.openLeads }}</h4>\n                    <h6>Open</h6>\n                  </div>\n                </div>\n              </nb-action>\n              <nb-action>\n                <div class=\"row\">\n                  <div class=\"col-12\">\n                    <h4 class=\"text-center\">{{ dashboardInfo.lostLeads }}</h4>\n                    <h6>Lost</h6>\n                  </div>\n                </div>\n              </nb-action>\n            </nb-actions>\n          </nb-card-body>\n        </nb-card>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-12\">\n        <nb-card>\n          <nb-card-header>\n            <button\n              class=\"float-right text-white\"\n              nbButton\n              size=\"small\"\n              status=\"primary\"\n              nbTooltip=\"Manage Storage\"\n              shape=\"round\"\n              (click)=\"manageStorage()\"\n            >\n              <nb-icon icon=\"arrow-forward-outline\"></nb-icon>\n            </button>\n            <h3>Branch Storage</h3>\n          </nb-card-header>\n          <nb-card-body>\n            <div class=\"progress-info\">\n              <h4>\n                {{ availableStorage }} <small>left of {{ totalStorage }}</small>\n              </h4>\n              <nb-progress-bar\n                [value]=\"usedStorageInPercentage\"\n                status=\"danger\"\n                [displayValue]=\"true\"\n              >\n                <span *ngIf=\"usedStorageInPercentage >= 25\">&nbsp;Used</span>\n              </nb-progress-bar>\n              <div class=\"caption description\">\n                <bdi>{{ usedStorage }} Used</bdi>\n              </div>\n            </div>\n          </nb-card-body>\n        </nb-card>\n      </div>\n    </div>\n\n    <!-- <div class=\"row\">\n      <div class=\"col-12\">\n        <nb-card status=\"\">\n          <nb-card-header>\n            <button\n              class=\"float-right\"\n              nbButton size=\"small\"\n              outline\n\n              status=\"danger\"\n              nbTooltip=\"Manage Class Schedule\"\n              shape=\"round\"\n              (click)=\"manageClassSchedule()\"\n            >\n              <nb-icon icon=\"arrow-forward\"></nb-icon>\n            </button>\n            <h3 class=\"\">\n              <span class=\"pointer text-danger\" (click)=\"manageClassSchedule()\"\n                >Manage Class Schedule</span\n              >\n            </h3>\n          </nb-card-header>\n        </nb-card>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-12\">\n        <nb-card status=\"\">\n          <nb-card-header>\n            <button\n              class=\"float-right\"\n              nbButton size=\"small\"\n              outline\n\n              status=\"success\"\n              nbTooltip=\"Manage Reports\"\n              shape=\"round\"\n              (click)=\"manageStudentReports()\"\n            >\n              <nb-icon icon=\"arrow-forward\"></nb-icon>\n            </button>\n            <h3 class=\"\">\n              <span class=\"pointer text-success\" (click)=\"manageStudentReports()\"\n                >Manage Reports</span\n              >\n            </h3>\n          </nb-card-header>\n        </nb-card>\n      </div>\n    </div> -->\n  </div>\n\n  <div class=\"col-md-7 col-sm-6 col-12\">\n    <nb-card>\n      <nb-card-header>\n        <div class=\"row\">\n          <div class=\"col-md-8 col-sm-7 col-12\">\n            <h3><span class=\"pointer\" (click)=\"manageBudget()\">Budget</span></h3>\n          </div>\n          <div class=\"col-md-4 col-sm-5 col-12\">\n            <div class=\"btn-group\">\n              <button\n                nbButton\n                size=\"small\"\n                status=\"primary\"\n                nbTooltip=\"Previous Year\"\n                (click)=\"previousYear()\"\n                *ngIf=\"year > 2018\"\n              >\n                <nb-icon icon=\"arrow-ios-back-outline\"></nb-icon>\n              </button>\n              <button type=\"button\" nbButton size=\"small\">\n                <strong>{{ year }}</strong>\n              </button>\n              <button\n                nbButton\n                size=\"small\"\n                status=\"primary\"\n                nbTooltip=\"Next Year\"\n                (click)=\"nextYear()\"\n                *ngIf=\"year < currentYear\"\n              >\n                <nb-icon icon=\"arrow-ios-forward-outline\"></nb-icon>\n              </button>\n            </div>\n          </div>\n        </div>\n      </nb-card-header>\n      <nb-card-body>\n        <chart class=\"bar-chart\" type=\"bar\" [data]=\"data\" [options]=\"options\"></chart>\n      </nb-card-body>\n    </nb-card>\n  </div>\n</div>\n","import { DashboardComponent } from './dashboard.component';\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DashboardComponent,\n  },\n\n  {\n    path: 'page-not-found',\n    loadChildren: () =>\n      import('../../../shared/page-not-found/page-not-found.module').then(\n        (m) => m.PageNotFoundModule,\n      ),\n  },\n\n  {\n    path: '**',\n    redirectTo: 'page-not-found',\n    pathMatch: 'full',\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class DashboardRoutingModule {}\n","import { BranchSMSModel } from './../../../models/branch-sms.model';\nimport { MenuService } from './../../menu.service';\nimport { BranchStorageModel } from '../../../models/branch-storage.model';\nimport { StorageService } from './../../../services/shared-services/storage.service';\nimport { BudgetService } from './../../../services/budget.service';\nimport { DateService } from './../../../services/shared-services/date.service';\nimport { NbToastrService, NbThemeService } from '@nebular/theme';\nimport { DashboardService } from './../../../services/dashboard.service';\nimport { BranchService } from './../../../services/branch.service';\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\ninterface DashboardInfo {\n  branchStorage: BranchStorageModel;\n  activeCourses: number;\n  inactiveCourses: number;\n  activeStudents: number;\n  inactiveStudents: number;\n  activeEmployees: number;\n  inactiveEmployees: number;\n  openLeads: number;\n  lostLeads: number;\n  wonLeads: number;\n  branchSMS: BranchSMSModel;\n}\n\ninterface Budget {\n  income: { _id: number; amount: number }[];\n  expense: { _id: number; amount: number }[];\n}\n\n@Component({\n  selector: 'ngx-dashboard',\n  templateUrl: './dashboard.component.html',\n  styleUrls: ['./dashboard.component.scss'],\n})\nexport class DashboardComponent implements OnInit {\n  loading: boolean;\n  branchId: string;\n  dashboardInfo: DashboardInfo;\n\n  currentYear: number;\n  year: number;\n\n  data: any;\n  options: any;\n  themeSubscription: any;\n  colors: any;\n\n  totalStorage: string;\n  usedStorage: string;\n  availableStorage: string;\n  usedStorageInPercentage: number;\n\n  constructor(\n    private branchService: BranchService,\n    private dashboardService: DashboardService,\n    private toastrService: NbToastrService,\n    private storageService: StorageService,\n    private router: Router,\n    private route: ActivatedRoute,\n    public dateService: DateService,\n    public budgetService: BudgetService,\n    private menuService: MenuService,\n    private themeService: NbThemeService,\n  ) {}\n\n  ngOnInit(): void {\n    this.loading = true;\n    this.branchId = this.branchService.getBranchId();\n    if (!this.branchId) {\n      this.router.navigate(['../'], { relativeTo: this.route });\n      return;\n    }\n    this.currentYear = +this.dateService.getCurrentYear();\n    this.year = +this.dateService.getCurrentYear();\n    this.getDashboardData();\n    this.getBudgetData();\n\n    this.themeSubscription = this.themeService.getJsTheme().subscribe((config: any) => {\n      this.colors = config.variables;\n      const chartjs: any = config.variables.chartjs;\n\n      this.options = {\n        maintainAspectRatio: false,\n        responsive: true,\n        legend: {\n          labels: {\n            fontColor: chartjs.textColor,\n          },\n        },\n        scales: {\n          xAxes: [\n            {\n              gridLines: {\n                display: false,\n                color: chartjs.axisLineColor,\n              },\n              ticks: {\n                fontColor: chartjs.textColor,\n              },\n            },\n          ],\n          yAxes: [\n            {\n              gridLines: {\n                display: true,\n                color: chartjs.axisLineColor,\n              },\n              ticks: {\n                fontColor: chartjs.textColor,\n              },\n            },\n          ],\n        },\n      };\n    });\n  }\n\n  calculateStorage(branchStorage: BranchStorageModel) {\n    const totalStorage: any = this.storageService.convertByteToUnit(\n      branchStorage.totalStorageAssigned,\n    );\n    const usedStorage: any = this.storageService.convertByteToUnit(branchStorage.totalStorageUsed);\n\n    const availableStorage: any = this.storageService.convertByteToUnit(\n      branchStorage.totalStorageAssigned - branchStorage.totalStorageUsed,\n    );\n\n    this.totalStorage = totalStorage.value.toFixed(1) + ' ' + totalStorage.unit;\n    this.usedStorage = usedStorage.value.toFixed(1) + ' ' + usedStorage.unit;\n    this.availableStorage = availableStorage.value.toFixed(1) + ' ' + availableStorage.unit;\n\n    // tslint:disable-next-line: radix\n    this.usedStorageInPercentage = parseInt(\n      ((branchStorage.totalStorageUsed * 100) / branchStorage.totalStorageAssigned).toFixed(1),\n    );\n  }\n\n  getDashboardData() {\n    this.dashboardService.getBranchDashboard(this.branchId).subscribe(\n      (dashboardInfo: DashboardInfo) => {\n        this.dashboardInfo = dashboardInfo;\n        this.calculateStorage(dashboardInfo.branchStorage);\n        this.menuService.showMenu();\n        this.loading = false;\n      },\n      (error: any) => {\n        this.showToastr('top-right', 'danger', error);\n        this.router.navigate(['../../'], { relativeTo: this.route });\n      },\n    );\n  }\n\n  addStudent() {\n    this.router.navigate(['../student/add'], { relativeTo: this.route });\n  }\n\n  manageStudent() {\n    this.router.navigate(['../student'], {\n      relativeTo: this.route,\n      queryParams: { type: 'active' },\n    });\n  }\n\n  addEmployee() {\n    this.router.navigate(['../employee/add'], { relativeTo: this.route });\n  }\n\n  manageEmployee() {\n    this.router.navigate(['../employee'], {\n      relativeTo: this.route,\n      queryParams: { type: 'active' },\n    });\n  }\n\n  addCourse() {\n    this.router.navigate(['../manage-branch/course/add'], { relativeTo: this.route });\n  }\n\n  manageCourse() {\n    this.router.navigate(['../manage-branch/course'], { relativeTo: this.route });\n  }\n\n  addLead() {\n    this.router.navigate(['../lead/add'], { relativeTo: this.route });\n  }\n\n  manageLead() {\n    this.router.navigate(['../lead'], { relativeTo: this.route, queryParams: { type: 'active' } });\n  }\n\n  manageBudget() {\n    this.router.navigate(['../budget'], { relativeTo: this.route });\n  }\n\n  manageClassSchedule() {\n    this.router.navigate(['../schedule'], { relativeTo: this.route });\n  }\n\n  manageStudentReports() {\n    this.router.navigate(['../students-report'], { relativeTo: this.route });\n  }\n\n  manageStorage() {\n    this.router.navigate(['../storage'], { relativeTo: this.route });\n  }\n\n  previousYear() {\n    if (this.year >= 2018) {\n      this.year--;\n      this.getBudgetData();\n    }\n  }\n\n  nextYear() {\n    if (this.year <= this.currentYear) {\n      this.year++;\n      this.getBudgetData();\n    }\n  }\n\n  getBudgetData() {\n    this.budgetService.getBudgetForBranchDashboard(this.branchId, this.year.toString()).subscribe(\n      (budget: Budget) => {\n        this.setBarChartData(budget);\n      },\n      (error: any) => {\n        this.showToastr('top-right', 'danger', error);\n      },\n    );\n  }\n\n  setBarChartData(budget: Budget) {\n    const income: number[] = [];\n    const expense: number[] = [];\n\n    for (let i = 0; i < 12; i++) {\n      // Income\n      const inc = budget.income.find((curIncome: any) => curIncome._id === i + 1);\n      if (inc) {\n        income.push(inc.amount);\n      } else {\n        income.push(0);\n      }\n\n      // Expense\n      const exp = budget.expense.find((curExpense: any) => curExpense._id === i + 1);\n      if (exp) {\n        expense.push(exp.amount);\n      } else {\n        expense.push(0);\n      }\n    }\n\n    this.data = {\n      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n      datasets: [\n        {\n          data: income,\n          label: 'Income',\n          backgroundColor: this.colors.warningLight,\n        },\n        {\n          data: expense,\n          label: 'Expense',\n          backgroundColor: this.colors.dangerLight,\n        },\n      ],\n    };\n  }\n\n  private showToastr(position: any, status: any, message: string) {\n    this.toastrService.show(status, message, {\n      position,\n      status,\n    });\n  }\n}\n","import { ChartModule } from 'angular2-chartjs';\n\nimport {\n  NbCardModule,\n  NbActionsModule,\n  NbButtonModule,\n  NbTooltipModule,\n  NbIconModule,\n  NbProgressBarModule,\n} from '@nebular/theme';\nimport { DashboardComponent } from './dashboard.component';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { DashboardRoutingModule } from './dashboard-routing.module';\n\n@NgModule({\n  declarations: [DashboardComponent],\n  imports: [\n    CommonModule,\n    NbActionsModule,\n    ChartModule,\n    DashboardRoutingModule,\n    NbCardModule,\n    NbButtonModule,\n    NbIconModule,\n    NbTooltipModule,\n    NbProgressBarModule,\n  ],\n})\nexport class DashboardModule {}\n"]}