{"version":3,"sources":["webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer.component.html","webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer-routing.module.ts","webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer.component.ts","webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer.module.ts"],"names":["routes","path","component","AddDiscountAndOfferComponent","branchService","dateService","discountAndOfferService","toastrService","router","route","this","queryParams","subscribe","param","mode","ngOnInit","loading","submit","branchId","getBranchId","navigate","relativeTo","discountAndOfferId","getDiscountAndOfferId","showToastr","discountTypes","getDiscountTypes","validOfferCode","discountAndOfferForm","offerName","validators","required","code","discountType","discountAmount","min","startDate","expiryDate","description","termsAndConditions","discountPercentageValidator","bind","getDiscountAndOfferForEditing","discountAndOffer","patchValue","err","amount","toFixed","toString","group","value","invalidDiscountPercentage","CheckDiscountAndOffer","res","status","markAllAsTouched","invalid","stepper","next","branch","_id","editDiscountAndOffer","back","error","addDiscountAndOffer","position","message","show","replaceUrl","deleteDiscountAndOfferId","submitDiscountAndOffer","checkOfferCode","saveDiscountAndOffer","loadChildren","then","m","PageNotFoundModule","redirectTo","pathMatch","AddDiscountAndOfferRoutingModule","forChild","AddDiscountAndOfferModule"],"mappings":"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","file":"x","sourcesContent":["<nb-card>\n  <nb-card-header>\n    <button class=\"float-right\" nbButton size=\"small\" status=\"warning\" (click)=\"back()\">\n      Back\n    </button>\n    <h3 class=\"\">\n      {{\n        !discountAndOffer\n          ? 'Add New DiscountAndOffer'\n          : 'Edit Offer ' + (discountAndOffer.offerName | uppercase)\n      }}\n    </h3>\n  </nb-card-header>\n  <nb-card-body>\n    <nb-stepper #stepper [linear]=\"true\">\n      <nb-step [stepControl]=\"discountAndOfferForm\" label=\"Basic Details\">\n        <form class=\"\" (submit)=\"submitDiscountAndOffer()\" [formGroup]=\"discountAndOfferForm\">\n          <h6>Discount & Offer:</h6>\n          <div class=\"row\">\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-offer-name\">Offer Name:</label>\n                <input\n                  type=\"text\"\n                  nbInput\n                  id=\"input-offer-name\"\n                  name=\"offerName\"\n                  formControlName=\"offerName\"\n                  placeholder=\"Offer Name\"\n                  maxlength=\"30\"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('offerName').touched\n                      ? discountAndOfferForm.get('offerName').invalid\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                />\n                <ng-container\n                  *ngIf=\"\n                    discountAndOfferForm.get('offerName').invalid &&\n                    discountAndOfferForm.get('offerName').touched\n                  \"\n                >\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('offerName').errors?.required\"\n                  >\n                    Offer Name is required!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-code\">Code:</label>\n                <input\n                  type=\"text\"\n                  nbInput\n                  id=\"input-code\"\n                  name=\"code\"\n                  formControlName=\"code\"\n                  placeholder=\"Code\"\n                  maxlength=\"30\"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('code').touched\n                      ? discountAndOfferForm.get('code').invalid || !validOfferCode\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                  (input)=\"checkOfferCode($event.target.value)\"\n                />\n                <ng-container *ngIf=\"discountAndOfferForm.get('code').touched\">\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('code').errors?.required\"\n                  >\n                    Code is required!\n                  </p>\n                  <p class=\"caption status-danger\" *ngIf=\"!validOfferCode\">\n                    This Offer Code Already Exist!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-billing-discount-type\">Discount Type:</label>\n                <nb-select\n                  id=\"input-discount-type\"\n                  name=\"discountType\"\n                  formControlName=\"discountType\"\n                  placeholder=\"Select Discount Type\"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('discountType').touched\n                      ? discountAndOfferForm.get('discountType').invalid\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                >\n                  <nb-option value=\"\">Select Discount Type</nb-option>\n                  <nb-option *ngFor=\"let discountType of discountTypes\" [value]=\"discountType\">{{\n                    discountType | uppercase\n                  }}</nb-option>\n                </nb-select>\n                <ng-container *ngIf=\"discountAndOfferForm.get('discountType').touched\">\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('discountType').errors?.required\"\n                  >\n                    Discount Type is required!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-discount-amount\">Discount Amount:</label>\n                <input\n                  type=\"number\"\n                  nbInput\n                  id=\"input-discount-amount\"\n                  name=\"discountAmount\"\n                  min=\"0\"\n                  formControlName=\"discountAmount\"\n                  placeholder=\"Discount {{\n                    discountAndOfferForm.value.discountType === 'percentage'\n                      ? 'Percentage (%)'\n                      : 'Amount'\n                  }} \"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('discountAmount').touched\n                      ? discountAndOfferForm.get('discountAmount').invalid ||\n                        discountAndOfferForm.hasError('invalidDiscountPercentage')\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                />\n                <ng-container *ngIf=\"discountAndOfferForm.get('discountAmount').touched\">\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('discountAmount').errors?.required\"\n                  >\n                    Discount Amount is required!\n                  </p>\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('discountAmount').errors?.min\"\n                  >\n                    Discount Amount should be more than or equal to 0\n                  </p>\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.hasError('invalidDiscountPercentage')\"\n                  >\n                    Discount Percentage should be between 0% to 100%\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-start-date\">Start Date:</label>\n                <input\n                  type=\"date\"\n                  nbInput\n                  id=\"input-start-date\"\n                  name=\"startDate\"\n                  formControlName=\"startDate\"\n                  placeholder=\"Start Date\"\n                  [min]=\"\n                    discountAndOffer ? discountAndOffer.startDate : dateService.getDateString()\n                  \"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('startDate').touched\n                      ? discountAndOfferForm.get('startDate').invalid\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                />\n                <ng-container\n                  *ngIf=\"\n                    discountAndOfferForm.get('startDate').invalid &&\n                    discountAndOfferForm.get('startDate').touched\n                  \"\n                >\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('startDate').errors?.required\"\n                  >\n                    Start Date is required!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-expiry-date\">Expiry Date:</label>\n                <input\n                  type=\"date\"\n                  nbInput\n                  id=\"input-expiry-date\"\n                  name=\"expiryDate\"\n                  [min]=\"\n                    discountAndOffer ? discountAndOffer.startDate : dateService.getDateString()\n                  \"\n                  formControlName=\"expiryDate\"\n                  placeholder=\"Expiry Date \"\n                  fullWidth\n                />\n              </div>\n            </div>\n\n            <div class=\"col-md-12\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-billing-description\">Description:</label>\n                <textarea\n                  type=\"text\"\n                  nbInput\n                  id=\"input-description\"\n                  name=\"description\"\n                  formControlName=\"description\"\n                  placeholder=\"Description (Optional)\"\n                  fullWidth\n                ></textarea>\n              </div>\n            </div>\n\n            <div class=\"col-md-12\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-billing-terms-and-conditions\"\n                  >Terms & Conditions:</label\n                >\n                <textarea\n                  type=\"text\"\n                  nbInput\n                  id=\"input-terms-and-conditions\"\n                  name=\"termsAndConditions\"\n                  formControlName=\"termsAndConditions\"\n                  placeholder=\"Terms & Conditions (Optional)\"\n                  fullWidth\n                ></textarea>\n              </div>\n            </div>\n          </div>\n\n          <hr />\n\n          <div class=\"row\">\n            <div class=\"col-md-12 text-right\">\n              <button nbButton size=\"small\" type=\"submit\">\n                <span>Next</span>\n                <nb-icon icon=\"arrow-ios-forward-outline\"></nb-icon>\n              </button>\n            </div>\n          </div>\n        </form>\n      </nb-step>\n\n      <nb-step label=\"Submit\">\n        <div class=\"step-container\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-bordered\">\n              <tbody>\n                <tr>\n                  <th>Offer Name</th>\n                  <td>{{ discountAndOfferForm.value.offerName }}</td>\n                </tr>\n                <tr>\n                  <th>Offer Code</th>\n                  <td>{{ discountAndOfferForm.value.code }}</td>\n                </tr>\n                <tr>\n                  <th>Discount Type</th>\n                  <td>{{ discountAndOfferForm.value.discountType | uppercase }}</td>\n                </tr>\n                <tr>\n                  <th>Discount Amount</th>\n                  <td>\n                    {{\n                      discountAndOfferForm.value.discountType === 'percentage'\n                        ? discountAndOfferForm.value.discountAmount + '%'\n                        : getAmount(discountAndOfferForm.value.discountAmount)\n                    }}\n                  </td>\n                </tr>\n                <tr>\n                  <th>Start Date</th>\n                  <td>{{ dateService.formatDate(discountAndOfferForm.value.startDate) }}</td>\n                </tr>\n                <tr>\n                  <th>Expiry Date</th>\n                  <td>{{ dateService.formatDate(discountAndOfferForm.value.expiryDate) }}</td>\n                </tr>\n                <tr>\n                  <th>Description</th>\n                  <td>\n                    {{\n                      discountAndOfferForm.value.description\n                        ? discountAndOfferForm.value.description\n                        : '--'\n                    }}\n                  </td>\n                </tr>\n                <tr>\n                  <th>Terms & Conditions</th>\n                  <td>\n                    {{\n                      discountAndOfferForm.value.termsAndConditions\n                        ? discountAndOfferForm.value.termsAndConditions\n                        : '--'\n                    }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n\n          <hr />\n\n          <div class=\"row\">\n            <div class=\"col-6 text-left\">\n              <button class=\"\" nbButton size=\"small\" nbStepperPrevious [disabled]=\"submit\">\n                <nb-icon icon=\"arrow-ios-back-outline\"></nb-icon>\n                <span>prev</span>\n              </button>\n            </div>\n            <div class=\"col-6 text-right\">\n              <button\n                nbButton\n                size=\"small\"\n                (click)=\"saveDiscountAndOffer()\"\n                [disabled]=\"submit\"\n                [nbSpinner]=\"submit\"\n                nbSpinnerStatus=\"primary\"\n                nbSpinnerSize=\"small\"\n              >\n                <span>Submit</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </nb-step>\n    </nb-stepper>\n  </nb-card-body>\n</nb-card>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { AddDiscountAndOfferComponent } from './add-discount-and-offer.component';\n\nconst routes: Routes = [\n  { path: '', component: AddDiscountAndOfferComponent },\n\n  {\n    path: 'page-not-found',\n    loadChildren: () =>\n      import('../../../../../shared/page-not-found/page-not-found.module').then(\n        (m) => m.PageNotFoundModule,\n      ),\n  },\n\n  {\n    path: '**',\n    redirectTo: 'page-not-found',\n    pathMatch: 'full',\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AddDiscountAndOfferRoutingModule {}\n","import { DateService } from './../../../../../services/shared-services/date.service';\r\nimport { DiscountAndOfferModel } from './../../../../../models/discount-and-offer.model';\r\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\r\nimport { NbToastrService, NbStepperComponent } from '@nebular/theme';\r\nimport { DiscountAndOfferService } from './../../../../../services/discount-and-offer.service';\r\nimport { Component, OnInit, OnDestroy, ViewChild } from '@angular/core';\r\nimport { Router, ActivatedRoute, Params } from '@angular/router';\r\nimport { BranchService } from './../../../../../services/branch.service';\r\n\r\n@Component({\r\n  selector: 'ngx-add-discount-and-offer',\r\n  templateUrl: './add-discount-and-offer.component.html',\r\n  styleUrls: ['./add-discount-and-offer.component.scss'],\r\n})\r\nexport class AddDiscountAndOfferComponent implements OnInit, OnDestroy {\r\n  @ViewChild('stepper', { static: false }) stepper: NbStepperComponent;\r\n\r\n  loading: boolean;\r\n  submit: boolean;\r\n\r\n  private branchId: string;\r\n  private discountAndOfferId: string;\r\n  discountAndOffer: DiscountAndOfferModel;\r\n  discountAndOfferForm: FormGroup;\r\n  validOfferCode: boolean;\r\n  discountTypes: string[];\r\n  constructor(\r\n    private branchService: BranchService,\r\n    public dateService: DateService,\r\n    private discountAndOfferService: DiscountAndOfferService,\r\n    private toastrService: NbToastrService,\r\n\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n  ) {\r\n    this.route.queryParams.subscribe((param: Params) => {\r\n      if (param.mode) {\r\n        this.ngOnInit();\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.loading = true;\r\n    this.submit = false;\r\n\r\n    this.branchId = this.branchService.getBranchId();\r\n    if (!this.branchId) {\r\n      this.router.navigate(['../'], { relativeTo: this.route });\r\n\r\n      return;\r\n    }\r\n\r\n    this.discountAndOfferId = this.discountAndOfferService.getDiscountAndOfferId();\r\n\r\n    let mode: string;\r\n\r\n    this.route.queryParams.subscribe((param: Params) => {\r\n      mode = param.mode;\r\n    });\r\n\r\n    if (mode && mode !== 'edit') {\r\n      this.showToastr('top-right', 'danger', 'Invalid Route');\r\n      this.router.navigate(['../page-not-found'], { relativeTo: this.route });\r\n      return;\r\n    } else if (mode && !this.discountAndOfferId) {\r\n      this.showToastr('top-right', 'danger', 'Discount And Offer Not Available');\r\n      this.router.navigate(['../page-not-found'], { relativeTo: this.route });\r\n      return;\r\n    }\r\n\r\n    this.discountTypes = this.discountAndOfferService.getDiscountTypes();\r\n    this.validOfferCode = true;\r\n    this.discountAndOfferForm = new FormGroup(\r\n      {\r\n        offerName: new FormControl(null, {\r\n          validators: [Validators.required],\r\n        }),\r\n        code: new FormControl(null, {\r\n          validators: [Validators.required],\r\n        }),\r\n        discountType: new FormControl(null, {\r\n          validators: [Validators.required],\r\n        }),\r\n        discountAmount: new FormControl(null, {\r\n          validators: [Validators.required, Validators.min(0)],\r\n        }),\r\n        startDate: new FormControl(null, {\r\n          validators: [Validators.required],\r\n        }),\r\n        expiryDate: new FormControl(null, {\r\n          validators: [],\r\n        }),\r\n        description: new FormControl(null, {\r\n          validators: [],\r\n        }),\r\n        termsAndConditions: new FormControl(null, {\r\n          validators: [],\r\n        }),\r\n      },\r\n      {\r\n        validators: this.discountPercentageValidator.bind(this),\r\n      },\r\n    );\r\n\r\n    if (this.discountAndOfferId) {\r\n      this.discountAndOfferService.getDiscountAndOfferForEditing(this.discountAndOfferId).subscribe(\r\n        (discountAndOffer: DiscountAndOfferModel) => {\r\n          if (!discountAndOffer) {\r\n            this.router.navigate(['../page-not-found'], { relativeTo: this.route });\r\n            return;\r\n          }\r\n          this.discountAndOffer = discountAndOffer;\r\n          this.discountAndOfferForm.patchValue({\r\n            offerName: discountAndOffer.offerName,\r\n            code: discountAndOffer.code,\r\n            discountType: discountAndOffer.discountType,\r\n            discountAmount: discountAndOffer.discountAmount,\r\n            startDate: discountAndOffer.startDate,\r\n            expiryDate: discountAndOffer.expiryDate,\r\n            description: discountAndOffer.description,\r\n            termsAndConditions: discountAndOffer.termsAndConditions,\r\n          });\r\n\r\n          this.loading = false;\r\n        },\r\n        (err: any) => {\r\n          this.router.navigate(['../page-not-found'], { relativeTo: this.route });\r\n          return;\r\n        },\r\n      );\r\n    } else {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  getAmount(amount: any) {\r\n    amount = +amount;\r\n    if (amount) {\r\n      return amount.toFixed(2).toString() + '/-';\r\n    }\r\n    return amount;\r\n  }\r\n\r\n  discountPercentageValidator(group: FormGroup): { [s: string]: boolean } {\r\n    const discountType = group.value.discountType;\r\n    const amount = +group.value.discountAmount;\r\n    if (discountType === 'percentage' && amount > 100) {\r\n      return { invalidDiscountPercentage: true };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  checkOfferCode(code: any) {\r\n    if (this.discountAndOffer && this.discountAndOffer.code === code) {\r\n      this.validOfferCode = true;\r\n      return;\r\n    }\r\n    this.discountAndOfferService.CheckDiscountAndOffer(this.branchId, code).subscribe(\r\n      (res: any) => {\r\n        this.validOfferCode = res.status;\r\n      },\r\n      (err: any) => {},\r\n    );\r\n  }\r\n\r\n  submitDiscountAndOffer() {\r\n    this.discountAndOfferForm.markAllAsTouched();\r\n    if (this.discountAndOfferForm.invalid) {\r\n      this.showToastr('top-right', 'danger', 'Discount & Offer Details are required');\r\n      return;\r\n    } else if (!this.validOfferCode) {\r\n      this.showToastr('top-right', 'danger', 'This Offer Code Already Exist');\r\n      return;\r\n    }\r\n    this.stepper.next();\r\n  }\r\n\r\n  saveDiscountAndOffer() {\r\n    this.discountAndOfferForm.markAllAsTouched();\r\n\r\n    if (this.discountAndOfferForm.invalid) {\r\n      this.showToastr('top-right', 'danger', 'Discount & Offer Details are required');\r\n      return;\r\n    } else if (!this.validOfferCode) {\r\n      this.showToastr('top-right', 'danger', 'This Offer Code Already Exist');\r\n      return;\r\n    }\r\n    this.submit = true;\r\n\r\n    const discountAndOffer: any = this.discountAndOfferForm.value;\r\n    discountAndOffer.branch = this.branchId;\r\n\r\n    if (!this.discountAndOffer) {\r\n      this.discountAndOfferService.addDiscountAndOffer(discountAndOffer).subscribe(\r\n        (res: any) => {\r\n          this.showToastr('top-right', 'success', 'New Discount And Offer Added Successfully!');\r\n          this.back();\r\n        },\r\n        (error: any) => {\r\n          this.showToastr('top-right', 'danger', error);\r\n          this.submit = false;\r\n        },\r\n      );\r\n    } else {\r\n      discountAndOffer._id = this.discountAndOffer._id;\r\n\r\n      this.discountAndOfferService.editDiscountAndOffer(discountAndOffer).subscribe(\r\n        (res: any) => {\r\n          this.showToastr('top-right', 'success', 'Discount And Offer Updated Successfully!');\r\n          this.back();\r\n        },\r\n        (error: any) => {\r\n          this.showToastr('top-right', 'danger', error);\r\n          this.submit = false;\r\n        },\r\n      );\r\n    }\r\n  }\r\n\r\n  private showToastr(position: any, status: any, message: string) {\r\n    this.toastrService.show(status, message, {\r\n      position,\r\n      status,\r\n    });\r\n  }\r\n\r\n  back() {\r\n    this.router.navigate(['../'], { relativeTo: this.route, replaceUrl: true });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.discountAndOfferService.deleteDiscountAndOfferId();\r\n  }\r\n}\r\n","import { AddDiscountAndOfferComponent } from './add-discount-and-offer.component';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { AddDiscountAndOfferRoutingModule } from './add-discount-and-offer-routing.module';\n\nimport { ReactiveFormsModule } from '@angular/forms';\nimport {\n  NbCardModule,\n  NbButtonModule,\n  NbSelectModule,\n  NbIconModule,\n  NbInputModule,\n  NbFormFieldModule,\n  NbCheckboxModule,\n  NbSpinnerModule,\n  NbStepperModule,\n} from '@nebular/theme';\n@NgModule({\n  declarations: [AddDiscountAndOfferComponent],\n  imports: [\n    CommonModule,\n    AddDiscountAndOfferRoutingModule,\n\n    NbCardModule,\n    NbButtonModule,\n    NbSelectModule,\n    NbIconModule,\n    NbInputModule,\n    NbFormFieldModule,\n    NbCheckboxModule,\n    NbSpinnerModule,\n    NbStepperModule,\n    NbFormFieldModule,\n\n    ReactiveFormsModule,\n  ],\n})\nexport class AddDiscountAndOfferModule {}\n"]}