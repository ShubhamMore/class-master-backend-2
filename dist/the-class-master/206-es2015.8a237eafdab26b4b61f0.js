(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{h88D:function(e,t,a){"use strict";a.r(t),a.d(t,"StorageModule",(function(){return A}));var n=a("aceb"),r=a("ofXK"),o=a("hgTq"),c=a("6Ox6"),i=a("fXoL"),s=a("EQut"),l=a("s5zK"),g=a("L3Ly"),d=a("05WV"),m=a("lJxs"),p=a("JIr8"),h=a("2Vo4"),S=a("z6cu"),u=a("fCOA");let v=(()=>{class e{constructor(e){this.httpService=e,this.branchStorage=new h.a(null)}setBranchStorageDetails(e){this.branchStorage.next(e)}getBranchStorageDetails(){return this.branchStorage}deleteBranchStorageDetails(){this.branchStorage.next(null)}getBranchStorage(e){return this.httpService.httpPost({api:"getBranchStorage",data:{branch:e}}).pipe(Object(m.a)(e=>e),Object(p.a)(e=>Object(S.a)(e)))}updateBranchStorage(e,t,a,n){return this.httpService.httpPost({api:"updateBranchStorage",data:{branch:e,storagePackage:t,order:a,receipt:n}}).pipe(Object(m.a)(e=>e),Object(p.a)(e=>Object(S.a)(e)))}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275inject"](u.a))},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var b=a("tyNb"),x=a("ZatZ");function f(e,t){if(1&e&&(i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275elementStart"](1,"p"),i["\u0275\u0275elementStart"](2,"strong"),i["\u0275\u0275text"](3,"Extra Storage Package: "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"p"),i["\u0275\u0275elementStart"](6,"strong"),i["\u0275\u0275text"](7,"Extra Storage: "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](9,"p"),i["\u0275\u0275elementStart"](10,"strong"),i["\u0275\u0275text"](11,"Extra Storage Expires On: "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](12),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementContainerEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"](" ",e.branchStorage.storagePackage," "),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"](" ",e.convertByteToUnit(e.branchStorage.extraStorageAssigned)," "),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"](" ",e.dateService.formatDate(e.branchStorage.extraStorageExpireOn)," ")}}function E(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275text"](1,"\xa0Used"),i["\u0275\u0275elementEnd"]())}function I(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",6),i["\u0275\u0275elementStart"](1,"div",7),i["\u0275\u0275elementStart"](2,"p"),i["\u0275\u0275elementStart"](3,"strong"),i["\u0275\u0275text"](4,"Regular Storage: "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](5),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](6,f,13,3,"ng-container",8),i["\u0275\u0275elementStart"](7,"p"),i["\u0275\u0275elementStart"](8,"strong"),i["\u0275\u0275text"](9,"Total Storage: "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"div",7),i["\u0275\u0275elementStart"](12,"div",9),i["\u0275\u0275elementStart"](13,"h4"),i["\u0275\u0275text"](14),i["\u0275\u0275elementStart"](15,"small"),i["\u0275\u0275text"](16),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](17,"nb-progress-bar",10),i["\u0275\u0275template"](18,E,2,0,"span",8),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](19,"div",11),i["\u0275\u0275elementStart"](20,"bdi"),i["\u0275\u0275text"](21),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate1"](" ",e.convertByteToUnit(e.branchStorage.regularStorageAssigned)," "),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!!e.branchStorage.storagePackage),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"](" ",e.convertByteToUnit(e.branchStorage.totalStorageAssigned)," "),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"](" ",e.availableStorage," "),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate1"]("left of ",e.totalStorage,""),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("value",e.usedStorageInPercentage)("displayValue",!0),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.usedStorageInPercentage>=25),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate1"]("",e.usedStorage," Used")}}function k(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275element"](1,"nb-icon",19),i["\u0275\u0275text"](2," \xa0 "),i["\u0275\u0275elementStart"](3,"span"),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]().$implicit,t=i["\u0275\u0275nextContext"](3);i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"]("",t.upgradeAmount(e.price),"/-")}}function y(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",21),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]().$implicit;return i["\u0275\u0275nextContext"](3).activate(t)})),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]().$implicit,t=i["\u0275\u0275nextContext"](3);i["\u0275\u0275property"]("status","success")("nbTooltip",t.isUpgradable(e)?"Can't Downgrade Package":"Upgrade Package")("disabled",t.isUpgradable(e)),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",t.branchStorage.storagePackage&&e.packageName>t.branchStorage.storagePackage?"Upgrade":"Activate"," ")}}function P(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",13),i["\u0275\u0275elementStart"](1,"nb-card",14),i["\u0275\u0275elementStart"](2,"nb-card-header"),i["\u0275\u0275elementStart"](3,"h4",15),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"nb-card-body"),i["\u0275\u0275elementStart"](6,"div"),i["\u0275\u0275element"](7,"nb-icon",16),i["\u0275\u0275text"](8," \xa0 "),i["\u0275\u0275elementStart"](9,"span"),i["\u0275\u0275text"](10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"div"),i["\u0275\u0275element"](12,"nb-icon",17),i["\u0275\u0275text"](13," \xa0 "),i["\u0275\u0275elementStart"](14,"span"),i["\u0275\u0275text"](15),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](16,"div",18),i["\u0275\u0275element"](17,"nb-icon",19),i["\u0275\u0275text"](18," \xa0 "),i["\u0275\u0275elementStart"](19,"span"),i["\u0275\u0275text"](20),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](21,k,5,1,"div",8),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](22,"nb-card-footer"),i["\u0275\u0275template"](23,y,2,4,"button",20),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,a=i["\u0275\u0275nextContext"](3),n=i["\u0275\u0275reference"](21);i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate"](e.packageName),i["\u0275\u0275advance"](6),i["\u0275\u0275textInterpolate"](a.calculateStorageSize(e.storage)),i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate1"]("",a.dateService.convertDaysToMonths(e.validity)," Month/s"),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngClass",a.branchStorage.storagePackage&&e.packageName>a.branchStorage.storagePackage?"line-on-text":""),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"]("",a.getAmount(e.price),"/-"),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.packageName>a.branchStorage.storagePackage),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",a.branchStorage.storagePackage!==e.packageName)("ngIfElse",n)}}function C(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",6),i["\u0275\u0275template"](1,P,24,8,"div",12),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.storagePackages)}}function B(e,t){if(1&e&&(i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275template"](1,C,2,1,"div",1),i["\u0275\u0275elementContainerEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](),t=i["\u0275\u0275reference"](19);i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.storagePackages.length>0)("ngIfElse",t)}}function w(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"p",22),i["\u0275\u0275text"](1,"Loading..."),i["\u0275\u0275elementEnd"]())}function T(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"p",22),i["\u0275\u0275text"](1,"No Storage Packages"),i["\u0275\u0275elementEnd"]())}function j(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"button",23),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275property"]("status","success"),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ","Active"," "))}const O=[{path:"",component:(()=>{class e{constructor(e,t,a,n,r,o,c,i,s,l){this.branchService=e,this.dialogService=t,this.paymentService=a,this.storageService=n,this.storagePackageService=r,this.branchStorageService=o,this.toastrService=c,this.router=i,this.route=s,this.dateService=l}ngOnInit(){this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?this.branchStorageService.getBranchStorage(this.branchId).subscribe(e=>{this.branchStorage=e,this.calculateStorage(e),this.storagePackageService.getStoragePackages().subscribe(e=>{this.storagePackages=e,this.loading=!1},e=>{this.showToastr("top-right","danger",e),this.loading=!1})},e=>{this.showToastr("top-right","danger",e),this.loading=!1}):this.router.navigate(["../page-not-found"],{relativeTo:this.route})}onClosePayment(e){e.status&&this.updateStorage(e.order,e.receipt)}updateStorage(e,t){this.branchStorageService.updateBranchStorage(this.branchId,this.paymentDetails.packageType,e,t).subscribe(e=>{this.ngOnInit()},e=>{this.showToastr("top-right","danger",e)})}isUpgradable(e){return!(!this.branchStorage.storagePackage||e.packageName>this.branchStorage.storagePackage)}upgradeAmount(e){const t=this.dateService.dateDifferenceInDays(this.dateService.getDateString(),this.branchStorage.extraStorageExpireOn),a=this.storagePackages.find(e=>e.packageName===this.branchStorage.storagePackage);return this.getAmount(Math.round(1.1*+(e-+a.price/+a.validity*+t))).toString()}onCheckout(e){e.status&&this.dialogService.open(c.a,{context:{},closeOnBackdropClick:!1,closeOnEsc:!1}).onClose.subscribe(e=>e&&this.onClosePayment(e))}activate(e){const t=this.branchStorage.storagePackage&&e.packageName>this.branchStorage.storagePackage?this.upgradeAmount(e.price):e.price.toString();this.paymentService.setPaymentDetails("storage",e.packageName,t,this.branchStorage.storagePackage&&e.packageName>this.branchStorage.storagePackage?"upgrade":"new"),this.paymentDetails=this.paymentService.getPaymentDetails(),this.dialogService.open(o.a,{context:{},closeOnBackdropClick:!1,closeOnEsc:!1}).onClose.subscribe(e=>e&&this.onCheckout(e))}convertByteToUnit(e){const t=this.storageService.convertByteToUnit(e);return t.value.toFixed(1)+" "+t.unit}calculateStorageSize(e){const t=this.storageService.convertUnitToBytes(e,"MB"),a=this.storageService.convertByteToUnit(t);return a.value.toFixed(1)+" "+a.unit}calculateStorage(e){const t=this.storageService.convertByteToUnit(e.totalStorageAssigned),a=this.storageService.convertByteToUnit(e.totalStorageUsed),n=this.storageService.convertByteToUnit(e.totalStorageAssigned-e.totalStorageUsed);this.totalStorage=t.value.toFixed(1)+" "+t.unit,this.usedStorage=a.value.toFixed(1)+" "+a.unit,this.availableStorage=n.value.toFixed(1)+" "+n.unit,this.usedStorageInPercentage=parseInt((100*e.totalStorageUsed/e.totalStorageAssigned).toFixed(1))}getAmount(e){return(e=parseFloat(e.toString())).toFixed(2).toString()}back(){this.router.navigate(["../"],{relativeTo:this.route})}showToastr(e,t,a){this.toastrService.show(t,a,{position:e,status:t})}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](s.a),i["\u0275\u0275directiveInject"](n.K),i["\u0275\u0275directiveInject"](l.a),i["\u0275\u0275directiveInject"](g.a),i["\u0275\u0275directiveInject"](d.a),i["\u0275\u0275directiveInject"](v),i["\u0275\u0275directiveInject"](n.Gb),i["\u0275\u0275directiveInject"](b.c),i["\u0275\u0275directiveInject"](b.a),i["\u0275\u0275directiveInject"](x.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-storage"]],decls:22,vars:4,consts:[["nbButton","","size","small","status","warning",1,"float-right",3,"click"],["class","row",4,"ngIf","ngIfElse"],[4,"ngIf","ngIfElse"],["loadingData",""],["noPackages",""],["activePackage",""],[1,"row"],[1,"col-md-6","col-12"],[4,"ngIf"],[1,"progress-info"],["status","danger",3,"value","displayValue"],[1,"caption","description"],["class","col-md-3 col-sm-6 col-12 mx-auto",4,"ngFor","ngForOf"],[1,"col-md-3","col-sm-6","col-12","mx-auto"],[1,"card"],[1,"text-center"],["icon","hard-drive-outline"],["icon","clock-outline"],[3,"ngClass"],["icon","pricetags-outline"],["class","float-right","nbButton","","outline","","size","small",3,"status","nbTooltip","disabled","click",4,"ngIf","ngIfElse"],["nbButton","","outline","","size","small",1,"float-right",3,"status","nbTooltip","disabled","click"],[1,"pt-5","pb-5","text-center"],["nbButton","","size","small",1,"float-right",3,"status"]],template:function(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"nb-card"),i["\u0275\u0275elementStart"](1,"nb-card-header"),i["\u0275\u0275elementStart"](2,"button",0),i["\u0275\u0275listener"]("click",(function(){return t.back()})),i["\u0275\u0275text"](3," Back "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"h4"),i["\u0275\u0275text"](5,"Storage"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"nb-card-body"),i["\u0275\u0275template"](7,I,22,9,"div",1),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"nb-card"),i["\u0275\u0275elementStart"](9,"nb-card-header"),i["\u0275\u0275elementStart"](10,"h6"),i["\u0275\u0275text"](11,"Want to increase Storage?"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"h4"),i["\u0275\u0275text"](13,"Storage Packages"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](14,"nb-card-body"),i["\u0275\u0275template"](15,B,2,2,"ng-container",2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](16,w,2,0,"ng-template",null,3,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275template"](18,T,2,0,"ng-template",null,4,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275template"](20,j,2,2,"ng-template",null,5,i["\u0275\u0275templateRefExtractor"])),2&e){const e=i["\u0275\u0275reference"](17);i["\u0275\u0275advance"](7),i["\u0275\u0275property"]("ngIf",!t.loading)("ngIfElse",e),i["\u0275\u0275advance"](8),i["\u0275\u0275property"]("ngIf",!t.loading)("ngIfElse",e)}},directives:[n.y,n.A,n.v,n.x,r.n,n.kb,r.m,n.N,r.l,n.z,n.Ib],styles:[".line-on-text[_ngcontent-%COMP%]{text-decoration:line-through}.card[_ngcontent-%COMP%]{height:16rem}"]}),e})()},{path:"page-not-found",loadChildren:()=>a.e(0).then(a.bind(null,"DeSt")).then(e=>e.PageNotFoundModule)},{path:"**",redirectTo:"page-not-found",pathMatch:"full"}];let U=(()=>{class e{}return e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[b.g.forChild(O)],b.g]}),e})(),A=(()=>{class e{}return e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.c,U,n.B,n.w,n.P,n.lb,n.Jb]]}),e})()}}]);
//# sourceMappingURL=206-es2015.8a237eafdab26b4b61f0.js.map