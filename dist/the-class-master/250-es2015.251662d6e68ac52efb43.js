(window.webpackJsonp=window.webpackJsonp||[]).push([[250],{jX92:function(t,e,n){"use strict";n.r(e),n.d(e,"OnlineTestQuestionModule",(function(){return k}));var i=n("aceb"),a=n("ofXK"),s=n("fXoL"),o=n("EQut"),r=n("RSY0"),l=n("gmaa"),m=n("tyNb");function u(t,e){if(1&t){const t=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",4),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](t);const e=s["\u0275\u0275nextContext"]();return e.examStarted?e.submitExam():e.startExam()})),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()}if(2&t){const t=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",t.examStarted?"Submit":"Start"," Exam ")}}function c(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"p"),s["\u0275\u0275elementStart"](1,"span"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate2"]("",t.getDate(t.onlineExam.date),".\xa0",t.getTime(t.onlineExam.time),"")}}function d(t,e){1&t&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"p",5),s["\u0275\u0275text"](2,"Click on Start Exam"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]())}function x(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"p",13),s["\u0275\u0275text"](1," Exam will End In "),s["\u0275\u0275element"](2,"br"),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"](3);s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",t.examCountDownTimer," ")}}function p(t,e){1&t&&(s["\u0275\u0275elementStart"](0,"p",13),s["\u0275\u0275text"](1," Exam Ended "),s["\u0275\u0275elementEnd"]())}function h(t,e){if(1&t){const t=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",14),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](t),s["\u0275\u0275nextContext"](3).previousQuestion()})),s["\u0275\u0275element"](1,"nb-icon",15),s["\u0275\u0275elementEnd"]()}}function f(t,e){if(1&t){const t=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",16),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](t),s["\u0275\u0275nextContext"](3).nextQuestion()})),s["\u0275\u0275element"](1,"nb-icon",17),s["\u0275\u0275elementEnd"]()}}function g(t,e){if(1&t){const t=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"nb-checkbox",20),s["\u0275\u0275listener"]("checkedChange",(function(n){s["\u0275\u0275restoreView"](t);const i=e.$implicit,a=e.index,o=s["\u0275\u0275nextContext"](4);return o.markAnswer(o.currentQuestion._id,o.currentQuestionIndex,i._id,a,n)})),s["\u0275\u0275elementStart"](2,"strong"),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](4," \xa0\xa0 "),s["\u0275\u0275elementStart"](5,"span"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&t){const t=e.$implicit,n=e.index;s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",n+1,"."),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](t.answer)}}function S(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"div",6),s["\u0275\u0275elementStart"](1,"div",7),s["\u0275\u0275elementStart"](2,"p",18),s["\u0275\u0275elementStart"](3,"strong"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"p"),s["\u0275\u0275elementStart"](6,"Strong"),s["\u0275\u0275text"](7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](8,g,7,2,"div",19),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"](3);s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Question ",t.currentQuestionIndex+1,""),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](t.currentQuestion.question),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",t.currentQuestion.answers)}}function E(t,e){1&t&&(s["\u0275\u0275elementStart"](0,"p",18),s["\u0275\u0275text"](1,"Calculating Result"),s["\u0275\u0275elementEnd"]())}function v(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"p",18),s["\u0275\u0275elementStart"](1,"span"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"span"),s["\u0275\u0275text"](4,","),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"span"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](7,"br"),s["\u0275\u0275elementStart"](8,"span"),s["\u0275\u0275text"](9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"span"),s["\u0275\u0275text"](11,","),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"span"),s["\u0275\u0275text"](13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](14,"br"),s["\u0275\u0275elementStart"](15,"strong"),s["\u0275\u0275text"](16,"You got: "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](17),s["\u0275\u0275element"](18,"br"),s["\u0275\u0275elementStart"](19,"strong"),s["\u0275\u0275text"](20),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"](4);s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("Attempted: ",t.onlineExamResult.answeredQuestions," "),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Unattempted: ",t.onlineExamResult.unAnsweredQuestions," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("Correct Answers: ",t.onlineExamResult.correctAnswers,""),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Wrong Answers: ",t.onlineExamResult.wrongAnswers,""),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate2"](" ",t.onlineExamResult.marks,"/",t.onlineExam.totalMarks," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](t.onlineExamResult.status?"Pass":"Failed")}}function w(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"div",6),s["\u0275\u0275elementStart"](1,"div",21),s["\u0275\u0275template"](2,E,2,0,"p",22),s["\u0275\u0275template"](3,v,21,7,"p",22),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"](3);s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.calculatingResult),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.calculatingResult)}}function I(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"div",6),s["\u0275\u0275elementStart"](2,"div",7),s["\u0275\u0275template"](3,x,4,1,"p",8),s["\u0275\u0275template"](4,p,2,0,"p",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",9),s["\u0275\u0275template"](6,h,2,0,"button",10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"div",9),s["\u0275\u0275template"](8,f,2,0,"button",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](9,"hr"),s["\u0275\u0275template"](10,S,9,3,"div",12),s["\u0275\u0275template"](11,w,4,2,"div",12),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",t.examCountDownTimer),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.examCountDownTimer&&t.examSubmitted),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.currentQuestionIndex>0&&!t.examSubmitted),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.currentQuestionIndex<t.questions.length-1&&!t.examSubmitted),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",!t.examSubmitted),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.examSubmitted)}}function b(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275template"](1,d,3,0,"div",1),s["\u0275\u0275template"](2,I,12,6,"div",1),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.examStarted),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.examStarted)}}function T(t,e){1&t&&(s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275text"](1," Loading... "),s["\u0275\u0275elementEnd"]())}function Q(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275text"](1," Exam will Start In "),s["\u0275\u0275element"](2,"br"),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",t.waitingToStart," ")}}function y(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"p",23),s["\u0275\u0275template"](1,T,2,0,"span",1),s["\u0275\u0275template"](2,Q,4,1,"span",1),s["\u0275\u0275elementEnd"]()),2&t){const t=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","loading"===t.waitingToStart),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","loading"!==t.waitingToStart)}}const C=[{path:"",component:(()=>{class t{constructor(t,e,n,i,a,s){this.branchService=t,this.toastrService=e,this.onlineExamService=n,this.onlineExamQuestionService=i,this.router=a,this.route=s}ngOnInit(){this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?(this.waitingToStart="loading",this.onlineExamService.getOnlineExamData().subscribe(t=>{t?this.onlineExam=t:this.back()}),this.questions=[],this.onlineExamService.getOnlineExamResult(this.onlineExam._id).subscribe(t=>{if(t)this.onlineExamResult=t,this.waitingToStart=null,this.examStarted=!0,this.examSubmitted=!0,this.calculatingResult=!1;else{const t=new Date(this.onlineExam.date+"T"+this.onlineExam.time).getTime();this.examStartTime=t,this.examStarted=!1,this.examSubmitted=!1,this.examTimeUp=!1;const e=setInterval(()=>{const n=(new Date).getTime(),i=t-n,a=Math.floor(i%864e5/36e5),s=Math.floor(i%36e5/6e4),o=Math.floor(i%6e4/1e3);this.waitingToStart=a+"H "+s+"M "+o+"S ",i<0&&(clearInterval(e),this.waitingToStart=null),this.loading&&(this.loading=!1)},1e3)}this.loading=!1},t=>{this.showToastr("top-right","danger",t),this.loading=!1})):this.back()}getDate(t){return(t=new Date(t).toString()).substring(0,3)+", "+t.substring(4,15)}getTime(t){const e=+t.split(":")[0],n=t.split(":")[1];return+e>12?(+e-12).toString().padStart(2,"0")+":"+n+" PM":e.toString().padStart(2,"0")+":"+n+" AM"}startExam(){this.onlineExamQuestionService.getOnlineExamQuestionsForStudent(this.onlineExam._id).subscribe(t=>{this.questions=t,this.waitingToStart=null,this.examStarted=!0,this.studentQuestionAnswers=[],this.currentQuestionIndex=0,this.currentQuestion=this.questions[0];const e=60*+this.onlineExam.duration*1e3,n=(new Date).getTime(),i=this.examStartTime+e+0;i-n>=e?this.examEndTime=n+e:i>n?(this.examEndTime=this.examStartTime+e+0,this.examCountDown()):(this.examEndTime=null,this.examTimeUp=!0,this.submitExam())},t=>{this.showToastr("top-right","danger",t)})}examCountDown(){this.examInterval=setInterval(()=>{return t=this,void 0,n=function*(){const t=(new Date).getTime(),e=this.examEndTime-t,n=Math.floor(e%864e5/36e5),i=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3);this.examCountDownTimer=n+"H "+i+"M "+a+"S ",e<0&&(this.examCountDownTimer=null,this.examTimeUp=!0,this.submitExam())},new((e=void 0)||(e=Promise))((function(i,a){function s(t){try{r(n.next(t))}catch(e){a(e)}}function o(t){try{r(n.throw(t))}catch(e){a(e)}}function r(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,o)}r((n=n.apply(t,[])).next())}));var t,e,n},1e3)}previousQuestion(){this.currentQuestionIndex-=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}nextQuestion(){this.currentQuestionIndex+=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}markAnswer(t,e,n,i,a){const s=this.studentQuestionAnswers.findIndex(e=>e.questionId===t);if(a)if(s<0){const i={questionId:t,questionIndex:e,answerIds:[]};i.answerIds.push(n),this.studentQuestionAnswers.push(i)}else{const t=this.studentQuestionAnswers[s];t.answerIds.push(n),this.studentQuestionAnswers[s]=t}else if(s>-1){const t=this.studentQuestionAnswers[s],e=t.answerIds.findIndex(t=>t.answerId===n);t.answerIds.splice(e,1),this.studentQuestionAnswers[s]=t}}submitExam(){let t=!0;this.examTimeUp||(t=window.confirm("Do you want to Submit the Exam?")),t&&(this.calculatingResult=!0,this.examSubmitted=!0,this.currentQuestion=null,this.currentQuestionIndex=null,clearInterval(this.examInterval),this.examCountDownTimer=null,this.onlineExamService.saveOnlineExamResult(this.studentQuestionAnswers,this.onlineExam._id).subscribe(t=>{this.onlineExamResult=t.onlineExamResult,0===t.type&&this.showToastr("top-right","success","Exam Submitted Successfully!"),this.calculatingResult=!1},t=>{this.showToastr("top-right","danger",t)}))}showToastr(t,e,n){this.toastrService.show(e,n,{position:t,status:e})}back(){this.router.navigate(["../"],{relativeTo:this.route})}ngOnDestroy(){clearInterval(this.examInterval)}}return t.\u0275fac=function(e){return new(e||t)(s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](i.Gb),s["\u0275\u0275directiveInject"](r.a),s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](m.c),s["\u0275\u0275directiveInject"](m.a))},t.\u0275cmp=s["\u0275\u0275defineComponent"]({type:t,selectors:[["ngx-online-test-question"]],decls:10,vars:5,consts:[["type","button","class","float-right","nbButton","","size","small","status","success",3,"click",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["examStartCountDown",""],["type","button","nbButton","","size","small","status","success",1,"float-right",3,"click"],["id","countDown",1,"pt-5","pb-5","text-center"],[1,"row"],[1,"col-12"],["class","text-right","id","examCountDownTimer",4,"ngIf"],[1,"col-6"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click",4,"ngIf"],["class","float-right","type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",3,"click",4,"ngIf"],["class","row",4,"ngIf"],["id","examCountDownTimer",1,"text-right"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click"],["icon","arrow-ios-back-outline"],["type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",1,"float-right",3,"click"],["icon","arrow-ios-forward-outline"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"checkedChange"],[1,"col-12","pt-3","pb-3"],["class","text-center",4,"ngIf"],["id","waitingToStart",1,"pt-5","pb-5","text-center"]],template:function(t,e){if(1&t&&(s["\u0275\u0275elementStart"](0,"nb-card"),s["\u0275\u0275elementStart"](1,"nb-card-header"),s["\u0275\u0275template"](2,u,2,1,"button",0),s["\u0275\u0275elementStart"](3,"h3"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](5,c,3,2,"p",1),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"nb-card-body"),s["\u0275\u0275template"](7,b,3,2,"div",2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](8,y,3,2,"ng-template",null,3,s["\u0275\u0275templateRefExtractor"])),2&t){const t=s["\u0275\u0275reference"](9);s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",!e.examSubmitted&&!e.waitingToStart),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",e.onlineExam?e.onlineExam.title:"Online Exam"," "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.onlineExam),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",!e.waitingToStart)("ngIfElse",t)}},directives:[i.y,i.A,a.n,i.x,i.v,i.Ib,i.N,a.m,i.D],styles:[""]}),t})()},{path:"page-not-found",loadChildren:()=>n.e(0).then(n.bind(null,"DeSt")).then(t=>t.PageNotFoundModule)},{path:"**",redirectTo:"page-not-found",pathMatch:"full"}];let D=(()=>{class t{}return t.\u0275mod=s["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[m.g.forChild(C)],m.g]}),t})(),k=(()=>{class t{}return t.\u0275mod=s["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[a.c,D,i.B,i.w,i.P,i.Jb,i.E]]}),t})()}}]);
//# sourceMappingURL=250-es2015.251662d6e68ac52efb43.js.map