{"version":3,"sources":["webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer.component.html","webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer-routing.module.ts","webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer.component.ts","webpack:///src/app/institute/branch/manage-branch/discount-and-offer/add-discount-and-offer/add-discount-and-offer.module.ts"],"names":["routes","path","component","AddDiscountAndOfferComponent","branchService","dateService","discountAndOfferService","toastrService","router","route","this","queryParams","subscribe","param","mode","ngOnInit","loading","submit","branchId","getBranchId","navigate","relativeTo","discountAndOfferId","getDiscountAndOfferId","showToastr","discountTypes","getDiscountTypes","validOfferCode","discountAndOfferForm","offerName","validators","required","code","discountType","discountAmount","min","startDate","expiryDate","description","termsAndConditions","discountPercentageValidator","bind","getDiscountAndOfferForEditing","discountAndOffer","patchValue","err","group","value","invalidDiscountPercentage","CheckDiscountAndOffer","res","status","markAllAsTouched","invalid","stepper","next","branch","_id","editDiscountAndOffer","back","error","addDiscountAndOffer","position","message","show","replaceUrl","deleteDiscountAndOfferId","submitDiscountAndOffer","checkOfferCode","saveDiscountAndOffer","loadChildren","then","m","PageNotFoundModule","redirectTo","pathMatch","AddDiscountAndOfferRoutingModule","forChild","AddDiscountAndOfferModule"],"mappings":"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","file":"x","sourcesContent":["<nb-card>\n  <nb-card-header>\n    <button class=\"float-right\" nbButton size=\"small\" status=\"warning\" (click)=\"back()\">\n      Back\n    </button>\n    <h3 class=\"\">\n      {{\n        !discountAndOffer\n          ? 'Add New DiscountAndOffer'\n          : 'Edit Offer ' + (discountAndOffer.offerName | uppercase)\n      }}\n    </h3>\n  </nb-card-header>\n  <nb-card-body>\n    <nb-stepper #stepper [linear]=\"true\">\n      <nb-step [stepControl]=\"discountAndOfferForm\" label=\"Basic Details\">\n        <form class=\"\" (submit)=\"submitDiscountAndOffer()\" [formGroup]=\"discountAndOfferForm\">\n          <h6>Discount & Offer:</h6>\n          <div class=\"row\">\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-offer-name\">Offer Name:</label>\n                <input\n                  type=\"text\"\n                  nbInput\n                  id=\"input-offer-name\"\n                  name=\"offerName\"\n                  formControlName=\"offerName\"\n                  placeholder=\"Offer Name\"\n                  maxlength=\"30\"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('offerName').touched\n                      ? discountAndOfferForm.get('offerName').invalid\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                />\n                <ng-container\n                  *ngIf=\"\n                    discountAndOfferForm.get('offerName').invalid &&\n                    discountAndOfferForm.get('offerName').touched\n                  \"\n                >\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('offerName').errors?.required\"\n                  >\n                    Offer Name is required!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-code\">Code:</label>\n                <input\n                  type=\"text\"\n                  nbInput\n                  id=\"input-code\"\n                  name=\"code\"\n                  formControlName=\"code\"\n                  placeholder=\"Code\"\n                  maxlength=\"30\"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('code').touched\n                      ? discountAndOfferForm.get('code').invalid || !validOfferCode\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                  (input)=\"checkOfferCode($event.target.value)\"\n                />\n                <ng-container *ngIf=\"discountAndOfferForm.get('code').touched\">\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('code').errors?.required\"\n                  >\n                    Code is required!\n                  </p>\n                  <p class=\"caption status-danger\" *ngIf=\"!validOfferCode\">\n                    This Offer Code Already Exist!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-billing-discount-type\">Discount Type:</label>\n                <nb-select\n                  id=\"input-discount-type\"\n                  name=\"discountType\"\n                  formControlName=\"discountType\"\n                  placeholder=\"Select Discount Type\"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('discountType').touched\n                      ? discountAndOfferForm.get('discountType').invalid\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                >\n                  <nb-option value=\"\">Select Discount Type</nb-option>\n                  <nb-option *ngFor=\"let discountType of discountTypes\" [value]=\"discountType\">{{\n                    discountType | uppercase\n                  }}</nb-option>\n                </nb-select>\n                <ng-container *ngIf=\"discountAndOfferForm.get('discountType').touched\">\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('discountType').errors?.required\"\n                  >\n                    Discount Type is required!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-discount-amount\">Discount Amount:</label>\n                <input\n                  type=\"number\"\n                  nbInput\n                  id=\"input-discount-amount\"\n                  name=\"discountAmount\"\n                  min=\"0\"\n                  formControlName=\"discountAmount\"\n                  placeholder=\"Discount {{\n                    discountAndOfferForm.value.discountType === 'percentage'\n                      ? 'Percentage (%)'\n                      : 'Amount'\n                  }} \"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('discountAmount').touched\n                      ? discountAndOfferForm.get('discountAmount').invalid ||\n                        discountAndOfferForm.hasError('invalidDiscountPercentage')\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                />\n                <ng-container *ngIf=\"discountAndOfferForm.get('discountAmount').touched\">\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('discountAmount').errors?.required\"\n                  >\n                    Discount Amount is required!\n                  </p>\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('discountAmount').errors?.min\"\n                  >\n                    Discount Amount should be more than or equal to 0\n                  </p>\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.hasError('invalidDiscountPercentage')\"\n                  >\n                    Discount Percentage should be between 0% to 100%\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-start-date\">Start Date:</label>\n                <input\n                  type=\"date\"\n                  nbInput\n                  id=\"input-start-date\"\n                  name=\"startDate\"\n                  formControlName=\"startDate\"\n                  placeholder=\"Start Date\"\n                  [min]=\"\n                    discountAndOffer ? discountAndOffer.startDate : dateService.getDateString()\n                  \"\n                  fullWidth\n                  [status]=\"\n                    discountAndOfferForm.get('startDate').touched\n                      ? discountAndOfferForm.get('startDate').invalid\n                        ? 'danger'\n                        : 'success'\n                      : 'basic'\n                  \"\n                />\n                <ng-container\n                  *ngIf=\"\n                    discountAndOfferForm.get('startDate').invalid &&\n                    discountAndOfferForm.get('startDate').touched\n                  \"\n                >\n                  <p\n                    class=\"caption status-danger\"\n                    *ngIf=\"discountAndOfferForm.get('startDate').errors?.required\"\n                  >\n                    Start Date is required!\n                  </p>\n                </ng-container>\n              </div>\n            </div>\n\n            <div class=\"col-md-4\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-expiry-date\">Expiry Date:</label>\n                <input\n                  type=\"date\"\n                  nbInput\n                  id=\"input-expiry-date\"\n                  name=\"expiryDate\"\n                  [min]=\"\n                    discountAndOffer ? discountAndOffer.startDate : dateService.getDateString()\n                  \"\n                  formControlName=\"expiryDate\"\n                  placeholder=\"Expiry Date \"\n                  fullWidth\n                />\n              </div>\n            </div>\n\n            <div class=\"col-md-12\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-billing-description\">Description:</label>\n                <textarea\n                  type=\"text\"\n                  nbInput\n                  id=\"input-description\"\n                  name=\"description\"\n                  formControlName=\"description\"\n                  placeholder=\"Description (Optional)\"\n                  fullWidth\n                ></textarea>\n              </div>\n            </div>\n\n            <div class=\"col-md-12\">\n              <div class=\"form-control-group\">\n                <label class=\"label\" for=\"input-billing-terms-and-conditions\"\n                  >Terms & Conditions:</label\n                >\n                <textarea\n                  type=\"text\"\n                  nbInput\n                  id=\"input-terms-and-conditions\"\n                  name=\"termsAndConditions\"\n                  formControlName=\"termsAndConditions\"\n                  placeholder=\"Terms & Conditions (Optional)\"\n                  fullWidth\n                ></textarea>\n              </div>\n            </div>\n          </div>\n\n          <hr />\n\n          <div class=\"row\">\n            <div class=\"col-md-12 text-right\">\n              <button nbButton size=\"small\" type=\"submit\">\n                <span>Next</span>\n                <nb-icon icon=\"arrow-ios-forward-outline\"></nb-icon>\n              </button>\n            </div>\n          </div>\n        </form>\n      </nb-step>\n\n      <nb-step label=\"Submit\">\n        <div class=\"step-container\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-bordered\">\n              <tbody>\n                <tr>\n                  <th>Offer Name</th>\n                  <td>{{ discountAndOfferForm.value.offerName }}</td>\n                </tr>\n                <tr>\n                  <th>Offer Code</th>\n                  <td>{{ discountAndOfferForm.value.code }}</td>\n                </tr>\n                <tr>\n                  <th>Discount Type</th>\n                  <td>{{ discountAndOfferForm.value.discountType | uppercase }}</td>\n                </tr>\n                <tr>\n                  <th>Discount Amount</th>\n                  <td>\n                    {{ discountAndOfferForm.value.discountAmount }}\n                    {{ discountAndOfferForm.value.discountType === 'percentage' ? '%' : '' }}\n                  </td>\n                </tr>\n                <tr>\n                  <th>Start Date</th>\n                  <td>{{ dateService.formatDate(discountAndOfferForm.value.startDate) }}</td>\n                </tr>\n                <tr>\n                  <th>Expiry Date</th>\n                  <td>{{ dateService.formatDate(discountAndOfferForm.value.expiryDate) }}</td>\n                </tr>\n                <tr>\n                  <th>Description</th>\n                  <td>{{ discountAndOfferForm.value.description }}</td>\n                </tr>\n                <tr>\n                  <th>Terms & Conditions</th>\n                  <td>{{ discountAndOfferForm.value.termsAndConditions }}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n\n          <hr />\n\n          <div class=\"row\">\n            <div class=\"col-6 text-left\">\n              <button class=\"\" nbButton size=\"small\" nbStepperPrevious [disabled]=\"submit\">\n                <nb-icon icon=\"arrow-ios-back-outline\"></nb-icon>\n                <span>prev</span>\n              </button>\n            </div>\n            <div class=\"col-6 text-right\">\n              <button\n                nbButton\n                size=\"small\"\n                (click)=\"saveDiscountAndOffer()\"\n                [disabled]=\"submit\"\n                [nbSpinner]=\"submit\"\n                nbSpinnerStatus=\"primary\"\n                nbSpinnerSize=\"small\"\n              >\n                <span>Submit</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </nb-step>\n    </nb-stepper>\n  </nb-card-body>\n</nb-card>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { AddDiscountAndOfferComponent } from './add-discount-and-offer.component';\n\nconst routes: Routes = [\n  { path: '', component: AddDiscountAndOfferComponent },\n\n  {\n    path: 'page-not-found',\n    loadChildren: () =>\n      import('../../../../../shared/page-not-found/page-not-found.module').then(\n        (m) => m.PageNotFoundModule,\n      ),\n  },\n\n  {\n    path: '**',\n    redirectTo: 'page-not-found',\n    pathMatch: 'full',\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AddDiscountAndOfferRoutingModule {}\n","import { DateService } from './../../../../../services/shared-services/date.service';\nimport { DiscountAndOfferModel } from './../../../../../models/discount-and-offer.model';\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\nimport { NbToastrService, NbStepperComponent } from '@nebular/theme';\nimport { DiscountAndOfferService } from './../../../../../services/discount-and-offer.service';\nimport { Component, OnInit, OnDestroy, ViewChild } from '@angular/core';\nimport { Router, ActivatedRoute, Params } from '@angular/router';\nimport { BranchService } from './../../../../../services/branch.service';\n\n@Component({\n  selector: 'ngx-add-discount-and-offer',\n  templateUrl: './add-discount-and-offer.component.html',\n  styleUrls: ['./add-discount-and-offer.component.scss'],\n})\nexport class AddDiscountAndOfferComponent implements OnInit, OnDestroy {\n  @ViewChild('stepper', { static: false }) stepper: NbStepperComponent;\n\n  loading: boolean;\n  submit: boolean;\n\n  private branchId: string;\n  private discountAndOfferId: string;\n  discountAndOffer: DiscountAndOfferModel;\n  discountAndOfferForm: FormGroup;\n  validOfferCode: boolean;\n  discountTypes: string[];\n  constructor(\n    private branchService: BranchService,\n    public dateService: DateService,\n    private discountAndOfferService: DiscountAndOfferService,\n    private toastrService: NbToastrService,\n\n    private router: Router,\n    private route: ActivatedRoute,\n  ) {\n    this.route.queryParams.subscribe((param: Params) => {\n      if (param.mode) {\n        this.ngOnInit();\n      }\n    });\n  }\n\n  ngOnInit(): void {\n    this.loading = true;\n    this.submit = false;\n\n    this.branchId = this.branchService.getBranchId();\n    if (!this.branchId) {\n      this.router.navigate(['../'], { relativeTo: this.route });\n\n      return;\n    }\n\n    this.discountAndOfferId = this.discountAndOfferService.getDiscountAndOfferId();\n\n    let mode: string;\n\n    this.route.queryParams.subscribe((param: Params) => {\n      mode = param.mode;\n    });\n\n    if (mode && mode !== 'edit') {\n      this.showToastr('top-right', 'danger', 'Invalid Route');\n      this.router.navigate(['../page-not-found'], { relativeTo: this.route });\n      return;\n    } else if (mode && !this.discountAndOfferId) {\n      this.showToastr('top-right', 'danger', 'Discount And Offer Not Available');\n      this.router.navigate(['../page-not-found'], { relativeTo: this.route });\n      return;\n    }\n\n    this.discountTypes = this.discountAndOfferService.getDiscountTypes();\n    this.validOfferCode = true;\n    this.discountAndOfferForm = new FormGroup(\n      {\n        offerName: new FormControl(null, {\n          validators: [Validators.required],\n        }),\n        code: new FormControl(null, {\n          validators: [Validators.required],\n        }),\n        discountType: new FormControl(null, {\n          validators: [Validators.required],\n        }),\n        discountAmount: new FormControl(null, {\n          validators: [Validators.required, Validators.min(0)],\n        }),\n        startDate: new FormControl(null, {\n          validators: [Validators.required],\n        }),\n        expiryDate: new FormControl(null, {\n          validators: [],\n        }),\n        description: new FormControl(null, {\n          validators: [],\n        }),\n        termsAndConditions: new FormControl(null, {\n          validators: [],\n        }),\n      },\n      {\n        validators: this.discountPercentageValidator.bind(this),\n      },\n    );\n\n    if (this.discountAndOfferId) {\n      this.discountAndOfferService.getDiscountAndOfferForEditing(this.discountAndOfferId).subscribe(\n        (discountAndOffer: DiscountAndOfferModel) => {\n          if (!discountAndOffer) {\n            this.router.navigate(['../page-not-found'], { relativeTo: this.route });\n            return;\n          }\n          this.discountAndOffer = discountAndOffer;\n          this.discountAndOfferForm.patchValue({\n            offerName: discountAndOffer.offerName,\n            code: discountAndOffer.code,\n            discountType: discountAndOffer.discountType,\n            discountAmount: discountAndOffer.discountAmount,\n            startDate: discountAndOffer.startDate,\n            expiryDate: discountAndOffer.expiryDate,\n            description: discountAndOffer.description,\n            termsAndConditions: discountAndOffer.termsAndConditions,\n          });\n\n          this.loading = false;\n        },\n        (err: any) => {\n          this.router.navigate(['../page-not-found'], { relativeTo: this.route });\n          return;\n        },\n      );\n    } else {\n      this.loading = false;\n    }\n  }\n\n  discountPercentageValidator(group: FormGroup): { [s: string]: boolean } {\n    const discountType = group.value.discountType;\n    const amount = +group.value.discountAmount;\n    if (discountType === 'percentage' && amount > 100) {\n      return { invalidDiscountPercentage: true };\n    }\n    return null;\n  }\n\n  checkOfferCode(code: any) {\n    if (this.discountAndOffer && this.discountAndOffer.code === code) {\n      this.validOfferCode = true;\n      return;\n    }\n    this.discountAndOfferService.CheckDiscountAndOffer(this.branchId, code).subscribe(\n      (res: any) => {\n        this.validOfferCode = res.status;\n      },\n      (err: any) => {},\n    );\n  }\n\n  submitDiscountAndOffer() {\n    this.discountAndOfferForm.markAllAsTouched();\n    if (this.discountAndOfferForm.invalid) {\n      this.showToastr('top-right', 'danger', 'Discount & Offer Details are required');\n      return;\n    } else if (!this.validOfferCode) {\n      this.showToastr('top-right', 'danger', 'This Offer Code Already Exist');\n      return;\n    }\n    this.stepper.next();\n  }\n\n  saveDiscountAndOffer() {\n    this.discountAndOfferForm.markAllAsTouched();\n\n    if (this.discountAndOfferForm.invalid) {\n      this.showToastr('top-right', 'danger', 'Discount & Offer Details are required');\n      return;\n    } else if (!this.validOfferCode) {\n      this.showToastr('top-right', 'danger', 'This Offer Code Already Exist');\n      return;\n    }\n    this.submit = true;\n\n    const discountAndOffer: any = this.discountAndOfferForm.value;\n    discountAndOffer.branch = this.branchId;\n\n    if (!this.discountAndOffer) {\n      this.discountAndOfferService.addDiscountAndOffer(discountAndOffer).subscribe(\n        (res: any) => {\n          this.showToastr('top-right', 'success', 'New Discount And Offer Added Successfully!');\n          this.back();\n        },\n        (error: any) => {\n          this.showToastr('top-right', 'danger', error);\n          this.submit = false;\n        },\n      );\n    } else {\n      discountAndOffer._id = this.discountAndOffer._id;\n\n      this.discountAndOfferService.editDiscountAndOffer(discountAndOffer).subscribe(\n        (res: any) => {\n          this.showToastr('top-right', 'success', 'Discount And Offer Updated Successfully!');\n          this.back();\n        },\n        (error: any) => {\n          this.showToastr('top-right', 'danger', error);\n          this.submit = false;\n        },\n      );\n    }\n  }\n\n  private showToastr(position: any, status: any, message: string) {\n    this.toastrService.show(status, message, {\n      position,\n      status,\n    });\n  }\n\n  back() {\n    this.router.navigate(['../'], { relativeTo: this.route, replaceUrl: true });\n  }\n\n  ngOnDestroy() {\n    this.discountAndOfferService.deleteDiscountAndOfferId();\n  }\n}\n","import { AddDiscountAndOfferComponent } from './add-discount-and-offer.component';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { AddDiscountAndOfferRoutingModule } from './add-discount-and-offer-routing.module';\n\nimport { ReactiveFormsModule } from '@angular/forms';\nimport {\n  NbCardModule,\n  NbButtonModule,\n  NbSelectModule,\n  NbIconModule,\n  NbInputModule,\n  NbFormFieldModule,\n  NbCheckboxModule,\n  NbSpinnerModule,\n  NbStepperModule,\n} from '@nebular/theme';\n@NgModule({\n  declarations: [AddDiscountAndOfferComponent],\n  imports: [\n    CommonModule,\n    AddDiscountAndOfferRoutingModule,\n\n    NbCardModule,\n    NbButtonModule,\n    NbSelectModule,\n    NbIconModule,\n    NbInputModule,\n    NbFormFieldModule,\n    NbCheckboxModule,\n    NbSpinnerModule,\n    NbStepperModule,\n    NbFormFieldModule,\n\n    ReactiveFormsModule,\n  ],\n})\nexport class AddDiscountAndOfferModule {}\n"]}