(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{"4lO2":function(e,t,i){"use strict";i.r(t);var c=i("aceb"),s=i("ofXK"),a=i("tyNb"),r=i("IAlr"),n=i("OeS+"),h=i("ZatZ"),o=i("EQut"),u=i("lst6"),d=i("fXoL");function b(e,t){if(1&e){const e=d.Xb();d.Wb(0,"tr"),d.Wb(1,"td"),d.Cc(2),d.Vb(),d.Wb(3,"td"),d.Cc(4),d.Vb(),d.Wb(5,"td"),d.Cc(6),d.Vb(),d.Wb(7,"td"),d.Cc(8),d.Vb(),d.Wb(9,"td"),d.Wb(10,"button",22),d.ec("click",(function(){d.uc(e);const i=t.$implicit;return d.gc(3).editSchedule(i)})),d.Cc(11," Edit "),d.Vb(),d.Vb(),d.Wb(12,"td"),d.Wb(13,"button",23),d.ec("click",(function(){d.uc(e);const i=t.$implicit;return d.gc(3).deleteSchedule(i._id)})),d.Cc(14," Delete "),d.Vb(),d.Vb(),d.Vb()}if(2&e){const e=t.$implicit,i=d.gc(3);d.Eb(2),d.Dc(i.getTime(e.startTime,e.endTime)),d.Eb(2),d.Dc(i.getSubject(e.subject)),d.Eb(2),d.Dc(e.topic),d.Eb(2),d.Dc(i.getTeacher(e.teacher))}}function l(e,t){if(1&e&&(d.Wb(0,"div",20),d.Wb(1,"table",21),d.Ac(2,b,15,4,"tr",13),d.Vb(),d.Vb()),2&e){const e=d.gc().$implicit,t=d.gc();d.Eb(2),d.mc("ngForOf",t.getFilteredSchedule(e))}}function D(e,t){1&e&&(d.Wb(0,"p",10),d.Cc(1,"No Schedule"),d.Vb())}function g(e,t){if(1&e){const e=d.Xb();d.Wb(0,"nb-accordion-item"),d.Wb(1,"nb-accordion-item-header"),d.Wb(2,"div",14),d.Wb(3,"div",15),d.Wb(4,"button",16),d.ec("click",(function(){d.uc(e);const i=t.$implicit;return d.gc().addScheduleOfDay(i)})),d.Rb(5,"nb-icon",17),d.Vb(),d.Wb(6,"span"),d.Cc(7),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(8,"nb-accordion-item-body"),d.Ac(9,l,3,1,"div",18),d.Ac(10,D,2,0,"ng-template",null,19,d.Bc),d.Vb(),d.Vb()}if(2&e){const e=t.$implicit,i=d.sc(11),c=d.gc();d.Eb(7),d.Dc(e),d.Eb(2),d.mc("ngIf",c.getFilteredSchedule(e).length>0)("ngIfElse",i)}}const S=[{path:"",component:(()=>{class e{constructor(e,t,i,c,s,a,r,n){this.branchService=e,this.scheduleService=t,this.courseService=i,this.batchService=c,this.dateService=s,this.router=a,this.route=r,this.toastrService=n}ngOnInit(){this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?(this.branchService.getCategoryData().subscribe(e=>{this.category=e}),this.courseService.getCourseData().subscribe(e=>{this.course=e}),this.batchService.getBatchData().subscribe(e=>{this.batch=e}),this.days=[],this.schedules=[],this.setCurDate(this.dateService.getDate()),this.changeScheduleCalenderType(0),this.getSchedule()):this.router.navigate(["../"],{relativeTo:this.route})}setCurDate(e){this.curDate=e,this.curMonth=this.curDate.getMonth(),this.curYear=this.curDate.getFullYear()}setStartDate(){const e=new Date(this.curDate);0===this.scheduleCalenderType?this.startDate=new Date(e):1===this.scheduleCalenderType?(e.setDate(e.getDate()-e.getDay()),this.startDate=new Date(e)):(e.setDate(1),this.startDate=new Date(e)),this.calcNoOfDays(),this.getSchedule()}calcNoOfDays(){let e;e=0===this.scheduleCalenderType?1:1===this.scheduleCalenderType?7:this.daysInMonth(this.curMonth,this.curYear),this.noOfDays=e,this.days=[];for(let t=0;t<e;t++){const e=this.dateService.millisecondsToDate(this.dateService.dateToMilliseconds(this.startDate)+864e5*t);this.days.push(e.toString().substring(0,15))}}headerDate(){let e;if(0===this.scheduleCalenderType)e=this.curDate.toString().substring(4,15);else if(1===this.scheduleCalenderType){const t=this.curDate;t.setDate(t.getDate()-t.getDay());let i=new Date(t),c=i.toString().substring(4,10);i.getDate()>25&&11===i.getMonth()&&(c=c+", "+i.getFullYear()),t.setDate(t.getDate()+6),i=new Date(t);let s=i.toString().substring(4,10);c.split(",")[1]&&(s=s+", "+i.getFullYear()),e=c+" - "+s}else e=this.dateService.getMonth(this.curMonth)+" "+this.curYear;return e}goToToday(){this.setCurDate(this.dateService.getDate()),this.setStartDate()}nextMonth(){this.curYear=11===this.curMonth?this.curYear+1:this.curYear,this.curMonth=(this.curMonth+1)%12,this.curDate=new Date(this.curYear,this.curMonth,1)}previousMonth(){this.curYear=0===this.curMonth?this.curYear-1:this.curYear,this.curMonth=0===this.curMonth?11:this.curMonth-1,this.curDate=new Date(this.curYear,this.curMonth,1)}nextWeek(){const e=new Date(this.curDate).getDate()+7,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}previousWeek(){const e=new Date(this.curDate).getDate()-7,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}nextDay(){const e=new Date(this.curDate).getDate()+1,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}previousDay(){const e=new Date(this.curDate).getDate()-1,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}next(){0===this.scheduleCalenderType?this.nextDay():1===this.scheduleCalenderType?this.nextWeek():this.nextMonth(),this.setStartDate()}previous(){0===this.scheduleCalenderType?this.previousDay():1===this.scheduleCalenderType?this.previousWeek():this.previousMonth(),this.setStartDate()}changeScheduleCalenderType(e){this.scheduleCalenderType=e,this.setStartDate()}daysInMonth(e,t){return 32-new Date(t,e,32).getDate()}getTime(e,t){return(e=this.dateService.formatTime(e))+" - "+this.dateService.formatTime(t)}getTeacher(e){return e}getSubject(e){const t=this.course.subjects.find(t=>t._id===e);return t?t.subject:"--"}addSchedule(){this.router.navigate(["../add"],{relativeTo:this.route})}addScheduleOfDay(e){this.scheduleService.setScheduleDay(e),this.router.navigate(["../add"],{relativeTo:this.route,queryParams:{mode:"date"}})}editSchedule(e){this.scheduleService.setScheduleId(e._id),this.scheduleService.setScheduleData(e),this.router.navigate(["../edit"],{relativeTo:this.route,queryParams:{mode:"edit"}})}deleteSchedule(e){this.scheduleService.deleteSchedule(e).subscribe(t=>{const i=this.schedules.findIndex(t=>t._id===e);i>=0&&(this.schedules.splice(i,1),this.showToastr("top-right","success","Schedule Deleted Successfully"))},e=>{this.showToastr("top-right","danger",e)})}getSchedule(){const e=this.dateService.convertToDateString(this.startDate),t=this.dateService.convertToDateString(this.dateService.addDaysInDate(this.startDate,this.noOfDays));this.loading=!0,this.scheduleService.getAllSchedules(this.branchId,this.category._id,this.course._id,this.batch._id,this.dateService.reverseDate(e),this.dateService.reverseDate(t)).subscribe(e=>{this.schedules=e,this.loading=!1},e=>{this.showToastr("top-right","danger",e),this.loading=!1})}getFilteredSchedule(e){return e=this.dateService.convertToDateString(e),this.schedules.filter(t=>t.date===e)}showToastr(e,t,i){this.toastrService.show(t,i,{position:e,status:t})}}return e.\u0275fac=function(t){return new(t||e)(d.Qb(o.a),d.Qb(n.a),d.Qb(r.a),d.Qb(u.a),d.Qb(h.a),d.Qb(a.c),d.Qb(a.a),d.Qb(c.xb))},e.\u0275cmp=d.Kb({type:e,selectors:[["ngx-manage-batch-schedule"]],decls:36,vars:3,consts:[[1,"row"],[1,"col-md-9","col-sm-8"],[1,"col-md-3","col-sm-4"],["nbButton","","fullWidth","","status","primary","size","small",3,"click"],[1,"col-md-3","pt-2"],[1,"btn-group"],["nbButton","","status","primary","size","small",3,"click"],["icon","arrow-ios-back-outline"],["icon","arrow-ios-forward-outline"],[1,"col-md-5","pt-2"],[1,"text-center"],[1,"col-md-4","pt-2"],["status","basic","multi",""],[4,"ngFor","ngForOf"],[1,"row","accordion-header-item"],[1,"col-12"],["nbButton","","status","primary","size","tiny",1,"float-right",3,"click"],["nbTooltip","Add Schedule","icon","plus-outline"],["class","table-responsive",4,"ngIf","ngIfElse"],["noSchedule",""],[1,"table-responsive"],[1,"table"],["status","basic","nbButton","","size","small",3,"click"],["status","danger","nbButton","","size","small",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"nb-card"),d.Wb(1,"nb-card-header"),d.Wb(2,"div",0),d.Wb(3,"div",1),d.Wb(4,"h3"),d.Cc(5," Schedule of "),d.Wb(6,"small"),d.Cc(7),d.Vb(),d.Vb(),d.Vb(),d.Wb(8,"div",2),d.Wb(9,"button",3),d.ec("click",(function(){return t.addSchedule()})),d.Cc(10," Add Schedule "),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(11,"nb-card-body"),d.Wb(12,"nb-card"),d.Wb(13,"nb-card-header"),d.Wb(14,"div",0),d.Wb(15,"div",4),d.Wb(16,"div",5),d.Wb(17,"button",6),d.ec("click",(function(){return t.previous()})),d.Rb(18,"nb-icon",7),d.Vb(),d.Wb(19,"button",6),d.ec("click",(function(){return t.goToToday()})),d.Cc(20," Today "),d.Vb(),d.Wb(21,"button",6),d.ec("click",(function(){return t.next()})),d.Rb(22,"nb-icon",8),d.Vb(),d.Vb(),d.Vb(),d.Wb(23,"div",9),d.Wb(24,"h5",10),d.Cc(25),d.Vb(),d.Vb(),d.Wb(26,"div",11),d.Wb(27,"div",5),d.Wb(28,"button",6),d.ec("click",(function(){return t.changeScheduleCalenderType(0)})),d.Cc(29," Day "),d.Vb(),d.Wb(30,"button",6),d.ec("click",(function(){return t.changeScheduleCalenderType(1)})),d.Cc(31," Week "),d.Vb(),d.Wb(32,"button",6),d.ec("click",(function(){return t.changeScheduleCalenderType(2)})),d.Cc(33," Month "),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(34,"nb-accordion",12),d.Ac(35,g,12,3,"nb-accordion-item",13),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Eb(7),d.Dc(t.batch.basicDetails.batchName),d.Eb(18),d.Dc(t.headerDate()),d.Eb(10),d.mc("ngForOf",t.days))},directives:[c.x,c.z,c.u,c.w,c.L,c.g,s.m,c.i,c.j,c.zb,c.h,s.n],styles:[".accordion-header-item[_ngcontent-%COMP%]{width:98%}"]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=d.Ob({type:e}),e.\u0275inj=d.Nb({factory:function(t){return new(t||e)},imports:[[a.g.forChild(S)],a.g]}),e})();i.d(t,"ManageBatchScheduleModule",(function(){return p}));let p=(()=>{class e{}return e.\u0275mod=d.Ob({type:e}),e.\u0275inj=d.Nb({factory:function(t){return new(t||e)},imports:[[s.c,v,c.A,c.Ab,c.N,c.v,c.P,c.k,c.K]]}),e})()}}]);