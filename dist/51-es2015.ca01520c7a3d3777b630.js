(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{jX92:function(t,e,n){"use strict";n.r(e);var i=n("aceb"),a=n("ofXK"),s=n("mrSG"),o=n("EQut"),r=n("gmaa"),l=n("RSY0"),u=n("fXoL"),c=n("tyNb");function m(t,e){if(1&t){const t=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",4),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](t);const e=u["\u0275\u0275nextContext"]();return e.examStarted?e.submitExam():e.startExam()})),u["\u0275\u0275text"](1),u["\u0275\u0275elementEnd"]()}if(2&t){const t=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"](" ",t.examStarted?"Submit":"Start"," Exam ")}}function d(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"p"),u["\u0275\u0275elementStart"](1,"span"),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate2"]("",t.getDate(t.onlineExam.date),".\xa0",t.getTime(t.onlineExam.time),"")}}function x(t,e){1&t&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"p",5),u["\u0275\u0275text"](2,"Click on Start Exam"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]())}function h(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"p",13),u["\u0275\u0275text"](1," Exam will End In "),u["\u0275\u0275element"](2,"br"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",t.examCountDownTimer," ")}}function p(t,e){1&t&&(u["\u0275\u0275elementStart"](0,"p",13),u["\u0275\u0275text"](1," Exam Ended "),u["\u0275\u0275elementEnd"]())}function f(t,e){if(1&t){const t=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",14),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](t),u["\u0275\u0275nextContext"](3).previousQuestion()})),u["\u0275\u0275element"](1,"nb-icon",15),u["\u0275\u0275elementEnd"]()}}function g(t,e){if(1&t){const t=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",16),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](t),u["\u0275\u0275nextContext"](3).nextQuestion()})),u["\u0275\u0275element"](1,"nb-icon",17),u["\u0275\u0275elementEnd"]()}}function S(t,e){if(1&t){const t=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"nb-checkbox",20),u["\u0275\u0275listener"]("checkedChange",(function(n){u["\u0275\u0275restoreView"](t);const i=e.$implicit,a=e.index,s=u["\u0275\u0275nextContext"](4);return s.markAnswer(s.currentQuestion._id,s.currentQuestionIndex,i._id,a,n)})),u["\u0275\u0275elementStart"](2,"strong"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](4," \xa0\xa0 "),u["\u0275\u0275elementStart"](5,"span"),u["\u0275\u0275text"](6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&t){const t=e.$implicit,n=e.index;u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",n+1,"."),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](t.answer)}}function E(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"div",6),u["\u0275\u0275elementStart"](1,"div",7),u["\u0275\u0275elementStart"](2,"p",18),u["\u0275\u0275elementStart"](3,"strong"),u["\u0275\u0275text"](4),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"p"),u["\u0275\u0275elementStart"](6,"Strong"),u["\u0275\u0275text"](7),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](8,S,7,2,"div",19),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("Question ",t.currentQuestionIndex+1,""),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](t.currentQuestion.question),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngForOf",t.currentQuestion.answers)}}function w(t,e){1&t&&(u["\u0275\u0275elementStart"](0,"p",18),u["\u0275\u0275text"](1,"Calculating Result"),u["\u0275\u0275elementEnd"]())}function v(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"p",18),u["\u0275\u0275text"](1),u["\u0275\u0275element"](2,"br"),u["\u0275\u0275text"](3),u["\u0275\u0275element"](4,"br"),u["\u0275\u0275elementStart"](5,"strong"),u["\u0275\u0275text"](6,"You got: "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7),u["\u0275\u0275element"](8,"br"),u["\u0275\u0275elementStart"](9,"strong"),u["\u0275\u0275text"](10),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"](4);u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate2"](" Attempted: ",t.onlineExamResult.answeredQuestions,", Unattempted: ",t.onlineExamResult.unAnsweredQuestions," "),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate2"](" Correct Answers ",t.onlineExamResult.correctAnswers,", Wrong Answers ",t.onlineExamResult.wrongAnswers,","),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate2"](" ",t.onlineExamResult.marks,"/",t.onlineExam.totalMarks," "),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](t.onlineExamResult.status?"Pass":"failed")}}function I(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"div",6),u["\u0275\u0275elementStart"](1,"div",21),u["\u0275\u0275template"](2,w,2,0,"p",22),u["\u0275\u0275template"](3,v,11,7,"p",22),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",t.calculatingResult),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!t.calculatingResult)}}function b(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"div",6),u["\u0275\u0275elementStart"](2,"div",7),u["\u0275\u0275template"](3,h,4,1,"p",8),u["\u0275\u0275template"](4,p,2,0,"p",8),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"div",9),u["\u0275\u0275template"](6,f,2,0,"button",10),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"div",9),u["\u0275\u0275template"](8,g,2,0,"button",11),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](9,"hr"),u["\u0275\u0275template"](10,E,9,3,"div",12),u["\u0275\u0275template"](11,I,4,2,"div",12),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",t.examCountDownTimer),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!t.examCountDownTimer&&t.examSubmitted),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",t.currentQuestionIndex>0&&!t.examSubmitted),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",t.currentQuestionIndex<t.questions.length-1&&!t.examSubmitted),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!t.examSubmitted),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.examSubmitted)}}function T(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275template"](1,x,3,0,"div",1),u["\u0275\u0275template"](2,b,12,6,"div",1),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!t.examStarted),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.examStarted)}}function Q(t,e){1&t&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1," Loading... "),u["\u0275\u0275elementEnd"]())}function C(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1," Exam will Start In "),u["\u0275\u0275element"](2,"br"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",t.waitingToStart," ")}}function y(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"p",23),u["\u0275\u0275template"](1,Q,2,0,"span",1),u["\u0275\u0275template"](2,C,4,1,"span",1),u["\u0275\u0275elementEnd"]()),2&t){const t=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf","loading"===t.waitingToStart),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf","loading"!==t.waitingToStart)}}const D=[{path:"",component:(()=>{class t{constructor(t,e,n,i,a,s){this.branchService=t,this.toastrService=e,this.onlineExamService=n,this.onlineExamQuestionService=i,this.router=a,this.route=s}ngOnInit(){this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?(this.waitingToStart="loading",this.onlineExamService.getOnlineExamData().subscribe(t=>{t?this.onlineExam=t:this.back()}),this.questions=[],this.onlineExamService.getOnlineExamResult(this.onlineExam._id).subscribe(t=>{if(t)this.onlineExamResult=t,this.waitingToStart=null,this.examStarted=!0,this.examSubmitted=!0,this.calculatingResult=!1;else{const t=new Date(this.onlineExam.date+"T"+this.onlineExam.time).getTime();this.examStartTime=t,this.examStarted=!1,this.examSubmitted=!1,this.examTimeUp=!1;const e=setInterval(()=>{const n=(new Date).getTime(),i=t-n,a=Math.floor(i%864e5/36e5),s=Math.floor(i%36e5/6e4),o=Math.floor(i%6e4/1e3);this.waitingToStart=a+"H "+s+"M "+o+"S ",i<0&&(clearInterval(e),this.waitingToStart=null),this.loading&&(this.loading=!1)},1e3)}this.loading=!1},t=>{this.showToastr("top-right","danger",t),this.loading=!1})):this.router.navigate(["../"],{relativeTo:this.route})}getDate(t){return(t=new Date(t).toString()).substring(0,3)+", "+t.substring(4,15)}getTime(t){const e=+t.split(":")[0],n=t.split(":")[1];return+e>12?(+e-12).toString().padStart(2,"0")+":"+n+" PM":e.toString().padStart(2,"0")+":"+n+" AM"}startExam(){this.onlineExamQuestionService.getOnlineExamQuestionsForStudent(this.onlineExam._id).subscribe(t=>{this.questions=t,this.waitingToStart=null,this.examStarted=!0,this.studentQuestionAnswers=[],this.currentQuestionIndex=0,this.currentQuestion=this.questions[0];const e=60*+this.onlineExam.duration*1e3,n=(new Date).getTime(),i=this.examStartTime+e+0;i-n>=e?this.examEndTime=n+e:i>n?(this.examEndTime=this.examStartTime+e+0,this.examCountDown()):(this.examEndTime=null,this.examTimeUp=!0,this.submitExam())},t=>{this.showToastr("top-right","danger",t)})}examCountDown(){this.examInterval=setInterval(()=>Object(s.a)(this,void 0,void 0,(function*(){const t=(new Date).getTime(),e=this.examEndTime-t,n=Math.floor(e%864e5/36e5),i=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3);this.examCountDownTimer=n+"H "+i+"M "+a+"S ",e<0&&(this.examCountDownTimer=null,this.examTimeUp=!0,this.submitExam())})),1e3)}previousQuestion(){this.currentQuestionIndex-=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}nextQuestion(){this.currentQuestionIndex+=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}markAnswer(t,e,n,i,a){const s=this.studentQuestionAnswers.findIndex(e=>e.questionId===t);if(a)if(s<0){const i={questionId:t,questionIndex:e,answerIds:[]};i.answerIds.push(n),this.studentQuestionAnswers.push(i)}else{const t=this.studentQuestionAnswers[s];t.answerIds.push(n),this.studentQuestionAnswers[s]=t}else if(s>-1){const t=this.studentQuestionAnswers[s],e=t.answerIds.findIndex(t=>t.answerId===n);t.answerIds.splice(e,1),this.studentQuestionAnswers[s]=t}}submitExam(){let t=!0;this.examTimeUp||(t=window.confirm("Do you want to Submit the Exam?")),t&&(this.calculatingResult=!0,this.examSubmitted=!0,this.currentQuestion=null,this.currentQuestionIndex=null,clearInterval(this.examInterval),this.examCountDownTimer=null,this.onlineExamService.saveOnlineExamResult(this.studentQuestionAnswers,this.onlineExam._id).subscribe(t=>{this.onlineExamResult=t.onlineExamResult,0===t.type&&this.showToastr("top-right","success","Exam Submitted Successfully!"),this.calculatingResult=!1},t=>{this.showToastr("top-right","danger",t)}))}showToastr(t,e,n){this.toastrService.show(e,n,{position:t,status:e})}back(){this.router.navigate(["../"],{relativeTo:this.route})}ngOnDestroy(){clearInterval(this.examInterval)}}return t.\u0275fac=function(e){return new(e||t)(u["\u0275\u0275directiveInject"](o.a),u["\u0275\u0275directiveInject"](i.Db),u["\u0275\u0275directiveInject"](l.a),u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](c.c),u["\u0275\u0275directiveInject"](c.a))},t.\u0275cmp=u["\u0275\u0275defineComponent"]({type:t,selectors:[["ngx-online-test-question"]],decls:10,vars:5,consts:[["type","button","class","float-right","nbButton","","size","small","status","success",3,"click",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["examStartCountDown",""],["type","button","nbButton","","size","small","status","success",1,"float-right",3,"click"],["id","countDown",1,"pt-5","pb-5","text-center"],[1,"row"],[1,"col-12"],["class","text-right","id","examCountDownTimer",4,"ngIf"],[1,"col-6"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click",4,"ngIf"],["class","float-right","type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",3,"click",4,"ngIf"],["class","row",4,"ngIf"],["id","examCountDownTimer",1,"text-right"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click"],["icon","arrow-ios-back-outline"],["type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",1,"float-right",3,"click"],["icon","arrow-ios-forward-outline"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"checkedChange"],[1,"col-12","pt-3","pb-3"],["class","text-center",4,"ngIf"],["id","waitingToStart",1,"pt-5","pb-5","text-center"]],template:function(t,e){if(1&t&&(u["\u0275\u0275elementStart"](0,"nb-card"),u["\u0275\u0275elementStart"](1,"nb-card-header"),u["\u0275\u0275template"](2,m,2,1,"button",0),u["\u0275\u0275elementStart"](3,"h3"),u["\u0275\u0275text"](4),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](5,d,3,2,"p",1),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](6,"nb-card-body"),u["\u0275\u0275template"](7,T,3,2,"div",2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](8,y,3,2,"ng-template",null,3,u["\u0275\u0275templateRefExtractor"])),2&t){const t=u["\u0275\u0275reference"](9);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e.examSubmitted&&!e.waitingToStart),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"](" ",e.onlineExam?e.onlineExam.title:"Online Exam"," "),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.onlineExam),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e.waitingToStart)("ngIfElse",t)}},directives:[i.x,i.z,a.n,i.w,i.u,i.Fb,i.M,a.m,i.C],styles:[""]}),t})()},{path:"page-not-found",loadChildren:()=>n.e(0).then(n.bind(null,"DeSt")).then(t=>t.PageNotFoundModule)},{path:"**",redirectTo:"page-not-found",pathMatch:"full"}];let k=(()=>{class t{}return t.\u0275mod=u["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[c.g.forChild(D)],c.g]}),t})();n.d(e,"OnlineTestQuestionModule",(function(){return R}));let R=(()=>{class t{}return t.\u0275mod=u["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[a.c,k,i.A,i.v,i.O,i.Gb,i.D]]}),t})()},mrSG:function(t,e,n){"use strict";function i(t,e,n,i){return new(n||(n=Promise))((function(a,s){function o(t){try{l(i.next(t))}catch(e){s(e)}}function r(t){try{l(i.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,r)}l((i=i.apply(t,e||[])).next())}))}n.d(e,"a",(function(){return i}))}}]);