(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{CZmM:function(e,t,c){"use strict";c.r(t);var i=c("3Pt+"),s=c("aceb"),r=c("ofXK"),n=c("Pj/w"),a=(c("qwzR"),c("OeS+")),o=c("lst6"),b=c("IAlr"),u=c("EQut"),d=c("ZatZ"),l=c("fXoL"),h=c("tyNb");function p(e,t){1&e&&(l.Wb(0,"p",29),l.Cc(1," Schedule Start Time is required! "),l.Vb())}function m(e,t){if(1&e&&(l.Ub(0),l.Ac(1,p,2,0,"p",28),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.repeatScheduleForm.get("startTime").errors?null:e.repeatScheduleForm.get("startTime").errors.required)}}function g(e,t){1&e&&(l.Wb(0,"p",29),l.Cc(1," Schedule End Time is required! "),l.Vb())}function f(e,t){if(1&e&&(l.Ub(0),l.Ac(1,g,2,0,"p",28),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.repeatScheduleForm.get("endTime").errors?null:e.repeatScheduleForm.get("endTime").errors.required)}}function S(e,t){if(1&e&&(l.Wb(0,"nb-option",30),l.Cc(1),l.Vb()),2&e){const e=t.$implicit;l.mc("value",e._id),l.Eb(1),l.Dc(e.subject)}}function v(e,t){1&e&&(l.Wb(0,"p",29),l.Cc(1," Subject is required! "),l.Vb())}function W(e,t){if(1&e&&(l.Ub(0),l.Ac(1,v,2,0,"p",28),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.repeatScheduleForm.get("subject").errors?null:e.repeatScheduleForm.get("subject").errors.required)}}function V(e,t){1&e&&(l.Wb(0,"p",29),l.Cc(1," Topic is required! "),l.Vb())}function T(e,t){if(1&e&&(l.Ub(0),l.Ac(1,V,2,0,"p",28),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.repeatScheduleForm.get("topic").errors?null:e.repeatScheduleForm.get("topic").errors.required)}}function C(e,t){if(1&e&&(l.Wb(0,"nb-option",30),l.Cc(1),l.Vb()),2&e){const e=t.$implicit;l.mc("value",e.employee),l.Eb(1),l.Dc(e.employee)}}function y(e,t){1&e&&(l.Wb(0,"p",29),l.Cc(1," Teacher is required! "),l.Vb())}function F(e,t){if(1&e&&(l.Ub(0),l.Ac(1,y,2,0,"p",28),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.repeatScheduleForm.get("teacher").errors?null:e.repeatScheduleForm.get("teacher").errors.required)}}function E(e,t){1&e&&(l.Wb(0,"p",29),l.Cc(1," Session Type is required! "),l.Vb())}function w(e,t){if(1&e&&(l.Ub(0),l.Ac(1,E,2,0,"p",28),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.repeatScheduleForm.get("sessionType").errors?null:e.repeatScheduleForm.get("sessionType").errors.required)}}let D=(()=>{class e{constructor(e){this.toastrService=e,this.close=new l.o,this.submit=new l.o}ngOnInit(){this.loading=!0,this.repeatScheduleForm=new i.f({date:new i.d(this.repeatSchedule.date,{validators:[i.u.required]}),startTime:new i.d(this.repeatSchedule.startTime,{validators:[i.u.required]}),endTime:new i.d(this.repeatSchedule.endTime,{validators:[i.u.required]}),subject:new i.d(this.repeatSchedule.subject?this.repeatSchedule.subject:"",{validators:[i.u.required]}),teacher:new i.d(this.repeatSchedule.teacher?this.repeatSchedule.teacher:"",{validators:[i.u.required]}),topic:new i.d(this.repeatSchedule.topic?this.repeatSchedule.topic:"classroom",{validators:[i.u.required]}),sessionType:new i.d(this.repeatSchedule.sessionType,{validators:[i.u.required]})})}onClose(){this.close.emit()}saveSchedule(){this.repeatScheduleForm.invalid?this.showToastr("top-right","danger","All Schedule Fields are Required"):(this.repeatSchedule.date=this.repeatScheduleForm.value.date,this.repeatSchedule.startTime=this.repeatScheduleForm.value.startTime,this.repeatSchedule.endTime=this.repeatScheduleForm.value.endTime,this.repeatSchedule.subject=this.repeatScheduleForm.value.subject,this.repeatSchedule.topic=this.repeatScheduleForm.value.topic,this.repeatSchedule.teacher=this.repeatScheduleForm.value.teacher,this.repeatSchedule.sessionType=this.repeatScheduleForm.value.sessionType,this.submit.emit(this.repeatSchedule))}showToastr(e,t,c){this.toastrService.show(t,c,{position:e,status:t})}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(s.xb))},e.\u0275cmp=l.Kb({type:e,selectors:[["ngx-repeat-schedule"]],inputs:{repeatSchedule:"repeatSchedule",subjects:"subjects",teachers:"teachers"},outputs:{close:"close",submit:"submit"},decls:69,vars:15,consts:[[1,"backdrop",3,"click"],[1,"repeat-schedule-box"],[1,"row"],[1,"col-12"],[3,"formGroup","submit"],[1,"col-md-4","col-sm-6"],[1,"form-control-group"],["for","input-date",1,"label"],["type","date","nbInput","","id","input-date","name","date","formControlName","date","placeholder","Date","fullWidth","","disabled",""],["for","input-schedule-title",1,"label"],["type","time","nbInput","","id","input-schedule-title","name","title","formControlName","startTime","placeholder","Schedule Start Time","fullWidth","",3,"status"],[4,"ngIf"],["for","input-schedule-end-time",1,"label"],["type","time","nbInput","","id","input-schedule-end-time","name","endTime","min","0","formControlName","endTime","placeholder","Schedule End Time","fullWidth","",3,"status"],["for","input-subject",1,"label"],["id","input-subject","name","subject","formControlName","subject","placeholder","Subject","fullWidth","",3,"status"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","input-topic",1,"label"],["type","text","nbInput","","id","input-topic","name","topic","formControlName","topic","placeholder","Topic","fullWidth","",3,"status"],["for","input-teacher",1,"label"],["id","input-teacher","name","teacher","formControlName","teacher","placeholder","Teacher","fullWidth","",3,"status"],["for","input-session-type",1,"label"],["id","input-session-type","name","sessionType","formControlName","sessionType","placeholder","sessionType","fullWidth","",3,"status"],["value","classroom"],["value","online"],["type","button","nbButton","","status","danger","size","small",1,"float-right",3,"click"],["type","submit","nbButton","","status","basic","size","small",1,"float-right","mr-2"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"],[3,"value"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.ec("click",(function(){return t.onClose()})),l.Vb(),l.Wb(1,"div",1),l.Wb(2,"nb-card"),l.Wb(3,"nb-card-header"),l.Wb(4,"h3"),l.Cc(5,"Repeat Schedule"),l.Vb(),l.Vb(),l.Wb(6,"nb-card-body"),l.Wb(7,"div",2),l.Wb(8,"div",3),l.Wb(9,"form",4),l.ec("submit",(function(){return t.saveSchedule()})),l.Wb(10,"div",2),l.Wb(11,"div",5),l.Wb(12,"div",6),l.Wb(13,"label",7),l.Cc(14,"Date:"),l.Vb(),l.Rb(15,"input",8),l.Vb(),l.Vb(),l.Wb(16,"div",5),l.Wb(17,"div",6),l.Wb(18,"label",9),l.Cc(19,"Schedule Start Time:"),l.Vb(),l.Rb(20,"input",10),l.Ac(21,m,2,1,"ng-container",11),l.Vb(),l.Vb(),l.Wb(22,"div",5),l.Wb(23,"div",6),l.Wb(24,"label",12),l.Cc(25,"Schedule End Time:"),l.Vb(),l.Rb(26,"input",13),l.Ac(27,f,2,1,"ng-container",11),l.Vb(),l.Vb(),l.Wb(28,"div",5),l.Wb(29,"div",6),l.Wb(30,"label",14),l.Cc(31,"Subject:"),l.Vb(),l.Wb(32,"nb-select",15),l.Wb(33,"nb-option",16),l.Cc(34,"Select Subject"),l.Vb(),l.Ac(35,S,2,2,"nb-option",17),l.Vb(),l.Ac(36,W,2,1,"ng-container",11),l.Vb(),l.Vb(),l.Wb(37,"div",5),l.Wb(38,"div",6),l.Wb(39,"label",18),l.Cc(40,"Topic:"),l.Vb(),l.Rb(41,"input",19),l.Ac(42,T,2,1,"ng-container",11),l.Vb(),l.Vb(),l.Wb(43,"div",5),l.Wb(44,"div",6),l.Wb(45,"label",20),l.Cc(46,"Teacher:"),l.Vb(),l.Wb(47,"nb-select",21),l.Wb(48,"nb-option",16),l.Cc(49,"Select Teacher"),l.Vb(),l.Ac(50,C,2,2,"nb-option",17),l.Vb(),l.Ac(51,F,2,1,"ng-container",11),l.Vb(),l.Vb(),l.Wb(52,"div",5),l.Wb(53,"div",6),l.Wb(54,"label",22),l.Cc(55,"Session Type:"),l.Vb(),l.Wb(56,"nb-select",23),l.Wb(57,"nb-option",24),l.Cc(58," Class Room "),l.Vb(),l.Wb(59,"nb-option",25),l.Cc(60," Online "),l.Vb(),l.Vb(),l.Ac(61,w,2,1,"ng-container",11),l.Vb(),l.Vb(),l.Vb(),l.Rb(62,"hr"),l.Wb(63,"div",2),l.Wb(64,"div",3),l.Wb(65,"button",26),l.ec("click",(function(){return t.onClose()})),l.Cc(66," Cancel "),l.Vb(),l.Wb(67,"button",27),l.Cc(68," Save "),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Eb(9),l.mc("formGroup",t.repeatScheduleForm),l.Eb(11),l.mc("status",t.repeatScheduleForm.get("startTime").touched?t.repeatScheduleForm.get("startTime").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.repeatScheduleForm.get("startTime").invalid&&t.repeatScheduleForm.get("startTime").touched),l.Eb(5),l.mc("status",t.repeatScheduleForm.get("endTime").touched?t.repeatScheduleForm.get("endTime").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.repeatScheduleForm.get("endTime").invalid&&t.repeatScheduleForm.get("endTime").touched),l.Eb(5),l.mc("status",t.repeatScheduleForm.get("subject").touched?t.repeatScheduleForm.get("subject").invalid?"danger":"success":"basic"),l.Eb(3),l.mc("ngForOf",t.subjects),l.Eb(1),l.mc("ngIf",t.repeatScheduleForm.get("subject").invalid&&t.repeatScheduleForm.get("subject").touched),l.Eb(5),l.mc("status",t.repeatScheduleForm.get("topic").touched?t.repeatScheduleForm.get("topic").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.repeatScheduleForm.get("topic").invalid&&t.repeatScheduleForm.get("topic").touched),l.Eb(5),l.mc("status",t.repeatScheduleForm.get("teacher").touched?t.repeatScheduleForm.get("teacher").invalid?"danger":"success":"basic"),l.Eb(3),l.mc("ngForOf",t.teachers),l.Eb(1),l.mc("ngIf",t.repeatScheduleForm.get("teacher").invalid&&t.repeatScheduleForm.get("teacher").touched),l.Eb(5),l.mc("status",t.repeatScheduleForm.get("sessionType").touched?t.repeatScheduleForm.get("sessionType").invalid?"danger":"success":"basic"),l.Eb(5),l.mc("ngIf",t.repeatScheduleForm.get("sessionType").invalid&&t.repeatScheduleForm.get("sessionType").touched))},directives:[s.x,s.z,s.w,i.v,i.n,i.g,s.O,i.a,i.m,i.e,r.n,s.jb,s.eb,r.m,s.u],styles:[".backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.75);z-index:50}.repeat-schedule-box[_ngcontent-%COMP%]{position:fixed;top:20vh;left:20vw;width:60vw;height:auto;padding:0;z-index:100;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.25)}.repeat-schedule-box-actions[_ngcontent-%COMP%]{text-align:right}@media only screen and (max-width:1200px){.repeat-schedule-box[_ngcontent-%COMP%]{top:15vh;left:25vw;width:50vw}}@media only screen and (max-width:840px){.repeat-schedule-box[_ngcontent-%COMP%]{top:10vh;left:15vw;width:70vw}}@media only screen and (max-width:420px){.repeat-schedule-box[_ngcontent-%COMP%]{top:7vh;left:5vw;width:90vw}}@media only screen and (max-width:300px){.repeat-schedule-box[_ngcontent-%COMP%]{top:2vh;left:2vw;width:96vw}}"]}),e})();const I=["stepper"];function j(e,t){if(1&e){const e=l.Xb();l.Wb(0,"ngx-repeat-schedule",42),l.ec("close",(function(){return l.uc(e),l.gc().cancelRepeatSchedule()}))("submit",(function(t){return l.uc(e),l.gc().saveRepeatSchedule(t)})),l.Vb()}if(2&e){const e=l.gc();l.mc("subjects",e.subjects)("teachers",e.teachers)("repeatSchedule",e.repeatSchedule)}}function R(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Date is required! "),l.Vb())}function x(e,t){if(1&e&&(l.Ub(0),l.Ac(1,R,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("date").errors?null:e.scheduleForm.get("date").errors.required)}}function A(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Schedule Start Time is required! "),l.Vb())}function k(e,t){if(1&e&&(l.Ub(0),l.Ac(1,A,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("startTime").errors?null:e.scheduleForm.get("startTime").errors.required)}}function q(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Schedule End Time is required! "),l.Vb())}function U(e,t){if(1&e&&(l.Ub(0),l.Ac(1,q,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("endTime").errors?null:e.scheduleForm.get("endTime").errors.required)}}function O(e,t){if(1&e&&(l.Wb(0,"nb-option",45),l.Cc(1),l.Vb()),2&e){const e=t.$implicit;l.mc("value",e._id),l.Eb(1),l.Dc(e.subject)}}function M(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Subject is required! "),l.Vb())}function N(e,t){if(1&e&&(l.Ub(0),l.Ac(1,M,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("subject").errors?null:e.scheduleForm.get("subject").errors.required)}}function _(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Topic is required! "),l.Vb())}function P(e,t){if(1&e&&(l.Ub(0),l.Ac(1,_,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("topic").errors?null:e.scheduleForm.get("topic").errors.required)}}function z(e,t){if(1&e&&(l.Wb(0,"nb-option",45),l.Cc(1),l.Vb()),2&e){const e=t.$implicit;l.mc("value",e.employee),l.Eb(1),l.Dc(e.name)}}function B(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Teacher is required! "),l.Vb())}function Q(e,t){if(1&e&&(l.Ub(0),l.Ac(1,B,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("teacher").errors?null:e.scheduleForm.get("teacher").errors.required)}}function X(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," Session Type is required! "),l.Vb())}function $(e,t){if(1&e&&(l.Ub(0),l.Ac(1,X,2,0,"p",43),l.Tb()),2&e){const e=l.gc();l.Eb(1),l.mc("ngIf",null==e.scheduleForm.get("sessionType").errors?null:e.scheduleForm.get("sessionType").errors.required)}}function G(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",1),l.Wb(1,"div",5),l.Wb(2,"div",11),l.Wb(3,"nb-checkbox",51),l.ec("ngModelChange",(function(t){return l.uc(e),l.gc(2).repeat=t})),l.Cc(4," Repeat This Schedule for Another Days "),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=l.gc(2);l.Eb(3),l.mc("ngModel",e.repeat)}}function K(e,t){if(1&e){const e=l.Xb();l.Wb(0,"label"),l.Wb(1,"input",58),l.ec("change",(function(c){l.uc(e);const i=t.index;return l.gc(3).onSelectRepeatDay(c.target.checked,i)})),l.Vb(),l.Wb(2,"label",59),l.Cc(3),l.Vb(),l.Vb()}if(2&e){const e=t.index,c=l.gc(3);l.Eb(1),l.mc("id",c.weekDays[e]),l.Eb(1),l.mc("for",c.weekDays[e]),l.Eb(1),l.Dc(c.weekDays[e])}}function Z(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," *Please Select Repeat Day! "),l.Vb())}function J(e,t){if(1&e&&(l.Ub(0),l.Ac(1,Z,2,0,"p",43),l.Tb()),2&e){const e=l.gc(3);l.Eb(1),l.mc("ngIf",0===e.repeatDays.length)}}function L(e,t){1&e&&(l.Wb(0,"p",44),l.Cc(1," *Repeat Up To Date is required! "),l.Vb())}function H(e,t){if(1&e&&(l.Ub(0),l.Ac(1,L,2,0,"p",43),l.Tb()),2&e){const e=l.gc(3);l.Eb(1),l.mc("ngIf",!e.repeatUpTo)}}function Y(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",1),l.Wb(1,"div",52),l.Wb(2,"div",11),l.Wb(3,"label",53),l.Cc(4,"Select Repeat Days: "),l.Vb(),l.Wb(5,"div",54),l.Ac(6,K,4,3,"label",55),l.Vb(),l.Ac(7,J,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(8,"div",52),l.Wb(9,"div",11),l.Wb(10,"label",56),l.Cc(11,"Repeat up To:"),l.Vb(),l.Wb(12,"input",57),l.ec("ngModelChange",(function(t){return l.uc(e),l.gc(2).repeatUpTo=t}))("change",(function(){return l.uc(e),l.gc(2).onChangeRepeatUpToDate()})),l.Vb(),l.Ac(13,H,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=l.gc(2);l.Eb(6),l.mc("ngForOf",e.weekDays),l.Eb(1),l.mc("ngIf",e.repeat&&e.repeatDaysTouched),l.Eb(5),l.mc("min",e.scheduleForm.value.date)("ngModel",e.repeatUpTo)("status",e.repeat&&e.repeatUpToTouched?e.repeatUpTo?"success":"danger":"basic"),l.Eb(1),l.mc("ngIf",e.repeat&&e.repeatUpToTouched)}}function ee(e,t){if(1&e){const e=l.Xb();l.Wb(0,"button",67),l.ec("click",(function(){l.uc(e);const t=l.gc().index;return l.gc(3).removeRepeatSchedule(t)})),l.Rb(1,"nb-icon",68),l.Vb()}}function te(e,t){if(1&e){const e=l.Xb();l.Wb(0,"tr"),l.Wb(1,"td"),l.Cc(2),l.Vb(),l.Wb(3,"td"),l.Cc(4),l.Vb(),l.Wb(5,"td"),l.Cc(6),l.Vb(),l.Wb(7,"td"),l.Cc(8),l.Vb(),l.Wb(9,"td"),l.Cc(10),l.Vb(),l.Wb(11,"td"),l.Cc(12),l.Vb(),l.Wb(13,"td"),l.Wb(14,"button",62),l.ec("click",(function(){l.uc(e);const c=t.$implicit,i=t.index;return l.gc(3).editRepeatSchedule(c,i)})),l.Rb(15,"nb-icon",63),l.Vb(),l.Vb(),l.Wb(16,"td"),l.Wb(17,"button",64),l.ec("click",(function(){l.uc(e);const c=t.$implicit,i=t.index;return l.gc(3).cloneRepeatSchedule(c,i)})),l.Rb(18,"nb-icon",65),l.Vb(),l.Vb(),l.Wb(19,"td"),l.Ac(20,ee,2,0,"button",66),l.Vb(),l.Vb()}if(2&e){const e=t.$implicit,c=t.index,i=l.gc(3);l.Eb(2),l.Dc(c+1),l.Eb(2),l.Dc(i.dateService.getDay(e.date)),l.Eb(2),l.Dc(i.dateService.formatDate(e.date)),l.Eb(2),l.Fc(" ",i.dateService.formatTime(e.startTime)," - ",i.dateService.formatTime(e.endTime)," "),l.Eb(2),l.Ec(" ",i.getSubject(e.subject)," "),l.Eb(2),l.Ec(" ",i.getTeacher(e.teacher)," "),l.Eb(8),l.mc("ngIf",0!==c)}}function ce(e,t){if(1&e&&(l.Wb(0,"div",35),l.Wb(1,"table",60),l.Wb(2,"thead"),l.Wb(3,"tr"),l.Wb(4,"th"),l.Cc(5,"#"),l.Vb(),l.Wb(6,"th"),l.Cc(7,"Day"),l.Vb(),l.Wb(8,"th"),l.Cc(9,"Date"),l.Vb(),l.Wb(10,"th"),l.Cc(11,"Time"),l.Vb(),l.Wb(12,"th"),l.Cc(13,"Subject"),l.Vb(),l.Wb(14,"th"),l.Cc(15,"Teacher"),l.Vb(),l.Wb(16,"th",61),l.Cc(17,"Action"),l.Vb(),l.Vb(),l.Vb(),l.Wb(18,"tbody"),l.Ac(19,te,21,8,"tr",55),l.Vb(),l.Vb(),l.Vb()),2&e){const e=l.gc(2);l.Eb(19),l.mc("ngForOf",e.repeatSchedules)}}function ie(e,t){if(1&e&&(l.Wb(0,"p",69),l.Cc(1),l.Vb()),2&e){const e=l.gc(2);l.Eb(1),l.Ec(" ",0===e.repeatDays.length?"Select Repeat Day":e.repeatUpTo?"No Repeat Schedule":"Select Repeat Up To Date"," ")}}function se(e,t){if(1&e){const e=l.Xb();l.Wb(0,"nb-step",46),l.Wb(1,"form",47),l.ec("submit",(function(){return l.uc(e),l.gc().submitScheduleRepeatForm()})),l.Ac(2,G,5,1,"div",48),l.Rb(3,"br"),l.Ac(4,Y,14,6,"div",48),l.Wb(5,"div",1),l.Wb(6,"div",5),l.Ac(7,ce,20,1,"div",49),l.Ac(8,ie,2,1,"ng-template",null,50,l.Bc),l.Vb(),l.Vb(),l.Rb(10,"hr"),l.Wb(11,"div",1),l.Wb(12,"div",37),l.Wb(13,"button",38),l.ec("click",(function(){return l.uc(e),l.gc().previousStep()})),l.Rb(14,"nb-icon",39),l.Wb(15,"span"),l.Cc(16,"prev"),l.Vb(),l.Vb(),l.Vb(),l.Wb(17,"div",37),l.Wb(18,"button",31),l.Cc(19," Next "),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=l.sc(9),t=l.gc();l.Eb(2),l.mc("ngIf",!t.schedule),l.Eb(2),l.mc("ngIf",t.repeat&&!t.schedule),l.Eb(3),l.mc("ngIf",t.repeatSchedules.length>0)("ngIfElse",e)}}function re(e,t){if(1&e&&(l.Ub(0),l.Wb(1,"tr"),l.Wb(2,"th"),l.Cc(3,"Repeat Days"),l.Vb(),l.Wb(4,"td"),l.Cc(5),l.Vb(),l.Vb(),l.Wb(6,"tr"),l.Wb(7,"th"),l.Cc(8,"Repeat Up To"),l.Vb(),l.Wb(9,"td"),l.Cc(10),l.Vb(),l.Vb(),l.Tb()),2&e){const e=l.gc();l.Eb(5),l.Dc(e.getRepeatDays()),l.Eb(5),l.Dc(e.dateService.formatDate(e.repeatUpTo))}}const ne=[{path:"",component:(()=>{class e{constructor(e,t,c,i,s,r,n,a,o){this.branchService=e,this.courseService=t,this.branchEmployeeService=c,this.dateService=i,this.batchService=s,this.scheduleService=r,this.toastrService=n,this.router=a,this.route=o}ngOnInit(){if(this.loading=!0,this.branchId=this.branchService.getBranchId(),!this.branchId)return void this.router.navigate(["../"],{relativeTo:this.route});let e,t;if(this.route.queryParams.subscribe(t=>{e=t.mode}),this.scheduleId=this.scheduleService.getScheduleId(),e&&!["edit","date"].includes(e))return this.showToastr("top-right","danger","Invalid Route"),void this.router.navigate(["../"],{relativeTo:this.route});if(!e||"edit"!==e||this.scheduleId){if(this.branchService.getCategoryData().subscribe(e=>{this.category=e}),this.courseService.getCourseData().subscribe(e=>{this.course=e}),this.batchService.getBatchData().subscribe(e=>{this.batch=e}),this.subjects=[],this.teachers=[],this.weekDays=[],this.repeatDays=[],this.repeatSchedules=[],this.repeat=!1,this.repeatScheduleEdit=!1,this.repeatUpTo=this.dateService.convertToDateString(this.dateService.addDaysInDate(this.batch.basicDetails.startDate,30*+this.course.basicDetails.duration)),this.repeatUpToTouched=!1,this.repeatDaysTouched=!1,this.weekdaysTouched=!1,this.weekDays=this.dateService.getWeekDays(),this.branchEmployeeService.getBranchEmployeeNameIdsData().subscribe(e=>{this.teachers=e}),this.batch.subjects.forEach(e=>{const t=this.course.subjects.find(t=>t._id===e.subject);this.subjects.push(t)}),e&&"date"===e){const e=this.scheduleService.getScheduleDay();t=this.dateService.convertToDateString(e)}this.scheduleForm=new i.f({date:new i.d(t||this.dateService.getDateString(),{validators:[i.u.required]}),startTime:new i.d(null,{validators:[i.u.required]}),endTime:new i.d(null,{validators:[i.u.required]}),subject:new i.d("",{validators:[i.u.required]}),teacher:new i.d("",{validators:[i.u.required]}),topic:new i.d(null,{validators:[i.u.required]}),sessionType:new i.d("classroom",{validators:[i.u.required]})}),e&&"edit"===e&&this.scheduleId?this.scheduleService.getSchedule(this.scheduleId).subscribe(e=>{this.schedule=e,this.scheduleForm.patchValue({date:this.schedule.date,startTime:this.schedule.startTime,endTime:this.schedule.endTime,subject:this.schedule.subject,teacher:this.schedule.teacher,topic:this.schedule.topic,sessionType:this.schedule.sessionType}),this.loading=!1},e=>{this.showToastr("top-right","danger",e),this.back()}):this.loading=!1}else this.showToastr("top-right","danger","Schedule Not Found")}onSelectSubject(e){const t=this.batch.subjects.find(t=>t.subject===e);t&&t.teacher&&this.scheduleForm.patchValue({teacher:t.teacher})}getSchedule(){const e=this.scheduleForm.value;return e.branch=this.branchId,e.category=this.category._id,e.course=this.course._id,e.batch=this.batch._id,Object.assign({},e)}CalculateRepeatSchedule(){const e=this.getSchedule();if(this.repeatSchedules=[],this.repeatSchedules.push(e),this.repeat&&this.repeatUpTo&&this.repeatDays.length>0){const t=864e5;let c=this.dateService.dateToMilliseconds(e.date);const i=(this.dateService.dateToMilliseconds(this.repeatUpTo)-c)/t;for(let s=0;s<i;s++){c+=t;const i=new Date(c);if(this.repeatDays.includes(i.getDay())){const t=Object.assign({},e);t.date=this.dateService.convertToDateString(i),this.repeatSchedules.push(t)}}}}removeRepeatSchedule(e){this.repeatSchedules.splice(e,1)}editRepeatSchedule(e,t){this.repeatSchedule=e,this.repeatScheduleIndex=t,this.repeatScheduleEdit=!0}cloneRepeatSchedule(e,t){this.repeatSchedule=e,this.repeatScheduleIndex=t}saveRepeatSchedule(e){this.repeatScheduleEdit?this.repeatSchedules[this.repeatScheduleIndex]=e:this.repeatSchedules.splice(this.repeatScheduleIndex+1,0,e),this.cancelRepeatSchedule()}cancelRepeatSchedule(){this.repeatScheduleIndex=null,this.repeatSchedule=null,this.repeatScheduleEdit=!1}onChangeRepeatUpToDate(){this.repeatUpToTouched=!0,this.CalculateRepeatSchedule()}onSelectRepeatDay(e,t){if(this.repeatDaysTouched=!0,e)this.repeatDays.push(t);else{const e=this.repeatDays.indexOf(t);this.repeatDays.splice(e,1)}this.CalculateRepeatSchedule()}previousStep(){this.stepper.previous()}submitScheduleForm(){this.scheduleForm.markAllAsTouched(),this.scheduleForm.invalid?this.showToastr("top-right","danger","All Schedule Fields are Required"):(this.schedule||this.CalculateRepeatSchedule(),this.stepper.next())}submitScheduleRepeatForm(){this.schedule||(!this.repeat||this.repeatUpTo?this.repeat&&0===this.repeatDays.length?this.showToastr("top-right","danger","At least one Repeat Day is Required"):this.stepper.next():this.showToastr("top-right","danger","Receipt Up To date is Required"))}saveSchedule(){if(this.scheduleForm.markAllAsTouched(),this.scheduleForm.invalid)this.showToastr("top-right","danger","All Schedule Fields are Required");else if(this.loading=!0,this.schedule){const e=this.getSchedule();e._id=this.scheduleId,this.scheduleService.editSchedule(e).subscribe(e=>{this.showToastr("top-right","success","Schedule Updated Successfully!"),this.back()},e=>{this.showToastr("top-right","danger",e),this.loading=!1})}else this.scheduleService.addSchedule(this.repeatSchedules).subscribe(e=>{this.showToastr("top-right","success","New Schedule Added Successfully!"),this.back()},e=>{this.showToastr("top-right","danger",e),this.loading=!1})}getSubject(e){const t=this.subjects.find(t=>t._id===e);return t?t.subject:"--"}getTeacher(e){const t=this.teachers.find(t=>t.employee===e);return t?t.name:"--"}getRepeatDays(){const e=[];return this.weekDays.forEach((t,c)=>{this.repeatDays.includes(c)&&e.push(t)}),e.join(", ")}showToastr(e,t,c){this.toastrService.show(t,c,{position:e,status:t})}back(){this.router.navigate(["../"],{relativeTo:this.route})}ngOnDestroy(){this.scheduleService.deleteScheduleId(),this.scheduleService.deleteScheduleDay(),this.scheduleService.deleteScheduleData()}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(u.a),l.Qb(b.a),l.Qb(n.a),l.Qb(d.a),l.Qb(o.a),l.Qb(a.a),l.Qb(s.xb),l.Qb(h.c),l.Qb(h.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["ngx-add-schedule"]],viewQuery:function(e,t){var c;1&e&&l.Hc(I,!0),2&e&&l.rc(c=l.fc())&&(t.stepper=c.first)},decls:133,vars:33,consts:[[3,"subjects","teachers","repeatSchedule","close","submit",4,"ngIf"],[1,"row"],[1,"col-9"],[1,"col-3"],["nbButton","","size","tiny","status","warning",1,"float-right",3,"click"],[1,"col-12"],[3,"linear","disableStepNavigation"],["stepper",""],["label","Schedule Details",3,"stepControl"],[3,"formGroup","submit"],[1,"col-md-4","col-sm-6"],[1,"form-control-group"],["for","input-date",1,"label"],["type","date","nbInput","","id","input-date","name","date","formControlName","date","placeholder","Date","fullWidth","",3,"min","status"],[4,"ngIf"],["for","input-schedule-title",1,"label"],["type","time","nbInput","","id","input-schedule-title","name","title","formControlName","startTime","placeholder","Schedule Start Time","fullWidth","",3,"status"],["for","input-schedule-end-time",1,"label"],["type","time","nbInput","","id","input-schedule-end-time","name","endTime","min","0","formControlName","endTime","placeholder","Schedule End Time","fullWidth","",3,"status"],["for","input-subject",1,"label"],["id","input-subject","name","subject","formControlName","subject","placeholder","Subject","fullWidth","",3,"status","selectedChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","input-topic",1,"label"],["type","text","nbInput","","id","input-topic","name","topic","formControlName","topic","placeholder","Topic","fullWidth","",3,"status"],["for","input-teacher",1,"label"],["id","input-teacher","name","teacher","formControlName","teacher","placeholder","Teacher","fullWidth","",3,"status"],["for","input-session-type",1,"label"],["id","input-session-type","name","sessionType","formControlName","sessionType","placeholder","sessionType","fullWidth","",3,"status"],["value","classroom"],["value","online"],["type","submit","nbButton","","status","basic","size","medium",1,"float-right"],["label","Schedule Repeat",4,"ngIf"],["label","Submit"],[1,"step-container"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"col-sm-6","text-left"],["type","button","size","medium","nbButton","",1,"",3,"click"],["icon","arrow-ios-back-outline"],[1,"col-sm-6","text-right"],["type","button","nbButton","","size","medium",3,"click"],[3,"subjects","teachers","repeatSchedule","close","submit"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"],[3,"value"],["label","Schedule Repeat"],[3,"submit"],["class","row",4,"ngIf"],["class","table-responsive",4,"ngIf","ngIfElse"],["noRepeatSchedule",""],["id","input-session-repeat","name","repeat","placeholder","repeat",3,"ngModel","ngModelChange"],[1,"col-md-6"],["for","input-repeat-days",1,"label"],[1,"week-day-selector"],[4,"ngFor","ngForOf"],["for","input-repeat-up-to",1,"label"],["type","date","nbInput","","id","input-repeat-up-to","name","repeatUpTo","placeholder","Date","fullWidth","",3,"min","ngModel","status","ngModelChange","change"],["type","checkbox",1,"weekday",3,"id","change"],[3,"for"],[1,"table"],["colspan","3"],["type","button","nbTooltip","Edit","nbButton","","size","tiny","status","basic",3,"click"],["icon","edit-outline"],["type","button","nbTooltip","Clone","nbButton","","size","tiny","status","primary",3,"click"],["icon","copy-outline"],["type","button","nbTooltip","Remove","nbButton","","size","tiny","status","danger",3,"click",4,"ngIf"],["type","button","nbTooltip","Remove","nbButton","","size","tiny","status","danger",3,"click"],["icon","close-outline"],[1,"text-center"]],template:function(e,t){1&e&&(l.Ac(0,j,1,3,"ngx-repeat-schedule",0),l.Wb(1,"nb-card"),l.Wb(2,"nb-card-header"),l.Wb(3,"div",1),l.Wb(4,"div",2),l.Wb(5,"h3"),l.Cc(6),l.Vb(),l.Vb(),l.Wb(7,"div",3),l.Wb(8,"button",4),l.ec("click",(function(){return t.back()})),l.Cc(9," Back "),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Wb(10,"nb-card-body"),l.Wb(11,"div",1),l.Wb(12,"div",5),l.Wb(13,"nb-stepper",6,7),l.Wb(15,"nb-step",8),l.Wb(16,"form",9),l.ec("submit",(function(){return t.submitScheduleForm()})),l.Wb(17,"div",1),l.Wb(18,"div",10),l.Wb(19,"div",11),l.Wb(20,"label",12),l.Cc(21,"Date:"),l.Vb(),l.Rb(22,"input",13),l.Ac(23,x,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(24,"div",10),l.Wb(25,"div",11),l.Wb(26,"label",15),l.Cc(27,"Schedule Start Time:"),l.Vb(),l.Rb(28,"input",16),l.Ac(29,k,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(30,"div",10),l.Wb(31,"div",11),l.Wb(32,"label",17),l.Cc(33,"Schedule End Time:"),l.Vb(),l.Rb(34,"input",18),l.Ac(35,U,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(36,"div",10),l.Wb(37,"div",11),l.Wb(38,"label",19),l.Cc(39,"Subject:"),l.Vb(),l.Wb(40,"nb-select",20),l.ec("selectedChange",(function(e){return t.onSelectSubject(e)})),l.Wb(41,"nb-option",21),l.Cc(42,"Select Subject"),l.Vb(),l.Ac(43,O,2,2,"nb-option",22),l.Vb(),l.Ac(44,N,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(45,"div",10),l.Wb(46,"div",11),l.Wb(47,"label",23),l.Cc(48,"Topic:"),l.Vb(),l.Rb(49,"input",24),l.Ac(50,P,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(51,"div",10),l.Wb(52,"div",11),l.Wb(53,"label",25),l.Cc(54,"Teacher:"),l.Vb(),l.Wb(55,"nb-select",26),l.Wb(56,"nb-option",21),l.Cc(57,"Select Teacher"),l.Vb(),l.Ac(58,z,2,2,"nb-option",22),l.Vb(),l.Ac(59,Q,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Wb(60,"div",10),l.Wb(61,"div",11),l.Wb(62,"label",27),l.Cc(63,"Session Type:"),l.Vb(),l.Wb(64,"nb-select",28),l.Wb(65,"nb-option",29),l.Cc(66," Class Room "),l.Vb(),l.Wb(67,"nb-option",30),l.Cc(68," Online "),l.Vb(),l.Vb(),l.Ac(69,$,2,1,"ng-container",14),l.Vb(),l.Vb(),l.Vb(),l.Rb(70,"hr"),l.Wb(71,"div",1),l.Wb(72,"div",5),l.Wb(73,"button",31),l.Cc(74," Next "),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Ac(75,se,20,4,"nb-step",32),l.Wb(76,"nb-step",33),l.Wb(77,"div",34),l.Wb(78,"div",35),l.Wb(79,"table",36),l.Wb(80,"tbody"),l.Wb(81,"tr"),l.Wb(82,"th"),l.Cc(83,"Date"),l.Vb(),l.Wb(84,"td"),l.Cc(85),l.Vb(),l.Vb(),l.Wb(86,"tr"),l.Wb(87,"th"),l.Cc(88,"Schedule Start Time"),l.Vb(),l.Wb(89,"td"),l.Cc(90),l.Vb(),l.Vb(),l.Wb(91,"tr"),l.Wb(92,"th"),l.Cc(93,"Schedule End Time"),l.Vb(),l.Wb(94,"td"),l.Cc(95),l.Vb(),l.Vb(),l.Wb(96,"tr"),l.Wb(97,"th"),l.Cc(98,"Subject"),l.Vb(),l.Wb(99,"td"),l.Cc(100),l.Vb(),l.Vb(),l.Wb(101,"tr"),l.Wb(102,"th"),l.Cc(103,"Topic"),l.Vb(),l.Wb(104,"td"),l.Cc(105),l.Vb(),l.Vb(),l.Wb(106,"tr"),l.Wb(107,"th"),l.Cc(108,"Teacher"),l.Vb(),l.Wb(109,"td"),l.Cc(110),l.Vb(),l.Vb(),l.Wb(111,"tr"),l.Wb(112,"th"),l.Cc(113,"Session Type"),l.Vb(),l.Wb(114,"td"),l.Cc(115),l.Vb(),l.Vb(),l.Wb(116,"tr"),l.Wb(117,"th"),l.Cc(118,"Repeat"),l.Vb(),l.Wb(119,"td"),l.Cc(120),l.Vb(),l.Vb(),l.Ac(121,re,11,2,"ng-container",14),l.Vb(),l.Vb(),l.Vb(),l.Rb(122,"hr"),l.Wb(123,"div",1),l.Wb(124,"div",37),l.Wb(125,"button",38),l.ec("click",(function(){return t.previousStep()})),l.Rb(126,"nb-icon",39),l.Wb(127,"span"),l.Cc(128,"prev"),l.Vb(),l.Vb(),l.Vb(),l.Wb(129,"div",40),l.Wb(130,"button",41),l.ec("click",(function(){return t.saveSchedule()})),l.Wb(131,"span"),l.Cc(132,"Submit"),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.mc("ngIf",t.repeatSchedule),l.Eb(6),l.Ec("",t.schedule?"Edit":"Add"," Schedule"),l.Eb(7),l.mc("linear",!0)("disableStepNavigation",!0),l.Eb(2),l.mc("stepControl",t.scheduleForm),l.Eb(1),l.mc("formGroup",t.scheduleForm),l.Eb(6),l.mc("min",t.schedule?t.schedule.date:t.dateService.getDateString())("status",t.scheduleForm.get("date").touched?t.scheduleForm.get("date").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.scheduleForm.get("date").invalid&&t.scheduleForm.get("date").touched),l.Eb(5),l.mc("status",t.scheduleForm.get("startTime").touched?t.scheduleForm.get("startTime").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.scheduleForm.get("startTime").invalid&&t.scheduleForm.get("startTime").touched),l.Eb(5),l.mc("status",t.scheduleForm.get("endTime").touched?t.scheduleForm.get("endTime").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.scheduleForm.get("endTime").invalid&&t.scheduleForm.get("endTime").touched),l.Eb(5),l.mc("status",t.scheduleForm.get("subject").touched?t.scheduleForm.get("subject").invalid?"danger":"success":"basic"),l.Eb(3),l.mc("ngForOf",t.subjects),l.Eb(1),l.mc("ngIf",t.scheduleForm.get("subject").invalid&&t.scheduleForm.get("subject").touched),l.Eb(5),l.mc("status",t.scheduleForm.get("topic").touched?t.scheduleForm.get("topic").invalid?"danger":"success":"basic"),l.Eb(1),l.mc("ngIf",t.scheduleForm.get("topic").invalid&&t.scheduleForm.get("topic").touched),l.Eb(5),l.mc("status",t.scheduleForm.get("teacher").touched?t.scheduleForm.get("teacher").invalid?"danger":"success":"basic"),l.Eb(3),l.mc("ngForOf",t.teachers),l.Eb(1),l.mc("ngIf",t.scheduleForm.get("teacher").invalid&&t.scheduleForm.get("teacher").touched),l.Eb(5),l.mc("status",t.scheduleForm.get("sessionType").touched?t.scheduleForm.get("sessionType").invalid?"danger":"success":"basic"),l.Eb(5),l.mc("ngIf",t.scheduleForm.get("sessionType").invalid&&t.scheduleForm.get("sessionType").touched),l.Eb(6),l.mc("ngIf",!t.schedule),l.Eb(10),l.Dc(t.dateService.formatDate(t.scheduleForm.value.date)),l.Eb(5),l.Dc(t.scheduleForm.value.startTime),l.Eb(5),l.Dc(t.scheduleForm.value.endTime),l.Eb(5),l.Dc(t.getSubject(t.scheduleForm.value.subject)),l.Eb(5),l.Dc(t.scheduleForm.value.topic),l.Eb(5),l.Dc(t.getTeacher(t.scheduleForm.value.teacher)),l.Eb(5),l.Dc(t.scheduleForm.value.sessionType),l.Eb(5),l.Dc(t.repeat?"Yes":"No"),l.Eb(1),l.mc("ngIf",t.repeat))},directives:[r.n,s.x,s.z,s.u,s.w,s.pb,s.ob,i.v,i.n,i.g,s.O,i.a,i.m,i.e,s.jb,s.eb,r.m,s.L,D,i.o,s.C,i.p,s.zb],styles:[".week-day-selector[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none!important}.week-day-selector[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{display:inline-block;font-size:75%;border:1px solid #aaa;border-radius:50%;background:#fff;height:40px;width:40px;padding:1px;margin:1px;line-height:35px;text-align:center;cursor:pointer;transition:background .2s,color .2s}.week-day-selector[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{background:#0095ff;color:#fff}"]}),e})()}];let ae=(()=>{class e{}return e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({factory:function(t){return new(t||e)},imports:[[h.g.forChild(ne)],h.g]}),e})();c.d(t,"AddScheduleModule",(function(){return oe}));let oe=(()=>{class e{}return e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({factory:function(t){return new(t||e)},imports:[[r.c,ae,s.A,s.kb,s.D,s.qb,s.Ab,s.v,s.P,s.N,i.s,i.h]]}),e})()}}]);