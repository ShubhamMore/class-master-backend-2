function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{jX92:function(e,t,n){"use strict";n.r(t);var a=n("aceb"),i=n("ofXK"),r=n("mrSG"),o=n("EQut"),s=n("gmaa"),l=n("RSY0"),u=n("fXoL"),c=n("tyNb");function m(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",4),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](n);var e=u["\u0275\u0275nextContext"]();return e.examStarted?e.submitExam():e.startExam()})),u["\u0275\u0275text"](1),u["\u0275\u0275elementEnd"]()}if(2&e){var a=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"](" ",a.examStarted?"Submit":"Start"," Exam ")}}function d(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"p"),u["\u0275\u0275elementStart"](1,"span"),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate2"]("",n.getDate(n.onlineExam.date),".\xa0",n.getTime(n.onlineExam.time),"")}}function x(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"p",5),u["\u0275\u0275text"](2,"Click on Start Exam"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]())}function p(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"p",13),u["\u0275\u0275text"](1," Exam will End In "),u["\u0275\u0275element"](2,"br"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",n.examCountDownTimer," ")}}function f(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"p",13),u["\u0275\u0275text"](1," Exam Ended "),u["\u0275\u0275elementEnd"]())}function v(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",14),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"](3).previousQuestion()})),u["\u0275\u0275element"](1,"nb-icon",15),u["\u0275\u0275elementEnd"]()}}function h(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",16),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"](3).nextQuestion()})),u["\u0275\u0275element"](1,"nb-icon",17),u["\u0275\u0275elementEnd"]()}}function g(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"nb-checkbox",20),u["\u0275\u0275listener"]("checkedChange",(function(e){u["\u0275\u0275restoreView"](n);var a=t.$implicit,i=t.index,r=u["\u0275\u0275nextContext"](4);return r.markAnswer(r.currentQuestion._id,r.currentQuestionIndex,a._id,i,e)})),u["\u0275\u0275elementStart"](2,"strong"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](4," \xa0\xa0 "),u["\u0275\u0275elementStart"](5,"span"),u["\u0275\u0275text"](6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit,i=t.index;u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",i+1,"."),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](a.answer)}}function S(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",6),u["\u0275\u0275elementStart"](1,"div",7),u["\u0275\u0275elementStart"](2,"p",18),u["\u0275\u0275elementStart"](3,"strong"),u["\u0275\u0275text"](4),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"p"),u["\u0275\u0275elementStart"](6,"Strong"),u["\u0275\u0275text"](7),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](8,g,7,2,"div",19),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("Question ",n.currentQuestionIndex+1,""),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](n.currentQuestion.question),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngForOf",n.currentQuestion.answers)}}function E(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"p",18),u["\u0275\u0275text"](1,"Calculating Result"),u["\u0275\u0275elementEnd"]())}function w(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"p",18),u["\u0275\u0275elementStart"](1,"span"),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](3,"span"),u["\u0275\u0275text"](4,","),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"span"),u["\u0275\u0275text"](6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](7,"br"),u["\u0275\u0275elementStart"](8,"span"),u["\u0275\u0275text"](9),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](10,"span"),u["\u0275\u0275text"](11,","),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](12,"span"),u["\u0275\u0275text"](13),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](14,"br"),u["\u0275\u0275elementStart"](15,"strong"),u["\u0275\u0275text"](16,"You got: "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](17),u["\u0275\u0275element"](18,"br"),u["\u0275\u0275elementStart"](19,"strong"),u["\u0275\u0275text"](20),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"](4);u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"]("Attempted: ",n.onlineExamResult.answeredQuestions," "),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("Unattempted: ",n.onlineExamResult.unAnsweredQuestions," "),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("Correct Answers: ",n.onlineExamResult.correctAnswers,""),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("Wrong Answers: ",n.onlineExamResult.wrongAnswers,""),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate2"](" ",n.onlineExamResult.marks,"/",n.onlineExam.totalMarks," "),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](n.onlineExamResult.status?"Pass":"Failed")}}function b(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",6),u["\u0275\u0275elementStart"](1,"div",21),u["\u0275\u0275template"](2,E,2,0,"p",22),u["\u0275\u0275template"](3,w,21,7,"p",22),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",n.calculatingResult),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!n.calculatingResult)}}function I(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"div",6),u["\u0275\u0275elementStart"](2,"div",7),u["\u0275\u0275template"](3,p,4,1,"p",8),u["\u0275\u0275template"](4,f,2,0,"p",8),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"div",9),u["\u0275\u0275template"](6,v,2,0,"button",10),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"div",9),u["\u0275\u0275template"](8,h,2,0,"button",11),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](9,"hr"),u["\u0275\u0275template"](10,S,9,3,"div",12),u["\u0275\u0275template"](11,b,4,2,"div",12),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",n.examCountDownTimer),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!n.examCountDownTimer&&n.examSubmitted),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",n.currentQuestionIndex>0&&!n.examSubmitted),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",n.currentQuestionIndex<n.questions.length-1&&!n.examSubmitted),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!n.examSubmitted),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",n.examSubmitted)}}function y(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275template"](1,x,3,0,"div",1),u["\u0275\u0275template"](2,I,12,6,"div",1),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!n.examStarted),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",n.examStarted)}}function T(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1," Loading... "),u["\u0275\u0275elementEnd"]())}function C(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1," Exam will Start In "),u["\u0275\u0275element"](2,"br"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",n.waitingToStart," ")}}function Q(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"p",23),u["\u0275\u0275template"](1,T,2,0,"span",1),u["\u0275\u0275template"](2,C,4,1,"span",1),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf","loading"===n.waitingToStart),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf","loading"!==n.waitingToStart)}}var k,D,R=[{path:"",component:(k=function(){function e(t,n,a,i,r,o){_classCallCheck(this,e),this.branchService=t,this.toastrService=n,this.onlineExamService=a,this.onlineExamQuestionService=i,this.router=r,this.route=o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?(this.waitingToStart="loading",this.onlineExamService.getOnlineExamData().subscribe((function(t){t?e.onlineExam=t:e.back()})),this.questions=[],this.onlineExamService.getOnlineExamResult(this.onlineExam._id).subscribe((function(t){if(t)e.onlineExamResult=t,e.waitingToStart=null,e.examStarted=!0,e.examSubmitted=!0,e.calculatingResult=!1;else{var n=new Date(e.onlineExam.date+"T"+e.onlineExam.time).getTime();e.examStartTime=n,e.examStarted=!1,e.examSubmitted=!1,e.examTimeUp=!1;var a=setInterval((function(){var t=(new Date).getTime(),i=n-t,r=Math.floor(i%864e5/36e5),o=Math.floor(i%36e5/6e4),s=Math.floor(i%6e4/1e3);e.waitingToStart=r+"H "+o+"M "+s+"S ",i<0&&(clearInterval(a),e.waitingToStart=null),e.loading&&(e.loading=!1)}),1e3)}e.loading=!1}),(function(t){e.showToastr("top-right","danger",t),e.loading=!1}))):this.router.navigate(["../"],{relativeTo:this.route})}},{key:"getDate",value:function(e){return(e=new Date(e).toString()).substring(0,3)+", "+e.substring(4,15)}},{key:"getTime",value:function(e){var t=+e.split(":")[0],n=e.split(":")[1];return+t>12?(+t-12).toString().padStart(2,"0")+":"+n+" PM":t.toString().padStart(2,"0")+":"+n+" AM"}},{key:"startExam",value:function(){var e=this;this.onlineExamQuestionService.getOnlineExamQuestionsForStudent(this.onlineExam._id).subscribe((function(t){e.questions=t,e.waitingToStart=null,e.examStarted=!0,e.studentQuestionAnswers=[],e.currentQuestionIndex=0,e.currentQuestion=e.questions[0];var n=60*+e.onlineExam.duration*1e3,a=(new Date).getTime(),i=e.examStartTime+n+0;i-a>=n?e.examEndTime=a+n:i>a?(e.examEndTime=e.examStartTime+n+0,e.examCountDown()):(e.examEndTime=null,e.examTimeUp=!0,e.submitExam())}),(function(t){e.showToastr("top-right","danger",t)}))}},{key:"examCountDown",value:function(){var e=this;this.examInterval=setInterval((function(){return Object(r.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(new Date).getTime(),n=this.examEndTime-t,a=Math.floor(n%864e5/36e5),i=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3),this.examCountDownTimer=a+"H "+i+"M "+r+"S ",n<0&&(this.examCountDownTimer=null,this.examTimeUp=!0,this.submitExam());case 2:case"end":return e.stop()}}),e,this)})))}),1e3)}},{key:"previousQuestion",value:function(){this.currentQuestionIndex-=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}},{key:"nextQuestion",value:function(){this.currentQuestionIndex+=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}},{key:"markAnswer",value:function(e,t,n,a,i){var r=this.studentQuestionAnswers.findIndex((function(t){return t.questionId===e}));if(i)if(r<0){var o={questionId:e,questionIndex:t,answerIds:[]};o.answerIds.push(n),this.studentQuestionAnswers.push(o)}else{var s=this.studentQuestionAnswers[r];s.answerIds.push(n),this.studentQuestionAnswers[r]=s}else if(r>-1){var l=this.studentQuestionAnswers[r],u=l.answerIds.findIndex((function(e){return e.answerId===n}));l.answerIds.splice(u,1),this.studentQuestionAnswers[r]=l}}},{key:"submitExam",value:function(){var e=this,t=!0;this.examTimeUp||(t=window.confirm("Do you want to Submit the Exam?")),t&&(this.calculatingResult=!0,this.examSubmitted=!0,this.currentQuestion=null,this.currentQuestionIndex=null,clearInterval(this.examInterval),this.examCountDownTimer=null,this.onlineExamService.saveOnlineExamResult(this.studentQuestionAnswers,this.onlineExam._id).subscribe((function(t){e.onlineExamResult=t.onlineExamResult,0===t.type&&e.showToastr("top-right","success","Exam Submitted Successfully!"),e.calculatingResult=!1}),(function(t){e.showToastr("top-right","danger",t)})))}},{key:"showToastr",value:function(e,t,n){this.toastrService.show(t,n,{position:e,status:t})}},{key:"back",value:function(){this.router.navigate(["../"],{relativeTo:this.route})}},{key:"ngOnDestroy",value:function(){clearInterval(this.examInterval)}}]),e}(),k.\u0275fac=function(e){return new(e||k)(u["\u0275\u0275directiveInject"](o.a),u["\u0275\u0275directiveInject"](a.Db),u["\u0275\u0275directiveInject"](l.a),u["\u0275\u0275directiveInject"](s.a),u["\u0275\u0275directiveInject"](c.c),u["\u0275\u0275directiveInject"](c.a))},k.\u0275cmp=u["\u0275\u0275defineComponent"]({type:k,selectors:[["ngx-online-test-question"]],decls:10,vars:5,consts:[["type","button","class","float-right","nbButton","","size","small","status","success",3,"click",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["examStartCountDown",""],["type","button","nbButton","","size","small","status","success",1,"float-right",3,"click"],["id","countDown",1,"pt-5","pb-5","text-center"],[1,"row"],[1,"col-12"],["class","text-right","id","examCountDownTimer",4,"ngIf"],[1,"col-6"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click",4,"ngIf"],["class","float-right","type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",3,"click",4,"ngIf"],["class","row",4,"ngIf"],["id","examCountDownTimer",1,"text-right"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click"],["icon","arrow-ios-back-outline"],["type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",1,"float-right",3,"click"],["icon","arrow-ios-forward-outline"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"checkedChange"],[1,"col-12","pt-3","pb-3"],["class","text-center",4,"ngIf"],["id","waitingToStart",1,"pt-5","pb-5","text-center"]],template:function(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"nb-card"),u["\u0275\u0275elementStart"](1,"nb-card-header"),u["\u0275\u0275template"](2,m,2,1,"button",0),u["\u0275\u0275elementStart"](3,"h3"),u["\u0275\u0275text"](4),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](5,d,3,2,"p",1),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](6,"nb-card-body"),u["\u0275\u0275template"](7,y,3,2,"div",2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](8,Q,3,2,"ng-template",null,3,u["\u0275\u0275templateRefExtractor"])),2&e){var n=u["\u0275\u0275reference"](9);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!t.examSubmitted&&!t.waitingToStart),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"](" ",t.onlineExam?t.onlineExam.title:"Online Exam"," "),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.onlineExam),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!t.waitingToStart)("ngIfElse",n)}},directives:[a.x,a.z,i.n,a.w,a.u,a.Fb,a.M,i.m,a.C],styles:[""]}),k)},{path:"page-not-found",loadChildren:function(){return n.e(0).then(n.bind(null,"DeSt")).then((function(e){return e.PageNotFoundModule}))}},{path:"**",redirectTo:"page-not-found",pathMatch:"full"}],A=((D=function e(){_classCallCheck(this,e)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:D}),D.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||D)},imports:[[c.g.forChild(R)],c.g]}),D);n.d(t,"OnlineTestQuestionModule",(function(){return _}));var M,_=((M=function e(){_classCallCheck(this,e)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:M}),M.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||M)},imports:[[i.c,A,a.A,a.v,a.O,a.Gb,a.D]]}),M)},mrSG:function(e,t,n){"use strict";function a(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{l(a.next(e))}catch(t){r(t)}}function s(e){try{l(a.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))}n.d(t,"a",(function(){return a}))}}]);