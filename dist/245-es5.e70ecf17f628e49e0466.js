!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[245],{jX92:function(n,a,i){"use strict";i.r(a),i.d(a,"OnlineTestQuestionModule",(function(){return q}));var r=i("aceb"),o=i("ofXK"),s=i("fXoL"),l=i("EQut"),u=i("RSY0"),m=i("gmaa"),c=i("tyNb");function d(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",4),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](n);var e=s["\u0275\u0275nextContext"]();return e.examStarted?e.submitExam():e.startExam()})),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()}if(2&e){var a=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",a.examStarted?"Submit":"Start"," Exam ")}}function x(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"p"),s["\u0275\u0275elementStart"](1,"span"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate2"]("",n.getDate(n.onlineExam.date),".\xa0",n.getTime(n.onlineExam.time),"")}}function p(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"p",5),s["\u0275\u0275text"](2,"Click on Start Exam"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]())}function f(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"p",13),s["\u0275\u0275text"](1," Exam will End In "),s["\u0275\u0275element"](2,"br"),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](3);s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",n.examCountDownTimer," ")}}function v(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"p",13),s["\u0275\u0275text"](1," Exam Ended "),s["\u0275\u0275elementEnd"]())}function h(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",14),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"](3).previousQuestion()})),s["\u0275\u0275element"](1,"nb-icon",15),s["\u0275\u0275elementEnd"]()}}function g(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",16),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](n),s["\u0275\u0275nextContext"](3).nextQuestion()})),s["\u0275\u0275element"](1,"nb-icon",17),s["\u0275\u0275elementEnd"]()}}function S(e,t){if(1&e){var n=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"nb-checkbox",20),s["\u0275\u0275listener"]("checkedChange",(function(e){s["\u0275\u0275restoreView"](n);var a=t.$implicit,i=t.index,r=s["\u0275\u0275nextContext"](4);return r.markAnswer(r.currentQuestion._id,r.currentQuestionIndex,a._id,i,e)})),s["\u0275\u0275elementStart"](2,"strong"),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](4," \xa0\xa0 "),s["\u0275\u0275elementStart"](5,"span"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit,i=t.index;s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",i+1,"."),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](a.answer)}}function E(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",6),s["\u0275\u0275elementStart"](1,"div",7),s["\u0275\u0275elementStart"](2,"p",18),s["\u0275\u0275elementStart"](3,"strong"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"p"),s["\u0275\u0275elementStart"](6,"Strong"),s["\u0275\u0275text"](7),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](8,S,7,2,"div",19),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](3);s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Question ",n.currentQuestionIndex+1,""),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](n.currentQuestion.question),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",n.currentQuestion.answers)}}function w(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"p",18),s["\u0275\u0275text"](1,"Calculating Result"),s["\u0275\u0275elementEnd"]())}function b(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"p",18),s["\u0275\u0275elementStart"](1,"span"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"span"),s["\u0275\u0275text"](4,","),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"span"),s["\u0275\u0275text"](6),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](7,"br"),s["\u0275\u0275elementStart"](8,"span"),s["\u0275\u0275text"](9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"span"),s["\u0275\u0275text"](11,","),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"span"),s["\u0275\u0275text"](13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](14,"br"),s["\u0275\u0275elementStart"](15,"strong"),s["\u0275\u0275text"](16,"You got: "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](17),s["\u0275\u0275element"](18,"br"),s["\u0275\u0275elementStart"](19,"strong"),s["\u0275\u0275text"](20),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](4);s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("Attempted: ",n.onlineExamResult.answeredQuestions," "),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Unattempted: ",n.onlineExamResult.unAnsweredQuestions," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("Correct Answers: ",n.onlineExamResult.correctAnswers,""),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate1"]("Wrong Answers: ",n.onlineExamResult.wrongAnswers,""),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate2"](" ",n.onlineExamResult.marks,"/",n.onlineExam.totalMarks," "),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](n.onlineExamResult.status?"Pass":"Failed")}}function I(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",6),s["\u0275\u0275elementStart"](1,"div",21),s["\u0275\u0275template"](2,w,2,0,"p",22),s["\u0275\u0275template"](3,b,21,7,"p",22),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](3);s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",n.calculatingResult),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!n.calculatingResult)}}function y(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275elementStart"](1,"div",6),s["\u0275\u0275elementStart"](2,"div",7),s["\u0275\u0275template"](3,f,4,1,"p",8),s["\u0275\u0275template"](4,v,2,0,"p",8),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",9),s["\u0275\u0275template"](6,h,2,0,"button",10),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"div",9),s["\u0275\u0275template"](8,g,2,0,"button",11),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](9,"hr"),s["\u0275\u0275template"](10,E,9,3,"div",12),s["\u0275\u0275template"](11,I,4,2,"div",12),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",n.examCountDownTimer),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!n.examCountDownTimer&&n.examSubmitted),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",n.currentQuestionIndex>0&&!n.examSubmitted),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",n.currentQuestionIndex<n.questions.length-1&&!n.examSubmitted),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",!n.examSubmitted),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",n.examSubmitted)}}function T(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div"),s["\u0275\u0275template"](1,p,3,0,"div",1),s["\u0275\u0275template"](2,y,12,6,"div",1),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!n.examStarted),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",n.examStarted)}}function Q(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275text"](1," Loading... "),s["\u0275\u0275elementEnd"]())}function C(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"span"),s["\u0275\u0275text"](1," Exam will Start In "),s["\u0275\u0275element"](2,"br"),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("",n.waitingToStart," ")}}function k(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"p",23),s["\u0275\u0275template"](1,Q,2,0,"span",1),s["\u0275\u0275template"](2,C,4,1,"span",1),s["\u0275\u0275elementEnd"]()),2&e){var n=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","loading"===n.waitingToStart),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf","loading"!==n.waitingToStart)}}var D,R,A,M=[{path:"",component:(D=function(){function n(t,a,i,r,o,s){e(this,n),this.branchService=t,this.toastrService=a,this.onlineExamService=i,this.onlineExamQuestionService=r,this.router=o,this.route=s}var a,i,r;return a=n,(i=[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?(this.waitingToStart="loading",this.onlineExamService.getOnlineExamData().subscribe((function(t){t?e.onlineExam=t:e.back()})),this.questions=[],this.onlineExamService.getOnlineExamResult(this.onlineExam._id).subscribe((function(t){if(t)e.onlineExamResult=t,e.waitingToStart=null,e.examStarted=!0,e.examSubmitted=!0,e.calculatingResult=!1;else{var n=new Date(e.onlineExam.date+"T"+e.onlineExam.time).getTime();e.examStartTime=n,e.examStarted=!1,e.examSubmitted=!1,e.examTimeUp=!1;var a=setInterval((function(){var t=(new Date).getTime(),i=n-t,r=Math.floor(i%864e5/36e5),o=Math.floor(i%36e5/6e4),s=Math.floor(i%6e4/1e3);e.waitingToStart=r+"H "+o+"M "+s+"S ",i<0&&(clearInterval(a),e.waitingToStart=null),e.loading&&(e.loading=!1)}),1e3)}e.loading=!1}),(function(t){e.showToastr("top-right","danger",t),e.loading=!1}))):this.back()}},{key:"getDate",value:function(e){return(e=new Date(e).toString()).substring(0,3)+", "+e.substring(4,15)}},{key:"getTime",value:function(e){var t=+e.split(":")[0],n=e.split(":")[1];return+t>12?(+t-12).toString().padStart(2,"0")+":"+n+" PM":t.toString().padStart(2,"0")+":"+n+" AM"}},{key:"startExam",value:function(){var e=this;this.onlineExamQuestionService.getOnlineExamQuestionsForStudent(this.onlineExam._id).subscribe((function(t){e.questions=t,e.waitingToStart=null,e.examStarted=!0,e.studentQuestionAnswers=[],e.currentQuestionIndex=0,e.currentQuestion=e.questions[0];var n=60*+e.onlineExam.duration*1e3,a=(new Date).getTime(),i=e.examStartTime+n+0;i-a>=n?e.examEndTime=a+n:i>a?(e.examEndTime=e.examStartTime+n+0,e.examCountDown()):(e.examEndTime=null,e.examTimeUp=!0,e.submitExam())}),(function(t){e.showToastr("top-right","danger",t)}))}},{key:"examCountDown",value:function(){var e=this;this.examInterval=setInterval((function(){return t=e,a=regeneratorRuntime.mark((function e(){var t,n,a,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(new Date).getTime(),n=this.examEndTime-t,a=Math.floor(n%864e5/36e5),i=Math.floor(n%36e5/6e4),r=Math.floor(n%6e4/1e3),this.examCountDownTimer=a+"H "+i+"M "+r+"S ",n<0&&(this.examCountDownTimer=null,this.examTimeUp=!0,this.submitExam());case 2:case"end":return e.stop()}}),e,this)})),new((n=void 0)||(n=Promise))((function(e,i){function r(e){try{s(a.next(e))}catch(t){i(t)}}function o(e){try{s(a.throw(e))}catch(t){i(t)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}s((a=a.apply(t,[])).next())}));var t,n,a}),1e3)}},{key:"previousQuestion",value:function(){this.currentQuestionIndex-=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}},{key:"nextQuestion",value:function(){this.currentQuestionIndex+=1,this.currentQuestion=this.questions[this.currentQuestionIndex]}},{key:"markAnswer",value:function(e,t,n,a,i){var r=this.studentQuestionAnswers.findIndex((function(t){return t.questionId===e}));if(i)if(r<0){var o={questionId:e,questionIndex:t,answerIds:[]};o.answerIds.push(n),this.studentQuestionAnswers.push(o)}else{var s=this.studentQuestionAnswers[r];s.answerIds.push(n),this.studentQuestionAnswers[r]=s}else if(r>-1){var l=this.studentQuestionAnswers[r],u=l.answerIds.findIndex((function(e){return e.answerId===n}));l.answerIds.splice(u,1),this.studentQuestionAnswers[r]=l}}},{key:"submitExam",value:function(){var e=this,t=!0;this.examTimeUp||(t=window.confirm("Do you want to Submit the Exam?")),t&&(this.calculatingResult=!0,this.examSubmitted=!0,this.currentQuestion=null,this.currentQuestionIndex=null,clearInterval(this.examInterval),this.examCountDownTimer=null,this.onlineExamService.saveOnlineExamResult(this.studentQuestionAnswers,this.onlineExam._id).subscribe((function(t){e.onlineExamResult=t.onlineExamResult,0===t.type&&e.showToastr("top-right","success","Exam Submitted Successfully!"),e.calculatingResult=!1}),(function(t){e.showToastr("top-right","danger",t)})))}},{key:"showToastr",value:function(e,t,n){this.toastrService.show(t,n,{position:e,status:t})}},{key:"back",value:function(){this.router.navigate(["../"],{relativeTo:this.route})}},{key:"ngOnDestroy",value:function(){clearInterval(this.examInterval)}}])&&t(a.prototype,i),r&&t(a,r),n}(),D.\u0275fac=function(e){return new(e||D)(s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](r.Gb),s["\u0275\u0275directiveInject"](u.a),s["\u0275\u0275directiveInject"](m.a),s["\u0275\u0275directiveInject"](c.c),s["\u0275\u0275directiveInject"](c.a))},D.\u0275cmp=s["\u0275\u0275defineComponent"]({type:D,selectors:[["ngx-online-test-question"]],decls:10,vars:5,consts:[["type","button","class","float-right","nbButton","","size","small","status","success",3,"click",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["examStartCountDown",""],["type","button","nbButton","","size","small","status","success",1,"float-right",3,"click"],["id","countDown",1,"pt-5","pb-5","text-center"],[1,"row"],[1,"col-12"],["class","text-right","id","examCountDownTimer",4,"ngIf"],[1,"col-6"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click",4,"ngIf"],["class","float-right","type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",3,"click",4,"ngIf"],["class","row",4,"ngIf"],["id","examCountDownTimer",1,"text-right"],["type","button","nbButton","","size","small","status","success","nbTooltip","Previous Question",3,"click"],["icon","arrow-ios-back-outline"],["type","button","nbButton","","size","small","status","success","nbTooltip","Next Question",1,"float-right",3,"click"],["icon","arrow-ios-forward-outline"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"checkedChange"],[1,"col-12","pt-3","pb-3"],["class","text-center",4,"ngIf"],["id","waitingToStart",1,"pt-5","pb-5","text-center"]],template:function(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"nb-card"),s["\u0275\u0275elementStart"](1,"nb-card-header"),s["\u0275\u0275template"](2,d,2,1,"button",0),s["\u0275\u0275elementStart"](3,"h3"),s["\u0275\u0275text"](4),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](5,x,3,2,"p",1),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"nb-card-body"),s["\u0275\u0275template"](7,T,3,2,"div",2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](8,k,3,2,"ng-template",null,3,s["\u0275\u0275templateRefExtractor"])),2&e){var n=s["\u0275\u0275reference"](9);s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",!t.examSubmitted&&!t.waitingToStart),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",t.onlineExam?t.onlineExam.title:"Online Exam"," "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.onlineExam),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",!t.waitingToStart)("ngIfElse",n)}},directives:[r.y,r.A,o.n,r.x,r.v,r.Ib,r.N,o.m,r.D],styles:[""]}),D)},{path:"page-not-found",loadChildren:function(){return i.e(0).then(i.bind(null,"DeSt")).then((function(e){return e.PageNotFoundModule}))}},{path:"**",redirectTo:"page-not-found",pathMatch:"full"}],j=((A=function t(){e(this,t)}).\u0275mod=s["\u0275\u0275defineNgModule"]({type:A}),A.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(e){return new(e||A)},imports:[[c.g.forChild(M)],c.g]}),A),q=((R=function t(){e(this,t)}).\u0275mod=s["\u0275\u0275defineNgModule"]({type:R}),R.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(e){return new(e||R)},imports:[[o.c,j,r.B,r.w,r.P,r.Jb,r.E]]}),R)}}])}();
//# sourceMappingURL=245-es5.e70ecf17f628e49e0466.js.map