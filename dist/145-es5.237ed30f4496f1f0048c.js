function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var c=t[i];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{ony3:function(e,t,i){"use strict";i.r(t);var c=i("aceb"),a=i("ofXK"),n=i("tyNb"),r=i("IAlr"),s=i("OeS+"),u=i("ZatZ"),h=i("EQut"),o=i("lst6"),l=i("fXoL");function d(e,t){if(1&e){var i=l.Xb();l.Wb(0,"tr"),l.Wb(1,"td"),l.Cc(2),l.Vb(),l.Wb(3,"td"),l.Cc(4),l.Vb(),l.Wb(5,"td"),l.Cc(6),l.Vb(),l.Wb(7,"td"),l.Cc(8),l.Vb(),l.Wb(9,"td"),l.Wb(10,"button",22),l.ec("click",(function(){l.uc(i);var e=t.$implicit;return l.gc(3).editSchedule(e)})),l.Cc(11," Edit "),l.Vb(),l.Vb(),l.Wb(12,"td"),l.Wb(13,"button",23),l.ec("click",(function(){l.uc(i);var e=t.$implicit;return l.gc(3).deleteSchedule(e._id)})),l.Cc(14," Delete "),l.Vb(),l.Vb(),l.Vb()}if(2&e){var c=t.$implicit,a=l.gc(3);l.Eb(2),l.Dc(a.getTime(c.startTime,c.endTime)),l.Eb(2),l.Dc(a.getSubject(c.subject)),l.Eb(2),l.Dc(c.topic),l.Eb(2),l.Dc(a.getTeacher(c.teacher))}}function b(e,t){if(1&e&&(l.Wb(0,"div",20),l.Wb(1,"table",21),l.Ac(2,d,15,4,"tr",13),l.Vb(),l.Vb()),2&e){var i=l.gc().$implicit,c=l.gc();l.Eb(2),l.mc("ngForOf",c.getFilteredSchedule(i))}}function v(e,t){1&e&&(l.Wb(0,"p",10),l.Cc(1,"No Schedule"),l.Vb())}function D(e,t){if(1&e){var i=l.Xb();l.Wb(0,"nb-accordion-item"),l.Wb(1,"nb-accordion-item-header"),l.Wb(2,"div",14),l.Wb(3,"div",15),l.Wb(4,"button",16),l.ec("click",(function(){l.uc(i);var e=t.$implicit;return l.gc().addScheduleOfDay(e)})),l.Rb(5,"nb-icon",17),l.Vb(),l.Wb(6,"span"),l.Cc(7),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Wb(8,"nb-accordion-item-body"),l.Ac(9,b,3,1,"div",18),l.Ac(10,v,2,0,"ng-template",null,19,l.Bc),l.Vb(),l.Vb()}if(2&e){var c=t.$implicit,a=l.sc(11),n=l.gc();l.Eb(7),l.Dc(c),l.Eb(2),l.mc("ngIf",n.getFilteredSchedule(c).length>0)("ngIfElse",a)}}var f,g,y=[{path:"",component:(f=function(){function e(t,i,c,a,n,r,s,u){_classCallCheck(this,e),this.branchService=t,this.scheduleService=i,this.courseService=c,this.batchService=a,this.dateService=n,this.router=r,this.route=s,this.toastrService=u}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.branchId=this.branchService.getBranchId(),this.branchId?(this.branchService.getCategoryData().subscribe((function(t){e.category=t})),this.courseService.getCourseData().subscribe((function(t){e.course=t})),this.batchService.getBatchData().subscribe((function(t){e.batch=t})),this.days=[],this.schedules=[],this.setCurDate(this.dateService.getDate()),this.changeScheduleCalenderType(0),this.getSchedule()):this.router.navigate(["../"],{relativeTo:this.route})}},{key:"setCurDate",value:function(e){this.curDate=e,this.curMonth=this.curDate.getMonth(),this.curYear=this.curDate.getFullYear()}},{key:"setStartDate",value:function(){var e=new Date(this.curDate);0===this.scheduleCalenderType?this.startDate=new Date(e):1===this.scheduleCalenderType?(e.setDate(e.getDate()-e.getDay()),this.startDate=new Date(e)):(e.setDate(1),this.startDate=new Date(e)),this.calcNoOfDays(),this.getSchedule()}},{key:"calcNoOfDays",value:function(){var e;e=0===this.scheduleCalenderType?1:1===this.scheduleCalenderType?7:this.daysInMonth(this.curMonth,this.curYear),this.noOfDays=e,this.days=[];for(var t=0;t<e;t++){var i=this.dateService.millisecondsToDate(this.dateService.dateToMilliseconds(this.startDate)+864e5*t);this.days.push(i.toString().substring(0,15))}}},{key:"headerDate",value:function(){var e;if(0===this.scheduleCalenderType)e=this.curDate.toString().substring(4,15);else if(1===this.scheduleCalenderType){var t=this.curDate;t.setDate(t.getDate()-t.getDay());var i=new Date(t),c=i.toString().substring(4,10);i.getDate()>25&&11===i.getMonth()&&(c=c+", "+i.getFullYear()),t.setDate(t.getDate()+6);var a=(i=new Date(t)).toString().substring(4,10);c.split(",")[1]&&(a=a+", "+i.getFullYear()),e=c+" - "+a}else e=this.dateService.getMonth(this.curMonth)+" "+this.curYear;return e}},{key:"goToToday",value:function(){this.setCurDate(this.dateService.getDate()),this.setStartDate()}},{key:"nextMonth",value:function(){this.curYear=11===this.curMonth?this.curYear+1:this.curYear,this.curMonth=(this.curMonth+1)%12,this.curDate=new Date(this.curYear,this.curMonth,1)}},{key:"previousMonth",value:function(){this.curYear=0===this.curMonth?this.curYear-1:this.curYear,this.curMonth=0===this.curMonth?11:this.curMonth-1,this.curDate=new Date(this.curYear,this.curMonth,1)}},{key:"nextWeek",value:function(){var e=new Date(this.curDate).getDate()+7,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}},{key:"previousWeek",value:function(){var e=new Date(this.curDate).getDate()-7,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}},{key:"nextDay",value:function(){var e=new Date(this.curDate).getDate()+1,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}},{key:"previousDay",value:function(){var e=new Date(this.curDate).getDate()-1,t=new Date(this.curDate).setDate(e);this.setCurDate(new Date(t))}},{key:"next",value:function(){0===this.scheduleCalenderType?this.nextDay():1===this.scheduleCalenderType?this.nextWeek():this.nextMonth(),this.setStartDate()}},{key:"previous",value:function(){0===this.scheduleCalenderType?this.previousDay():1===this.scheduleCalenderType?this.previousWeek():this.previousMonth(),this.setStartDate()}},{key:"changeScheduleCalenderType",value:function(e){this.scheduleCalenderType=e,this.setStartDate()}},{key:"daysInMonth",value:function(e,t){return 32-new Date(t,e,32).getDate()}},{key:"getTime",value:function(e,t){return(e=this.dateService.formatTime(e))+" - "+this.dateService.formatTime(t)}},{key:"getTeacher",value:function(e){return e}},{key:"getSubject",value:function(e){var t=this.course.subjects.find((function(t){return t._id===e}));return t?t.subject:"--"}},{key:"addSchedule",value:function(){this.router.navigate(["../add"],{relativeTo:this.route})}},{key:"addScheduleOfDay",value:function(e){this.scheduleService.setScheduleDay(e),this.router.navigate(["../add"],{relativeTo:this.route,queryParams:{mode:"date"}})}},{key:"editSchedule",value:function(e){this.scheduleService.setScheduleId(e._id),this.scheduleService.setScheduleData(e),this.router.navigate(["../edit"],{relativeTo:this.route,queryParams:{mode:"edit"}})}},{key:"deleteSchedule",value:function(e){var t=this;this.scheduleService.deleteSchedule(e).subscribe((function(i){var c=t.schedules.findIndex((function(t){return t._id===e}));c>=0&&(t.schedules.splice(c,1),t.showToastr("top-right","success","Schedule Deleted Successfully"))}),(function(e){t.showToastr("top-right","danger",e)}))}},{key:"getSchedule",value:function(){var e=this,t=this.dateService.convertToDateString(this.startDate),i=this.dateService.convertToDateString(this.dateService.addDaysInDate(this.startDate,this.noOfDays));this.loading=!0,this.scheduleService.getAllSchedules(this.branchId,this.category._id,this.course._id,this.batch._id,this.dateService.reverseDate(t),this.dateService.reverseDate(i)).subscribe((function(t){e.schedules=t,e.loading=!1}),(function(t){e.showToastr("top-right","danger",t),e.loading=!1}))}},{key:"getFilteredSchedule",value:function(e){return e=this.dateService.convertToDateString(e),this.schedules.filter((function(t){return t.date===e}))}},{key:"showToastr",value:function(e,t,i){this.toastrService.show(t,i,{position:e,status:t})}}]),e}(),f.\u0275fac=function(e){return new(e||f)(l.Qb(h.a),l.Qb(s.a),l.Qb(r.a),l.Qb(o.a),l.Qb(u.a),l.Qb(n.c),l.Qb(n.a),l.Qb(c.xb))},f.\u0275cmp=l.Kb({type:f,selectors:[["ngx-manage-batch-schedule"]],decls:36,vars:3,consts:[[1,"row"],[1,"col-md-9","col-sm-8"],[1,"col-md-3","col-sm-4"],["nbButton","","fullWidth","","status","primary","size","small",3,"click"],[1,"col-md-3","pt-2"],[1,"btn-group"],["nbButton","","status","primary","size","small",3,"click"],["icon","arrow-ios-back-outline"],["icon","arrow-ios-forward-outline"],[1,"col-md-5","pt-2"],[1,"text-center"],[1,"col-md-4","pt-2"],["status","basic","multi",""],[4,"ngFor","ngForOf"],[1,"row","accordion-header-item"],[1,"col-12"],["nbButton","","status","primary","size","tiny",1,"float-right",3,"click"],["nbTooltip","Add Schedule","icon","plus-outline"],["class","table-responsive",4,"ngIf","ngIfElse"],["noSchedule",""],[1,"table-responsive"],[1,"table"],["status","basic","nbButton","","size","small",3,"click"],["status","danger","nbButton","","size","small",3,"click"]],template:function(e,t){1&e&&(l.Wb(0,"nb-card"),l.Wb(1,"nb-card-header"),l.Wb(2,"div",0),l.Wb(3,"div",1),l.Wb(4,"h3"),l.Cc(5," Schedule of "),l.Wb(6,"small"),l.Cc(7),l.Vb(),l.Vb(),l.Vb(),l.Wb(8,"div",2),l.Wb(9,"button",3),l.ec("click",(function(){return t.addSchedule()})),l.Cc(10," Add Schedule "),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Wb(11,"nb-card-body"),l.Wb(12,"nb-card"),l.Wb(13,"nb-card-header"),l.Wb(14,"div",0),l.Wb(15,"div",4),l.Wb(16,"div",5),l.Wb(17,"button",6),l.ec("click",(function(){return t.previous()})),l.Rb(18,"nb-icon",7),l.Vb(),l.Wb(19,"button",6),l.ec("click",(function(){return t.goToToday()})),l.Cc(20," Today "),l.Vb(),l.Wb(21,"button",6),l.ec("click",(function(){return t.next()})),l.Rb(22,"nb-icon",8),l.Vb(),l.Vb(),l.Vb(),l.Wb(23,"div",9),l.Wb(24,"h5",10),l.Cc(25),l.Vb(),l.Vb(),l.Wb(26,"div",11),l.Wb(27,"div",5),l.Wb(28,"button",6),l.ec("click",(function(){return t.changeScheduleCalenderType(0)})),l.Cc(29," Day "),l.Vb(),l.Wb(30,"button",6),l.ec("click",(function(){return t.changeScheduleCalenderType(1)})),l.Cc(31," Week "),l.Vb(),l.Wb(32,"button",6),l.ec("click",(function(){return t.changeScheduleCalenderType(2)})),l.Cc(33," Month "),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Wb(34,"nb-accordion",12),l.Ac(35,D,12,3,"nb-accordion-item",13),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Eb(7),l.Dc(t.batch.basicDetails.batchName),l.Eb(18),l.Dc(t.headerDate()),l.Eb(10),l.mc("ngForOf",t.days))},directives:[c.x,c.z,c.u,c.w,c.L,c.g,a.m,c.i,c.j,c.zb,c.h,a.n],styles:[".accordion-header-item[_ngcontent-%COMP%]{width:98%}"]}),f)}],S=((g=function e(){_classCallCheck(this,e)}).\u0275mod=l.Ob({type:g}),g.\u0275inj=l.Nb({factory:function(e){return new(e||g)},imports:[[n.g.forChild(y)],n.g]}),g);i.d(t,"ManageBatchScheduleModule",(function(){return m}));var p,m=((p=function e(){_classCallCheck(this,e)}).\u0275mod=l.Ob({type:p}),p.\u0275inj=l.Nb({factory:function(e){return new(e||p)},imports:[[a.c,S,c.A,c.Ab,c.N,c.v,c.P,c.k,c.K]]}),p)}}]);