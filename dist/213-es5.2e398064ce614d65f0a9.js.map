{"version":3,"sources":["webpack:///src/app/institute/branch/students-report/student-courses/student-course-attendance/student-course-attendance.component.html","webpack:///src/app/institute/branch/students-report/student-courses/student-course-attendance/student-course-attendance-routing.module.ts","webpack:///src/app/institute/branch/students-report/student-courses/student-course-attendance/student-course-attendance.component.ts","webpack:///src/app/institute/branch/students-report/student-courses/student-course-attendance/student-course-attendance.module.ts"],"names":["StudentCourseAttendanceComponent","StudentCourseAttendanceModule","StudentCourseAttendanceRoutingModule","routes","path","component","dateService","branchService","batchService","toastrService","studentService","studentCourseService","attendanceService","router","route","this","loading","branchId","getBranchId","categoryId","getCategoryId","studentCourseId","getStudentCourseId","studentId","getStudentId","getStudentCourseData","subscribe","studentCourse","showToastr","back","attendance","subjects","subject","months","getMonths","years","getYears","month","getDate","getMonth","toString","padStart","year","length","totalLectures","totalPresent","totalAbsent","attendancePercentage","getBatchSubjects","course","batch","getStudentCourseAttendance","error","calculateAttendance","forEach","atten","toFixed","navigate","relativeTo","position","status","message","show","onSelectSubject","onSelectYear","onSelectMonth","loadChildren","then","m","PageNotFoundModule","redirectTo","pathMatch","forChild"],"mappings":"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","file":"x","sourcesContent":["<nb-card>\r\n  <nb-card-header>\r\n    <div class=\"row\">\r\n      <div class=\"col-md-12\">\r\n        <button class=\"float-right\" nbButton size=\"small\" status=\"warning\" (click)=\"back()\">\r\n          Back\r\n        </button>\r\n        <h3>Attendance</h3>\r\n      </div>\r\n    </div>\r\n  </nb-card-header>\r\n</nb-card>\r\n\r\n<nb-card>\r\n  <nb-card-header>\r\n    <div class=\"row\">\r\n      <div class=\"col-md-3 col-sm-4\"></div>\r\n\r\n      <div class=\"col-md-3 col-sm-4\">\r\n        <nb-select\r\n          id=\"select-subject\"\r\n          name=\"subject\"\r\n          [selected]=\"subject\"\r\n          fullWidth\r\n          placeholder=\"All Subjects\"\r\n          (selectedChange)=\"onSelectSubject($event)\"\r\n        >\r\n          <nb-option value=\"\">All Subjects</nb-option>\r\n          <nb-option *ngFor=\"let subject of subjects\" [value]=\"subject._id\">{{\r\n            subject.subject\r\n          }}</nb-option>\r\n        </nb-select>\r\n      </div>\r\n\r\n      <div class=\"col-md-3 col-sm-4\">\r\n        <nb-select\r\n          id=\"select-year\"\r\n          name=\"year\"\r\n          [selected]=\"year\"\r\n          fullWidth\r\n          placeholder=\"All Years\"\r\n          (selectedChange)=\"onSelectYear($event)\"\r\n        >\r\n          <nb-option value=\"\">All Years</nb-option>\r\n          <nb-option *ngFor=\"let year of years\" [value]=\"year\">{{ year }}</nb-option>\r\n        </nb-select>\r\n      </div>\r\n\r\n      <div class=\"col-md-3 col-sm-4\">\r\n        <nb-select\r\n          id=\"select-month\"\r\n          name=\"month\"\r\n          [selected]=\"month\"\r\n          fullWidth\r\n          placeholder=\"All Months\"\r\n          (selectedChange)=\"onSelectMonth($event)\"\r\n        >\r\n          <nb-option value=\"\">All Months</nb-option>\r\n          <nb-option *ngFor=\"let month of months\" [value]=\"month.monthNo\">{{\r\n            month.month\r\n          }}</nb-option>\r\n        </nb-select>\r\n      </div>\r\n    </div>\r\n  </nb-card-header>\r\n  <nb-card-body class=\"body-container\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md-10 col-12 mx-auto\">\r\n        <div class=\"row\">\r\n          <div class=\"col-md-6 col-12\">\r\n            <span><strong>Total Lectures: </strong>{{ totalLectures }}</span>\r\n          </div>\r\n          <div class=\"col-md-6 col-12\">\r\n            <span><strong>Attendance Percentage: </strong>{{ attendancePercentage }}</span>\r\n          </div>\r\n          <div class=\"col-md-6 col-12\">\r\n            <span><strong>Total Present: </strong>{{ totalPresent }}</span>\r\n          </div>\r\n          <div class=\"col-md-6 col-12\">\r\n            <span><strong>Total Absent: </strong>{{ totalAbsent }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <br />\r\n    <br />\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-md-12\">\r\n        <ng-container *ngIf=\"!loading; else loadingData\">\r\n          <div class=\"table-responsive\" *ngIf=\"attendance.length > 0; else noAttendance\">\r\n            <table class=\"table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>#</th>\r\n                  <th>Date</th>\r\n                  <th>Subject</th>\r\n                  <th>Topic</th>\r\n                  <th>Attendance</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr *ngFor=\"let atten of attendance; let i = index\">\r\n                  <td>{{ i + 1 }}</td>\r\n                  <td>{{ dateService.formatDate(atten.date) }}</td>\r\n                  <td>{{ atten.subject }}</td>\r\n                  <td>{{ atten.topic }}</td>\r\n                  <td>\r\n                    <span [ngClass]=\"atten.attendance ? 'present' : 'absent'\">{{\r\n                      atten.attendance ? 'Present' : 'Absent'\r\n                    }}</span>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <ng-template #noAttendance>\r\n            <p class=\"text-center pt-5 pb-5\">No Attendance Available</p>\r\n          </ng-template>\r\n        </ng-container>\r\n        <ng-template #loadingData>\r\n          <p class=\"text-center pt-5 pb-5\">Loading...</p>\r\n        </ng-template>\r\n      </div>\r\n    </div>\r\n  </nb-card-body>\r\n</nb-card>\r\n","import { StudentCourseAttendanceComponent } from './student-course-attendance.component';\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: StudentCourseAttendanceComponent,\n  },\n\n  {\n    path: 'page-not-found',\n    loadChildren: () =>\n      import('../../../../../shared/page-not-found/page-not-found.module').then(\n        (m) => m.PageNotFoundModule,\n      ),\n  },\n\n  {\n    path: '**',\n    redirectTo: 'page-not-found',\n    pathMatch: 'full',\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class StudentCourseAttendanceRoutingModule {}\n","import { BatchService } from './../../../../../services/batch.service';\nimport { StudentCourseModel } from './../../../../../models/student-course.model';\nimport { SubjectModel } from './../../../../../models/course.model';\nimport { AttendanceService } from './../../../../../services/attendance.service';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { StudentCourseService } from './../../../../../services/student-course.service';\nimport { StudentService } from './../../../../../services/student.service';\nimport { NbToastrService } from '@nebular/theme';\nimport { BranchService } from './../../../../../services/branch.service';\nimport { DateService, Month } from './../../../../../services/shared-services/date.service';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ngx-student-course-attendance',\n  templateUrl: './student-course-attendance.component.html',\n  styleUrls: ['./student-course-attendance.component.scss'],\n})\nexport class StudentCourseAttendanceComponent implements OnInit {\n  private branchId: string;\n  private categoryId: string;\n  private studentCourseId: string;\n  private studentId: string;\n\n  private studentCourse: StudentCourseModel;\n\n  loading: boolean;\n\n  attendance: any[];\n\n  subjects: SubjectModel[];\n  subject: string;\n\n  months: Month[];\n  month: string;\n\n  years: string[];\n  year: string;\n\n  totalLectures: number;\n  totalPresent: number;\n  totalAbsent: number;\n  attendancePercentage: string;\n\n  constructor(\n    public dateService: DateService,\n    private branchService: BranchService,\n    private batchService: BatchService,\n    private toastrService: NbToastrService,\n    private studentService: StudentService,\n    private studentCourseService: StudentCourseService,\n    private attendanceService: AttendanceService,\n    private router: Router,\n    private route: ActivatedRoute,\n  ) {}\n\n  ngOnInit(): void {\n    this.loading = true;\n    this.branchId = this.branchService.getBranchId();\n    this.categoryId = this.branchService.getCategoryId();\n    this.studentCourseId = this.studentCourseService.getStudentCourseId();\n    this.studentId = this.studentService.getStudentId();\n\n    if (!this.branchId || !this.categoryId || !this.studentCourseId || !this.studentId) {\n      this.back();\n      return;\n    }\n    this.studentCourseService\n      .getStudentCourseData()\n      .subscribe((studentCourse: StudentCourseModel) => {\n        this.studentCourse = studentCourse;\n      });\n\n    if (!this.studentCourse) {\n      this.showToastr('top-right', 'danger', 'Student Course Not Found');\n      this.back();\n      return;\n    }\n\n    this.attendance = [];\n\n    this.subjects = [];\n    this.subject = '';\n\n    this.months = this.dateService.getMonths();\n    this.years = this.dateService.getYears();\n\n    this.month = (this.dateService.getDate().getMonth() + 1).toString().padStart(2, '0');\n    this.year = this.years[this.years.length - 1];\n\n    this.totalLectures = 0;\n    this.totalPresent = 0;\n    this.totalAbsent = 0;\n    this.attendancePercentage = '--';\n\n    this.batchService\n      .getBatchSubjects(this.studentCourse.course, this.studentCourse.batch)\n      .subscribe(\n        (subjects: SubjectModel[]) => {\n          this.subjects = subjects;\n          this.getStudentCourseAttendance();\n        },\n        (error: any) => {\n          this.showToastr('top-right', 'danger', error);\n          this.back();\n        },\n      );\n  }\n\n  onSelectMonth(month: string) {\n    this.month = month;\n    this.getStudentCourseAttendance();\n  }\n\n  onSelectYear(year: string) {\n    this.year = year;\n    if (year === '') {\n      this.month = '';\n    }\n    this.getStudentCourseAttendance();\n  }\n\n  onSelectSubject(subject: string) {\n    this.subject = subject;\n    this.getStudentCourseAttendance();\n  }\n\n  getStudentCourseAttendance() {\n    this.loading = true;\n    this.attendanceService\n      .getStudentCourseAttendance(\n        this.subject,\n        this.month,\n        this.year,\n        this.studentId,\n        this.studentCourseId,\n      )\n      .subscribe(\n        (attendance: any[]) => {\n          this.attendance = attendance;\n          this.calculateAttendance(attendance.length);\n          this.loading = false;\n        },\n        (error: any) => {\n          this.showToastr('top-right', 'danger', error);\n          this.back();\n        },\n      );\n  }\n\n  calculateAttendance(totalLectures: number) {\n    let totalPresent = 0;\n    let totalAbsent = 0;\n\n    this.attendance.forEach((atten: any) => {\n      if (atten.attendance) {\n        totalPresent++;\n      } else {\n        totalAbsent++;\n      }\n    });\n\n    this.totalLectures = totalLectures;\n    this.totalPresent = totalPresent;\n    this.totalAbsent = totalAbsent;\n\n    let attendancePercentage: number;\n\n    if (totalLectures > 0) {\n      attendancePercentage = (totalPresent * 100) / totalLectures;\n    }\n\n    if (attendancePercentage) {\n      this.attendancePercentage = attendancePercentage.toFixed(2).toString() + '%';\n    } else {\n      this.attendancePercentage = '--';\n    }\n  }\n\n  back() {\n    this.router.navigate(['../'], { relativeTo: this.route });\n  }\n\n  private showToastr(position: any, status: any, message: string) {\n    this.toastrService.show(status, message, {\n      position,\n      status,\n    });\n  }\n}\n","import { NbCardModule, NbSelectModule, NbButtonModule, NbIconModule } from '@nebular/theme';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { StudentCourseAttendanceRoutingModule } from './student-course-attendance-routing.module';\nimport { StudentCourseAttendanceComponent } from './student-course-attendance.component';\n\n@NgModule({\n  declarations: [StudentCourseAttendanceComponent],\n  imports: [\n    CommonModule,\n    StudentCourseAttendanceRoutingModule,\n    NbCardModule,\n    NbSelectModule,\n    NbButtonModule,\n    NbIconModule,\n  ],\n})\nexport class StudentCourseAttendanceModule {}\n"]}